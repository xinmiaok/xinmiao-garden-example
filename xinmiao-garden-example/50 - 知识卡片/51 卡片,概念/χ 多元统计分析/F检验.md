---
标题: F检验
创建时间: 2023-03-29 11:10
修改时间: <%+ tp.file.last_modified_date() %>
其他:
tags: 多元统计分析
类型1: "卡片"
类型2: "多元统计分析"
类型3: "方法"
用途: 模板
定位: 专注/关注
---
标签

```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🌸  
🎏 class: #📥 #📇  

description :: 方差分析（ANOVA）又称“变异数分析”或“F检验”，是由罗纳德·费雪爵士发明的，用于两个及两个以上样本均数差别的显著性检验

用于:: 

英文名:: Analysis of Variance，ANOVA

中文名:: 方差分析

学科::  统计学

特点:: 

本质:: 

来源:: [方差分析（数学术语）_百度百科](https://baike.baidu.com/link?url=8vLbT2BmJoION32obfXNk8lKgd0fgcoAmphlcS4RM5hcf08AJyaShNufoIGEE5q_fb0L0c_wvbgGb0K2N6i837VzpwoHaDcYH3FgMZNQiebYSEcLf-pB4xfUbO3B9e19)

📎

```

## 原理

### 定义

方差分析（ANOVA）又称“变异数分析”或“F检验”，是由罗纳德·费雪爵士发明的，用于两个及两个以上样本均数差别的[显著性检验](https://baike.baidu.com/item/%E6%98%BE%E8%91%97%E6%80%A7%E6%A3%80%E9%AA%8C?fromModule=lemma_inlink) [1]  。

### 原理

方差分析的基本原理是认为不同处理组的均数间的差别基本来源有两个：

(1) **实验条件**，即不同的处理造成的差异，称为组间差异。用变量在各组的均值与总均值之[偏差平方和](https://baike.baidu.com/item/%E5%81%8F%E5%B7%AE%E5%B9%B3%E6%96%B9%E5%92%8C/554655?fromModule=lemma_inlink)的总和表示，记作SSb，组间自由度dfb。

(2) [随机误差](https://baike.baidu.com/item/%E9%9A%8F%E6%9C%BA%E8%AF%AF%E5%B7%AE?fromModule=lemma_inlink)，如测量误差造成的差异或个体间的差异，称为组内差异，用变量在各组的均值与该组内变量值之偏差平方和的总和表示， 记作SSw，组内[自由度](https://baike.baidu.com/item/%E8%87%AA%E7%94%B1%E5%BA%A6/5936984?fromModule=lemma_inlink)dfw。

总偏差平方和 SSt = SSb + SSw。

组内SSw、组间SSb除以各自的自由度(组内dfw =n-m，组间dfb=m-1，其中n为样本总数，m为组数)，得到其均方MSw和MSb，一种情况是处理没有作用，即各组样本均来自同一[总体](https://baike.baidu.com/item/%E6%80%BB%E4%BD%93?fromModule=lemma_inlink)，MSb/MSw≈1。另一种情况是处理确实有作用，组间均方是由于误差与不同处理共同导致的结果，即各样本来自不同总体。那么，MSb>>MSw(远远大于)。

MSb/MSw比值构成F分布。用F值与其临界值比较，推断各样本是否来自相同的[总体](https://baike.baidu.com/item/%E6%80%BB%E4%BD%93/19951273?fromModule=lemma_inlink) [1]  。

## 基本思想

方差分析的基本思想是：==通过分析研究不同来源的变异对总变异的贡献大小，从而确定可控因素对研究结果影响力的大小==。

**举例分析：**

下面我们用一个简单的例子来说明方差分析的基本思想：

如某[克山病](https://baike.baidu.com/item/%E5%85%8B%E5%B1%B1%E7%97%85?fromModule=lemma_inlink)区测得11例克山病患者和13名健康人的血磷值（mmol/L）如下：

[![方差分析](https://bkimg.cdn.bcebos.com/pic/faedab64034f78f0dae4668079310a55b2191cd1?x-bce-process=image/resize,m_lfit,w_440,limit_1)](https://baike.baidu.com/pic/%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/1502206/0/b25aae51d5cb4f5b377abe33?fr=lemma&fromModule=lemma_content-image&ct=single "方差分析")方差分析

患者：0.84 1.05 1.20 1.20 1.39 1.53 1.67 1.80 1.87 2.07 2.11

健康人：0.54 0.64 0.64 0.75 0.76 0.81 1.16 1.20 1.34 1.35 1.48 1.56 1.87

问该地克山病患者与健康人的血磷值是否不同？

从以上资料可以看出，24个患者与健康人的血磷值各不相同，如果用离均差平方和（SS）描述其围绕总均值的变异情况，则总变异有以下两个来源：

组内变异，即由于随机误差的原因使得各组内部的血磷值各不相等；

组间变异，即由于克山病的影响使得患者与健康人组的血磷值均值大小不等。

而且：SS总=SS组间+SS组内 v总=v组间+v组内

如果用均方（[离差平方和](https://baike.baidu.com/item/%E7%A6%BB%E5%B7%AE%E5%B9%B3%E6%96%B9%E5%92%8C?fromModule=lemma_inlink)除以自由度）代替离差平方和以消除各组样本数不同的影响，则方差分析就是用组间均方去除组内均方的商（即F值）与1相比较，若F值接近1，则说明各组均值间的差异没有统计学意义，若F值远大于1，则说明各组均值间的差异有统计学意义。实际应用中检验假设成立条件下F值大于特定值的概率可通过查阅F界值表（方差分析用）获得。

利用统计软件分析结果如下：

data a;

input type num @@;

cards;

1 0.84 1 1.05 1 1.20 1 1.20 1 1.39 1 1.53 1 1.67 1 1.80 1 1.87 1 2.07 1 2.11

2 0.54 2 0.64 2 0.64 2 0.75 2 0.76 2 0.81 2 1.16 2 1.20 2 1.34 2 1.35 2 1.48 2 1.56 2 1.87;

run;

proc anova;

class type;

model num=type;

means type; [2] 

结果如下：

  

自由度

离差平方和

均方

F 值

P值

SS组间（处理因素）

1

1.13418185

1.13418185

6.37

0.0193（有统计学意义）

SS组内（抽样误差）

22

3.91761399

0.17807336

  

  

总和

23

5.05179583

  

  

  

## 主要内容

编辑 播报

### 分析方法

根据数据设计类型的不同，有以下两种方差分析的方法：

1、对成组设计的多个样本均值比较，应采用[完全随机设计](https://baike.baidu.com/item/%E5%AE%8C%E5%85%A8%E9%9A%8F%E6%9C%BA%E8%AE%BE%E8%AE%A1?fromModule=lemma_inlink)的方差分析，即[单因素方差分析](https://baike.baidu.com/item/%E5%8D%95%E5%9B%A0%E7%B4%A0%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90?fromModule=lemma_inlink)。

2、对[随机区组设计](https://baike.baidu.com/item/%E9%9A%8F%E6%9C%BA%E5%8C%BA%E7%BB%84%E8%AE%BE%E8%AE%A1?fromModule=lemma_inlink)的多个样本均值比较，应采用配伍组设计的方差分析，即两因素方差分析 [1]  。

### 两类方差异同

**两类方差分析的异同：**

两类方差分析的基本步骤相同，只是变异的分解方式不同，对成组设计的资料，总变异分解为组内变异和组间变异（随机误差），即：SS总=SS组间+SS组内，而对配伍组设计的资料，总变异除了分解为处理组变异和随机误差外还包括配伍组变异，即：SS总=SS处理+SS配伍+SS误差 [1]  。

### 基本步骤

整个方差分析的基本步骤如下：

#### 1、建立检验假设；

H0：多个样本总体均值相等；

H1：多个样本总体均值不相等或不全等。

检验水准为0.05。

#### 2、计算检验统计量F值；

#### 3、确定P值并作出推断结果 [1]  。

## 方差分析分类

### 单因素

**单因素方差分析：**

（一）单因素方差分析概念理解步骤

是用来研究一个[控制变量](https://baike.baidu.com/item/%E6%8E%A7%E5%88%B6%E5%8F%98%E9%87%8F?fromModule=lemma_inlink)的不同水平是否对观测变量产生了显著影响。这里，由于仅研究单个因素对观测变量的影响，因此称为单因素方差分析。

例如，分析不同施肥量是否给农作物产量带来显著影响，考察地区差异是否影响妇女的生育率，研究学历对工资收入的影响等。这些问题都可以通过单因素方差分析得到答案。

单因素方差分析的第一步是明确观测变量和控制变量。例如，上述问题中的观测变量分别是农作物产量、妇女生育率、工资收入；控制变量分别为施肥量、地区、学历。

单因素方差分析的第二步是剖析观测变量的方差。方差分析认为：观测变量值的变动会受控制变量和随机变量两方面的影响。据此，单因素方差分析将观测变量总的离差平方和分解为组间离差平方和和组内离差平方和两部分，用数学形式表述为：SST=SSA+SSE。

单因素方差分析的第三步是通过比较观测变量总离差平方和各部分所占的比例，推断控制变量是否给观测变量带来了显著影响。

**（二）单因素方差分析原理总结**

容易理解：在观测变量总离差平方和中，如果组间离差平方和所占比例较大，则说明观测变量的变动主要是由控制变量引起的，可以主要由控制变量来解释，控制变量给观测变量带来了显著影响；反之，如果组间离差平方和所占比例小，则说明观测变量的变动不是主要由控制变量引起的，不可以主要由控制变量来解释，控制变量的不同水平没有给观测变量带来显著影响，观测变量值的变动是由随机变量因素引起的。

**（三）单因素方差分析基本步骤**

1、提出原假设：H0——无差异；H1——有显著差异

2、选择[检验统计量](https://baike.baidu.com/item/%E6%A3%80%E9%AA%8C%E7%BB%9F%E8%AE%A1%E9%87%8F?fromModule=lemma_inlink)：方差分析采用的检验统计量是[F统计量](https://baike.baidu.com/item/F%E7%BB%9F%E8%AE%A1%E9%87%8F?fromModule=lemma_inlink)，即F值检验。

3、计算检验统计量的[观测值](https://baike.baidu.com/item/%E8%A7%82%E6%B5%8B%E5%80%BC?fromModule=lemma_inlink)和概率P值：该步骤的目的就是计算检验统计量的观测值和相应的概率P值。

4、给定[显著性水平](https://baike.baidu.com/item/%E6%98%BE%E8%91%97%E6%80%A7%E6%B0%B4%E5%B9%B3?fromModule=lemma_inlink)，并作出决策

**（四）单因素方差分析的进一步分析**

在完成上述单因素方差分析的基本分析后，可得到关于控制变量是否对观测变量造成显著影响的结论，接下来还应做其他几个重要分析，主要包括方差齐性检验、多重比较检验。

**1、方差齐性检验**

是对控制变量不同水平下各观测变量[总体方差](https://baike.baidu.com/item/%E6%80%BB%E4%BD%93%E6%96%B9%E5%B7%AE?fromModule=lemma_inlink)是否相等进行检验。

前面提到，控制变量不同水平下观测变量总体方差无显著差异是方差分析的前提要求。如果没有满足这个前提要求，就不能认为各[总体分布](https://baike.baidu.com/item/%E6%80%BB%E4%BD%93%E5%88%86%E5%B8%83?fromModule=lemma_inlink)相同。因此，有必要对方差是否齐性进行检验。

SPSS单因素方差分析中，方差齐性检验采用了方差同质性（homogeneity of variance）检验方法，其原假设是：各水平下观测变量总体的方差无显著差异。

**2、多重比较检验**

单因素方差分析的基本分析只能判断控制变量是否对观测变量产生了显著影响。如果控制变量确实对观测变量产生了显著影响，进一步还应确定控制变量的不同水平对观测变量的影响程度如何，其中哪个水平的作用明显区别于其他水平，哪个水平的作用是不显著的，等等。

例如，如果确定了不同施肥量对农作物的产量有显著影响，那么还需要了解10公斤、20公斤、30公斤肥料对农作物产量的影响幅度是否有差异，其中哪种施肥量水平对提高农作物产量的作用不明显，哪种施肥量水平最有利于提高产量等。掌握了这些重要的信息就能够帮助人们制定合理的施肥方案，实现低投入高产出。

多重比较检验利用了全部观测变量值，实现对各个水平下观测变量总体[均值](https://baike.baidu.com/item/%E5%9D%87%E5%80%BC?fromModule=lemma_inlink)的逐对比较。由于多重比较检验问题也是假设检验问题，因此也遵循假设检验的基本步骤。 [3] 

### 检验构造方法

**（1）LSD方法**

LSD方法称为最小[显著性差异](https://baike.baidu.com/item/%E6%98%BE%E8%91%97%E6%80%A7%E5%B7%AE%E5%BC%82?fromModule=lemma_inlink)（Least Significant Difference）法。最小显著性差异法的字面就体现了其检验敏感性高的特点，即水平间的均值只要存在一定程度的微小差异就可能被检验出来。

正是如此，它利用全部观测变量值，而非仅使用某两组的数据。LSD方法适用于各总体方差相等的情况，但它并没有对犯一类错误的概率问题加以有效控制。

**（2）S-N-K方法**

S-N-K方法是一种有效划分相似性子集的方法。该方法适合于各水平观测值个数相等的情况，

**3、其他检验**

**（1）先验对比检验**

在多重比较检验中，如果发现某些水平与另外一些水平的均值差距显著，如有五个水平，其中x1、x2、x3与x4、x5的均值有显著差异，就可以进一步分析比较这两组总的均值是否存在显著差异，即1/3(x1+x2+x3)与1/2(x4+x5)是否有显著差异。这种事先指定各均值的系数，再对其[线性组合](https://baike.baidu.com/item/%E7%BA%BF%E6%80%A7%E7%BB%84%E5%90%88?fromModule=lemma_inlink)进行检验的分析方法称为先验对比检验。通过先验对比检验能够更精确地掌握各水平间或各相似性子集间均值的差异程度。

**（2）趋势检验**

当控制变量为[定序变量](https://baike.baidu.com/item/%E5%AE%9A%E5%BA%8F%E5%8F%98%E9%87%8F?fromModule=lemma_inlink)时，趋势检验能够分析随着控制变量水平的变化，观测变量值变化的总体趋势是怎样的，是呈现线性变化趋势，还是呈二次、三次等多项式变化。通过趋势检验，能够帮助人们从另一个角度把握控制变量不同水平对观测变量总体作用的程度。 [3] 

### 多因素

**多因素方差分析：**

（一）多因素方差分析基本思想

多因素方差分析用来研究两个及两个以上控制变量是否对观测变量产生显著影响。这里，由于研究多个因素对观测变量的影响，因此称为多因素方差分析。多因素方差分析不仅能够分析多个因素对观测变量的独立影响，更能够分析多个控制因素的交互作用能否对观测变量的分布产生显著影响，进而最终找到利于观测变量的最优组合。

例如：

分析不同品种、不同施肥量对农作物产量的影响时，可将农作物产量作为观测变量，品种和施肥量作为控制变量。利用多因素方差分析方法，研究不同品种、不同施肥量是如何影响农作物产量的，并进一步研究哪种品种与哪种水平的施肥量是提高农作物产量的最优组合。

（二）多因素方差分析的其他功能

1、均值检验

在SPSS中，利用多因素方差分析功能还能够对各控制变量不同水平下观测变量的均值是否存在显著差异进行比较，实现方式有两种，即多重比较检验和对比检验。多重比较检验的方法与单因素方差分析类似。对比检验采用的是单样本[t检验](https://baike.baidu.com/item/t%E6%A3%80%E9%AA%8C?fromModule=lemma_inlink)的方法，它将控制变量不同水平下的观测变量值看做来自不同总体的样本，并依次检验这些总体的均值是否与某个指定的检验值存在显著差异。其中，检验值可以指定为以下几种：

观测变量的均值（Deviation）;

第一水平或最后一个水平上观测变量的均值（Simple）;

前一水平上观测变量的均值（Difference）;

后一水平上观测变量的均值（Helmert）。

2、控制变量交互作用的图形分析

控制变量的交互作用可以通过图形直观分析。

**（三）多因素方差分析的进一步分析**

在上述案例中，已经对广告形式、地区对销售额的影响进行了多因素方差分析，建立了饱和模型。由分析可知：广告形式与地区的交互作用不显著，先进一步尝试非饱和模型，并进行均值比较分析、交互作用图形分析。

1、建立非饱和模型

2、均值比较分析

3、控制变量交互作用的图形分析 [3] 

### 协方差

[协方差分析](https://baike.baidu.com/item/%E5%8D%8F%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/5366621?fromModule=lemma_inlink)：

**（一）**[协方差](https://baike.baidu.com/item/%E5%8D%8F%E6%96%B9%E5%B7%AE?fromModule=lemma_inlink)分析基本思想

[![协方差分析](https://bkimg.cdn.bcebos.com/pic/b8014a90f603738d9497f051b31bb051f919ece0?x-bce-process=image/resize,m_lfit,w_440,limit_1)](https://baike.baidu.com/pic/%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/1502206/0/29790130d4c471daa8018e01?fr=lemma&fromModule=lemma_content-image&ct=single "协方差分析")协方差分析

通过上述的分析可以看到，不论是单因素方差分析还是多因素方差分析，控制因素都是可控的，其各个水平可以通过人为的努力得到控制和确定。但在许多实际问题中，有些控制因素很难人为控制，但它们的不同水平确实对观测变量产生了较为显著的影响。例如，在研究农作物产量问题时，如果仅考察不同施肥量、品种对农作物产量的影响，不考虑不同地块等因素而进行方差分析，显然是不全面的。因为事实上有些地块可能有利于农作物的生长，而另一些却不利于农作物的生长。不考虑这些因素进行分析可能会导致：即使不同的施肥量、不同品种农作物产量没有产生显著影响，但分析的结论却可能相反。

再例如，分析不同的饲料对生猪增重是否产生显著差异。如果单纯分析饲料的作用，而不考虑生猪各自不同的身体条件（如初始体重不同），那么得出的结论很可能是不准确的。因为体重增重的幅度在一定程度上是包含诸如初始体重等其他因素的影响的。

（二）协方差分析的原理

协方差分析将那些人为很难控制的控制因素作为[协变量](https://baike.baidu.com/item/%E5%8D%8F%E5%8F%98%E9%87%8F?fromModule=lemma_inlink)，并在排除协变量对观测变量影响的条件下，分析控制变量（可控）对观测变量的作用，从而更加准确地对控制因素进行评价。

协方差分析仍然沿承方差分析的基本思想，并在分析观测变量变差时，考虑了协变量的影响，人为观测变量的变动受四个方面的影响：即控制变量的独立作用、控制变量的交互作用、协变量的作用和随机因素的作用，并在扣除协变量的影响后，再分析控制变量的影响。

方差分析中的原假设是：协变量对观测变量的线性影响是不显著的；在协变量影响扣除的条件下，控制变量各水平下观测变量的总体均值无显著差异，控制变量各水平对观测变量的效应同时为零。检验统计量仍采用F统计量，它们是各均方与随机因素引起的均方比。 [3] 

## 假设检验

编辑 播报

1. 方差分析的假定条件为：

（1）各处理条件下的样本是随机的。

（2）各处理条件下的样本是[相互独立](https://baike.baidu.com/item/%E7%9B%B8%E4%BA%92%E7%8B%AC%E7%AB%8B?fromModule=lemma_inlink)的，否则可能出现无法解析的输出结果。

（3）各处理条件下的样本分布必须为正态分布，否则使用非参数分析。

（4）各处理条件下的[样本方差](https://baike.baidu.com/item/%E6%A0%B7%E6%9C%AC%E6%96%B9%E5%B7%AE?fromModule=lemma_inlink)相同，即具有齐效性。

2. 方差分析的[假设检验](https://baike.baidu.com/item/%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C?fromModule=lemma_inlink)

假设有K个样本，如果原假设H0样本均数都相同，K个样本有共同的方差σ ，则K个样本来自具有共同方差σ和相同均值的总体。

如果经过计算，组间均方远远大于组内均方，则推翻原假设，说明样本来自不同的正态总体，说明处理造成均值的差异有统计意义。否则承认原假设，样本来自相同总体，处理间无差异。

应用条件：

（1）各样本是相互独立的随机样本

（2）各样本分布均为正态分布

（3）各样本的总体方差相等，即具有方差齐性

（4）在不满足正态性时可以用[非参数检验](https://baike.baidu.com/item/%E9%9D%9E%E5%8F%82%E6%95%B0%E6%A3%80%E9%AA%8C/6910745?fromModule=lemma_inlink) [2]  。

## 应用

编辑 播报

方差分析主要用途：①均数差别的显著性检验，②分离各有关因素并估计其对总变异的作用，③分析因素间的交互作用，④方差齐性检验。

在科学实验中常常要探讨不同实验条件或处理方法对实验结果的影响。通常是比较不同实验条件下样本均值间的差异。例如医学界研究几种药物对某种疾病的疗效；农业研究土壤、肥料、日照时间等因素对某种农作物产量的影响；不同化学药剂对作物害虫的杀虫效果等，都可以使用方差分析方法去解决。

[![协方差分析](https://bkimg.cdn.bcebos.com/pic/377adab44aed2e73cc217a5f8701a18b86d6fafd?x-bce-process=image/resize,m_lfit,w_440,limit_1)](https://baike.baidu.com/pic/%E6%96%B9%E5%B7%AE%E5%88%86%E6%9E%90/1502206/0/7ab514d1252c3b90562c841e?fr=lemma&fromModule=lemma_content-image&ct=single "协方差分析")协方差分析

一个复杂的事物，其中往往有许多因素互相制约又互相依存。方差分析的目的是通过数据分析找出对该事物有显著影响的因素，各因素之间的[交互作用](https://baike.baidu.com/item/%E4%BA%A4%E4%BA%92%E4%BD%9C%E7%94%A8?fromModule=lemma_inlink)，以及显著影响因素的最佳水平等。方差分析是在可比较的[数组](https://baike.baidu.com/item/%E6%95%B0%E7%BB%84?fromModule=lemma_inlink)中，把数据间的总的“变差”按各指定的变差来源进行分解的一种技术。对变差的度量，采用离差平方和。方差分析方法就是从总离差平方和分解出可追溯到指定来源的部分离差平方和，这是一个很重要的思想。

经过方差分析若拒绝了检验假设，只能说明多个样本总体均值不相等或不全相等。若要得到各组均值间更详细的信息，应在方差分析的基础上进行多个[样本均值](https://baike.baidu.com/item/%E6%A0%B7%E6%9C%AC%E5%9D%87%E5%80%BC?fromModule=lemma_inlink)的两两比较。

**多个样本均值间两两比较**

多个样本均值间两两比较常用q检验的方法，即Newman-keuls法，其基本步骤为：建立检验假设-->样本均值排序-->计算q值-->查q界值表判断结果。由于模仿了[学生氏分布](https://baike.baidu.com/item/%E5%AD%A6%E7%94%9F%E6%B0%8F%E5%88%86%E5%B8%83?fromModule=lemma_inlink)（Student's distribution），也称[SNK q检验](https://baike.baidu.com/item/SNK%20q%E6%A3%80%E9%AA%8C?fromModule=lemma_inlink)。

**多个实验组与一个对照组均值间两两比较**

多个[实验组](https://baike.baidu.com/item/%E5%AE%9E%E9%AA%8C%E7%BB%84?fromModule=lemma_inlink)与一个[对照组](https://baike.baidu.com/item/%E5%AF%B9%E7%85%A7%E7%BB%84?fromModule=lemma_inlink)均值间两两比较，若目的是减小第II类错误，最好选用最小显著差法（LSD法）；若目的是减小第I类错误，最好选用新复极差法，前者查t界值表，后者查q'界值表 [1]  。
```ad-note
title: Relavant Note
collapse: open
color: 142, 106, 120
- 其他笔记也有提及到：
- 子节点：
```