---
书名: 多元统计分析及R语言建模
---

```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🔖 
🎏 class: #📸  

description ::  教材

目的要求:: 要求学生熟练掌握如何收集和整理多元分析资料, 掌握数据的数学表达, 掌握多元数据的数字特征的解析表达式和基本性质; 熟悉有关统计软件; 利用统计软件来练习矩阵的有关计算; 练习在已给数据下, 求样本均值、样本离差阵、样本协差阵等

教学内容:: 多元数据的基本格式; 收集和整理多元分析资料; 数据的数学表达; 数据 矩阵及 R 语言表示; 数据的R语言表示; R调用多元数据和多元数据的简单R语言分析

来源::

📎

```

## 2.1 如何收集和整理多元分析资料
### 1.数据的格式
多元分析资料有一定的格式, 当对每一观察单位测量了多个指标（变量）时, 通常以矩阵的形式表示。

下面是多元分析资料的一般格式

$$变量  X_{1} \quad  变量  X_{2} \quad \cdots \quad  变量  X_{p} $$
$$ \begin{array}{llll}记录 1&x_{11} & x_{12} & \cdots & x_{1 p}\end{array}$$
$$\begin{array}{llll}记录 2&x_{21} & x_{22} & \cdots & x_{2 p}\end{array}$$
$$\begin{array}{cllll}\vdots & \vdots & \vdots & \vdots & \vdots\end{array}$$
$$\begin{array}{cccc}记录  n&x_{n 1} & x_{n 2} & \cdots & x_{n p}\end{array}$$
$$可以用一个有  n  行  p  列的矩阵阵列来表示这些数据, 称为  X_{\text {。 }}$$

$$X=\left[\begin{array}{cccc}x_{11} & x_{12} & \cdots & x_{1 p} \\x_{21} & x_{22} & \cdots & x_{2 p} \\\vdots & \vdots & \vdots & \vdots \\x_{n 1} & x_{n 2} & \cdots & x_{n p}\end{array}\right]=\left(x_{1}, x_{2}, \cdots, x_{p}\right)=\left(x_{i j}\right)_{n \times p}$$

这里,  $x_{j}=\left(x_{1 j}, x_{2 j}, \cdots, x_{n j}\right)^{\prime}, j=1,2, \cdots, p, x_{j}$  是单变量数值向量。

- 当这些**变量处于同等地位**时, 
	- 就是[[相关分析]]、[[聚类分析]]、[[主成分分析]]、[[因子分析]]、 [[对应分析]]、[[多维标度分析]]等模型的数据格式; 
- 当其中**一个变量为因变量, 而其他变量为自变量**时, 
	- 为[[线性回归分析]]、
	- [[广义线性模型]]和
	- [[非线性模型]]等的数据格式; 
	- 若此时因变量还是**分类变量**, 
		- 则为[[方差分析]]模型和[[判别分析]]模型的数据格式。

### 2.对数据的要求
在多元分析中, 
- 每个观察单位的每个变量都必须有数据, <span style="background:rgba(240, 200, 0, 0.2)">不能空缺</span>, 否则该观察单位在运算中将被忽略。
- 一般的统计分析软件中可以有缺失数据, 但在计算时常被忽略。
### 3. 变量的分类
**定量变量**一计量观测数据：
- 对每个观察单位的<span style="background:rgba(240, 200, 0, 0.2)">某些标志</span>所测到的数值（有单位), 
- 如<span style="background:rgba(92, 92, 92, 0.2)">身高  (\mathrm{cm})  、体重  (\mathrm{kg})  、收人（元）、支出（元）</span>等。

**定性变量**一计数观测数据：
- 将观察单位<span style="background:rgba(240, 107, 5, 0.2)">按属性或类别分组</span>, 清点各组的观察<span style="background:rgba(240, 107, 5, 0.2)">单位数</span>, 
- 如<span style="background:rgba(92, 92, 92, 0.2)">性别数、职业数</span>等。
- 定性变量通常<span style="background:rgba(92, 92, 92, 0.2)">需数量化后才能进行多元统计运算</span>。
- 分析时定性变量常常是==按  1,2, $\cdots$  进行识别==的。

## 2.2 数据的数学表达
在统计分析中, 
- 每一个==统计指标对应一个随机变量==, 
- 若有<span style="background:rgba(3, 135, 102, 0.2)">多个随机变量</span>, 且它们之间有一定的<span style="background:rgba(3, 135, 102, 0.2)">联系</span>，则由这些随机变量组成的向量称为<span style="background:rgba(3, 135, 102, 0.2)">随机向量</span>。

对  p  维随机向量, 
- 其每一个分量都是一个一维随机变量, 可以单独研究。
- 当各分量之间有相互联系时, 需将它们看作一个整体来研究。

### 1. 一元数据: 随机变量
#### (1) 数学公式。

1) 期望计算公式:  $\mu=E(X)=\sum_{i} x_{i} p_{i}$ 
2) 方差计算公式:  $\sigma^{2}=\operatorname{var}(X)=\sum_{i}\left(x_{i}-\mu\right)^{2} p_{i}$

#### (2) 统计计算。

1) 样本均值:  $\bar{x}=\frac{1}{n} \sum_{i=1}^{n} x_{i}$ 
2) 样本方差:  $s^{2}=\frac{l_{x x}}{n-1}=\frac{1}{n-1} \sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}$ 
- 其中,  $l_{x x}$  为样本离均差平方和,  $l_{x x}=\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)^{2}$  。
### 2.多元数据
#### (1) 数学公式

设  $X=\left(x_{1}, x_{2}, \cdots, x_{p}\right)$  是  $n \times p$  随机向量。

##### 1 ) 期望计算公式:

若  $E\left(x_{i}\right), i=1,2, \cdots, p$ , 其中  p  存在且有限，
则称
$E(X)=\left(E\left(x_{1}\right), E\left(x_{2}\right), \cdots, E\left(x_{p}\right)\right)$  为  X  的期望。

##### 2) 协方差计算公式:
向量  X  的方差一协方差矩阵为:
$$
\begin{array}{l}
\Sigma=\operatorname{var}(X)=\left[\begin{array}{cccc}
\operatorname{cov}\left(x_{1}, x_{1}\right) & \operatorname{cov}\left(x_{1}, x_{2}\right) & \cdots & \operatorname{cov}\left(x_{1}, x_{p}\right) \\
\operatorname{cov}\left(x_{2}, x_{1}\right) & \operatorname{cov}\left(x_{2}, x_{2}\right) & \cdots & \operatorname{cov}\left(x_{2}, x_{p}\right) \\
\vdots & \vdots & \vdots & \vdots \\
\operatorname{cov}\left(x_{p}, x_{1}\right) & \operatorname{cov}\left(x_{p}, x_{2}\right) & \cdots & \operatorname{cov}\left(x_{p}, x_{p}\right)
\end{array}\right] \\
=\left[\begin{array}{cccc}
\sigma_{11} & \sigma_{12} & \cdots & \sigma_{1 p} \\
\sigma_{21} & \sigma_{22} & \cdots & \sigma_{2 p} \\
\vdots & \vdots & \vdots & \vdots \\
\sigma_{p 1} & \sigma_{p 2} & \cdots & \sigma_{p p}
\end{array}\right] \\
\end{array}
$$

#### (2) 统计计算
对于来自  p  维正态总体  $N_{p}(\mu, \Sigma)$  的
- 一个==独立随机样本==  $x_{1}, x_{2}, \cdots, x_{n}$ , 
- 其<span style="background:rgba(240, 200, 0, 0.2)">样本均值向量</span>为  $\bar{x}=\frac{1}{n} \sum_{i=1}^{n} x_{i}$  。
- 样本均值向量也可用<span style="background:rgba(3, 135, 102, 0.2)">样本观测矩阵</span>  $X=\left(x_{i j}\right)_{n \times p}$  表示, 于是
<span style="background:rgba(3, 135, 102, 0.2)">- </span>

##### 1) 样本均值向量:  
$$\bar{x}=\frac{1}{n} \sum_{i=1}^{n} x_{i}=\frac{1}{n} X^{\prime} 1_{n}=\frac{1}{n} I_{p} X^{\prime} 1_{n} $$
这里,  $I_{p}$  为单位阵,  $1_{n}=(1,1, \cdots, 1)^{\prime}$  为 1 矩阵。

##### 2) 样本协方差阵:  
$$S=\frac{A}{n-1}=\frac{1}{n-1} \sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)\left(x_{i}-\bar{x}\right)^{\prime} $$ 
其中,  A  为样本叉积矩阵:  
$$A=\sum_{i=1}^{n}\left(x_{i}-\bar{x}\right)\left(x_{i}-\bar{x}\right)^{\prime}=X\left(I_{n}-\frac{1}{n} J_{n}\right) X^{\prime}$$
此处,  $I_{n}$  为  n  阶单位阵,  $J_{n}$  为  n  阶 1 矩阵。

## 2.3 数据矩阵及R语言表示

在多元分析中, 数据通常以矩阵的形式出现, 下面结合  $\mathrm{R}$  语言介绍基本的矩阵运算。 
- 主要包括: 创建矩阵向量, 矩阵加减、乘积, 矩阵的逆, 行列式的值, 特征值与特征向量, QR 分解, 奇异值分解, 取矩阵的上下三角元素, 向量化算子等。

### 1.创建一个向量 (随机变量、一维数组)
- 在  $\mathrm{R}$  中可以用函数  [[c]]()  来创建一个向量

函数 [[length]] ()  可以返回向量的长度

[[Mode]]() 可以返回向量的数据类型

### 2.创建一个矩阵（二维数组）

#### (1) 合并命令
可以用 [[rbind]] () 、  [[cbind]]()  将两个或两个以上的向量或矩阵合并起来, 
- 其中 [[rbind]] () 表示按行合并,  [[cbind]]()  则表示按列合并。

#### (2) 生成矩阵
在  R  中可以用函数 [[matrix]] () 来创建一个矩阵, 应用该函数时需要输 人必要的参数值。

```
matrix  (  data  =\mathrm{NA} , nrow  =1 , ncol  =1 , byrow  =  FALSE, dimnames  =  NULL  ) 
```

其中 
- data 项为必要的矩阵元素, 
- nrow 为行数, 
- ncol 为列数 (注意 nrow 与 ncol 的乘积 应为矩阵元素个数), 
- byrow 项用于控制排列元素时是否按行进行, 
- dimnames 给定行和列的名称, 例如:

### 3.矩阵转置
A $\text { 为 } m \times n$ 矩阵,  $A^{\prime}$  为其转置矩阵, 求$A^{\prime}$ 在R中可用函数[[t]]() 或 [[transpose]]()

### 4.矩阵相加减
在 R 中对同行同列矩阵相加减, 可用符号 “ + ” “-”


### 5.矩阵相乘 
A  为  $m \times n$  矩阵,  B  为  $n \times k$  矩阵,在  $\mathrm{R}$  中求  A B  可用符号 “  $\% * \%$  ”

## 2.4 数据的R语言表示一一数据框 
[[50 - 知识卡片/51 卡片,概念/R/数据框]] (data frame) 是一种矩阵形式的数据, 但数据框中各列可以是不同类型的数据。
- [[50 - 知识卡片/51 卡片,概念/R/数据框]]中每列是一个变量, 每行是一个观测量。
- [[50 - 知识卡片/51 卡片,概念/R/数据框]]可以看成是[[矩阵]]（[[matrix]]) 的推广, 
- 也可以看作一种特殊的[[列表]]对象 (list)。
- 数据框是 R语言特有的数据类型, 也是进行统计分析最为有用的数据类型, 但是对于可能列入数据框中的列表对象有如下一些限制:
- （1）分量必须是[[向量]]（[[数值]]、[[字符]]、[[逻辑]]）、[[因子]]、[[数值矩阵]]、[[列表]]或其他数据框。
- (2) [[矩阵]]、[[列表]]和[[50 - 知识卡片/51 卡片,概念/R/数据框]]为新的数据框提供了尽可能多的变量, 因为它们各自拥有列元素或变量。
- (3) 数值向量、逻辑值、因子保持原有格式, 而字符向量会被强制转换成因子并且它的水平就是向量中出现的独立值。
- (4) 在数据框中以变量形式出现的向量长度必须一致, 矩阵结构必须有一样的行数。  

R  语言中用函数 [[data. frame]]() 生成数据框, 其句法是: 
```
data. frame(datal, data  2, \cdots) ,
```

![[R基础介绍与运算#3 数据框]]
## 2.5 多元数据的R语言调用

![[R基础介绍与运算#4 多元数据的R语言调用]]

## 2.6 多元数据的简单R语言分析
### 1.定量变量的分析
#### (1) 定量变量的基本特征
 - 最简单地==展现定量数据==的图形应是直方图 [[hist]] 函数。
 - ![[02,上机#1.1条形图]]
#### (2) 定量变量间的关系
描述==两个变量之间的关系==最有用的命令是散点图 [[plot]] 函数, 它也是 R中最强大的绘图函数。

![[02,上机#（1）plot()函数]]
### 2.定性变量的分析
#### (1) 单因素分析
[[read.table]]
#### (2) 两因素分析
#### (3) 三因素分析

