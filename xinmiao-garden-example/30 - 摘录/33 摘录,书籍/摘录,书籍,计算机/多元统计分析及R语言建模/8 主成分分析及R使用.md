---
书名: 多元统计分析及R语言建模
---

```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🔖 
🎏 class: #📸  

description ::  【目的要求】了解主成分分析的统计思想和实际意义, 以及它的数学模型和在二维 空间上的几何解释; 掌握主成分的推导步骤及其重要的基本性质; 能够利用计算软件, 自己编程解决实际问题并给出分析报告。【教学内容】主成分分析的目的和意义; 主成分分析的数学模型及几何解释; 主成 分的推导及基本性质; 计算程序中有关主成分分析的算法基础; 主成分分析的基本步骤 以及实证分析。

来源::

📎

```

主成分分析（principal component analysis, 简记 PCA) 是将多指标化为少数几个综合 指标的一种统计分析方法, 是由 Pearson (1901) 提出, 后来被 Hotelling (1933) 发展起 来的。主成分分析是通过降维技术把多个变量化为少数几个主成分的方法, 这些主成分 保留原始变量的绝大部分信息, 它们通常表示为原始变量的线性组合。通过主成分分析, 可以从事物错综复杂的关系中找出一些主要成分, 从而能有效利用大量统计数据进行定 量分析, 揭示变量之间的内在关系, 得到一些对事物特征及其发展规律的深层次的启发, 把研究工作引向深人。
每当学年要结束时, 学校老师总是要对学生的成绩作一番评估。如何评估呢? 以小 学为例, 一般学校的科目有语文、数学、自然、历史等。每个学生的成绩是各科成绩分 别加起来的, 如将语文、数学、自然和历史分数加起来作为总成绩。由于各门课程在总 分中占的比重不全相同, 单纯地把它们相加一般是不行的。依照各科考试的内容, 各科 目应当以加权比例来计算分数, 怎么做呢? 可以用  a_{1} 、 a_{2} 、 a_{3} 、 a_{4}  等系数（权数）大小 来作为加权的依据。例如,  a_{1} \times  语文  +a_{2} \times  数学  +a_{3} \times  自然  +a_{4} \times  历史, 即等于加权过后 的总成绩。这种方法实际上也是主成分分析的一种。
假定你是一个公司的财务经理, 掌握了公司的所有数据, 比如固定资产、流动资金、 每一笔借贷的数额和期限、各种税费、工资支出、原料消耗、产值、利润、折旧情况、 职工人数、职工的分工和教育程度等等。如果让你向上级介绍公司状况, 你能够把这些 指标和数字都原封不动地摆出去吗？当然不能。你必须对各个方面进行高度概括, 用一 两个指标简单明了地把情况说清楚。其实, 每个人都会遇到有很多变量的数据, 比如, 全国或各个地区带有许多经济和管理变量的数据; 各个学校的研究、教学等带有各种变 量的数据等。这些数据的共同特点是变量很多, 在如此多的变量之中, 有很多是相关的。 人们希望能够找出其中的少数 “代表” 来对它们进行描述。本章就是研究把变量维数降 低以便于描述、理解和分析的方法——主成分分析法。

## 8.1 主成分分析的直观解释
主成分分析就是一种通过降维技术把多个指标化为少数几个综合指标的统计分析方 法。其基本思想是：设法将原来众多具有一定相关性的指标, 重新组合成一组新的相互

无关的综合指标, 并代替原来的指标。数学上的处理就是对原来的  p  个指标作线性组合, 作为新的指标。第一个线性组合, 即第一个综合指标记为  y_{1} , 为了使该线性组合具有唯 一性, 要求在所有的线性组合中,  y_{1}  的方差最大, 即 var  \left(y_{1}\right)  最大, 它所包含的信息最 多。如果第一个主成分不足以代表原来  p  个指标的所有信息, 再考虑选取第二个主成分  y_{2} , 并要求  y_{1}  已有的信息不出现在  y_{2}  中, 即  \operatorname{cov}\left(y_{1}, y_{2}\right)=0  。
上面所述的成绩数据是四维的, 也就是说, 每个观测值是四维空间中的一个点。每 一维代表了一个变量。用少数综合变量表示原先的变量, 就是一个降维的过程。为了直 观地描述这个降维的过程，先假定数据只是两个变量的观测值，即二维数据。
![[Pasted image 20230419233227.png]]
主成分分析在变量降维方面扮演着很重要的角色, 是进行多变量综合评价的有力工具。从图 8-1 可见, 图中变量和成分间的关系  x_{1}  和  x_{2}  是沿着一定轨迹分布的 数据, 单独选择  x_{1}  或  x_{2}  都会丧失较多的原始信息。作正 交 (垂直) 旋转, 得到新的坐标轴  y_{1}  和  y_{2}  。旋转后数 据主要是沿  y_{1}  方向散布, 在  y_{2}  方向的离散程度很低, 另 外,  y_{1}  和  y_{2}  是互相垂直的, 表明它们互不相关。即使只 是单独提取变量  y_{1}  而放弃变量  y_{2} , 丧失的信息也是很微 小的。通常把  y_{1}  称为第一主成分,  y_{2}  称为第二主成分。 主成分分析的关键是要寻找一组相互正交的向量, 原变 量乘上该组正交的向量后能得到新变量组。

如果这两个变量分别由横轴和纵轴表示, 每个观测值都有相应于这两个坐标轴的两 个坐标值, 也就是这个二维坐标系中的一个点。如果这些数据点形成一个有椭圆形轮廓 的点阵, 那么这个椭圆就有一个长轴和一个短轴。在短轴方向上, 数据变化较小。如果 两个坐标轴和椭圆的长短轴平行, 那么代表长轴的变量就描述了数据的主要变化, 而代 表短轴的变量就描述了数据的次要变化。
但是, 坐标轴通常并不和椭圆的长短轴平行。因此, 需要寻找椭圆的长短轴, 并进 行变换, 使得新变量和椭圆的长短轴平行。如果长轴变量代表了数据包含的大部分信息, 就用该变量代替原先的两个变量 (舍去次要的短轴变量), 降维就完成了。在极端的情 况下, 即短轴如果退化成一点, 那么只有长轴变量才能够解释这些点的变化, 这样, 由 二维到一维的降维就自然完成了。图 8-1 就是一个这样的椭圆的示意图。椭圆的长短轴 相差得越大，降维也就越有道理。
以  x_{1}  和  x_{2}  表示图中的横轴和纵轴, 将  x_{1}  和  x_{2}  同时按逆时针方向旋转  \theta  度, 得到新的 坐标轴  y_{1}  和  y_{2}, y_{1}  和  y_{2}  是两个新变量, 其旋转公式为:

$$\left\{\begin{array}{l}
y_{1}=\cos \theta x_{1}+\sin \theta x_{2} \\
y_{2}=-\sin \theta x_{1}+\cos \theta x_{2}
\end{array}\right.$$

新变量  y_{1}  和  y_{2}  是旧变量  x_{1}  和  x_{2}  的线性组合，其矩阵形式为:

$$\left[\begin{array}{l}
y_{1} \\
y_{2}
\end{array}\right]=\left[\begin{array}{rr}
\cos \theta & \sin \theta \\
-\sin \theta & \cos \theta
\end{array}\right]\left[\begin{array}{l}
x_{1} \\
x_{2}
\end{array}\right]=U x$$

其中,  U  为旋转变换矩阵, 它是正交矩阵, 即  U U^{\prime}=I  。

多维变量的情况和二维类似, 也有高维的椭球, 只不过无法直观地看见罢了。首先 把高维椭球的各个主轴找出来, 再用代表大多数数据信息的最长的几个轴作为新变量, 这样, 主成分分析就基本完成了。注意: 和二维情况类似, 高维椭球的主轴也是互相垂 直的。这些互相正交的新变量是原先变量的线性组合，叫主成分。

【例  8-1  】续例  2-2 , 根据 12 名学生的生长发育指标数据作变量与主成分的关系图。

```
x 1=c(171,175,159,155,152,158,154,164,168,166,159,164) 
x 2=c(57,64,41,38,35,44,41,51,57,49,47,46) 
plot}(x 1, x 2, xlim =c(145,180), ylim =c(25,75)) 
lines(c(150,178), c(33,66)) ; text(180,68, "y1") 
lines(c(161,168), c(60,38)) ; text(161,63, "y2")
```

![[Pasted image 20230420094816.png]]

正如二维椭圆有两个主轴、三维椭球有三个主轴一样, 有几个变量, 就有几个主成 分。当然，选择越少的主成分，降维就越容易。而其标准就是这些被选中的主成分所代 表的主轴的长度之和占了主轴长度总和的大部分。有些文献建议, 所选主轴的总长度占 所有主轴长度之和的大约  85 \%  即可, 其实, 这只是一个大体的说法, 具体选几个, 要看 实际情况而定。但如果所有涉及的变量都不那么相关, 就很难降维, 这些不相关的变量 就只有自己代表自己了。
## 8.2 主成分分析的性质
### 1.主成分的一些说明
简而言之, 对于某一问题可以同时考虑好几个变量时, 我们并不对这些变量个别处 理，而是将它们综合起来处理，这就是主成分分析。
实际上, 主成分分析的主要目的是用较少的变量去解释原来资料中的大部分变异, 亦即期望能将手中许多相关性很高的变量转化成彼此互相独立的变量, 能由其中选取比 原始变量个数少且能解释大部分资料之变异的几个新变量, 也就是所谓的主成分, 而这 几个主成分也就成为我们用来解释资料的综合性指标。
那为什么要用解释变异的能力来寻找主成分呢? 以考试为例, 考试的目的是评估学 生的学习程度及能力, 当我们只想知道学生的学习程度如何时, 可借由一份良好的试卷 来测验出学生的学习程度分布状况。可是, 怎样才是一份良好的试卷呢? 当然是学习程

度好的学生所考的成绩较高, 而学习程度差的学生成绩就较低, 亦即试卷能真正反映出 学生学习程度差异的真实分布状况。就统计上而言, 即是此份考卷的分数能产生越大的 变异数 (方差), 就越能够反映学生彼此程度之差异。而在上例中, 当我们不想个别处 理四科成绩所反映的各科能力状况, 却想作一个总体性学习状况比较时, 便要用所谓的 主成分分析来找出主成分，这里的主成分即由原来四科成绩线性组合而成的新变量，亦 即一个可以帮助我们看出学生的四科学习状况的综合性指标。在此情况下，当然也希望 此指标能真正显示出学生学习程度的差异, 所以此指标能产生越大的变异数, 代表对学 生之学习程度差异拥有越大的反映及解释能力。事实上, 我们平常用的算术平均法, 将 四科成绩相加再除以 4 得到的平均成绩即是一种主成分，此乃主成分分析法中的一种特 例（即每个变量的加权程度相同）。
主成分分析的成分  y_{i}  和原来变量  x_{i}  之间的关系（假定原先有  p  个变量):

\left\{\begin{array}{c}
y_{1}=u_{11} x_{1}+u_{12} x_{2}+\cdots+u_{1 p} x_{p}=u^{\prime}{ }_{1} x \\
y_{2}=u_{21} x_{1}+u_{22} x_{2}+\cdots+u_{2 p} x_{p}=u_{2}^{\prime} x \\
\vdots \\
y_{p}=u_{p 1} x_{1}+u_{p 2} x_{2}+\cdots+u_{p p} x_{p}=u^{\prime}{ }_{p} x
\end{array}\right.

这里,  u_{i j}  为第  i  个成分  y_{i}  和第  j  个原先的变量  x_{j}  之间的线性相关系数。  y_{1}, y_{2}, \cdots, y_{p}  分别叫第一主成分, 第二主成分,  \cdots , 第  p  主成分, 而总和的特性 也就是用这些线性关系式的系数  u_{i 1}, u_{i 2}, \cdots, u_{i p}  来表示的。其中, 在选择加权数  u_{i 1} ,  u_{i 2}, \cdots, u_{i p}  时要使  y_{1}  能得到最大解释变异的能力, 即要使  y_{1}  能得到最大的变异数, 而  y_{2}  则能对原始资料中尚末被  y_{1}  解释的变异部分拥有最大解释能力, 若依此类推, 我们 可以找出  m  个  y(m \leqslant p) , 通常原始数据有  p  个  x  变量时, 经过转换后, 仍可找出  p  个  y  。然而我们最多只选择  m  个  y_{i}(i=1,2, \cdots, m, m \leqslant p) , 希望此越小越好, 但解释能 力却能达到  80 \%  以上。除此之外,  m  个  y_{i}  与原来的  p  个变量  x_{j}  的最大差别是：原始变 量中多为彼此相关的变量, 经过线性转换后所产生的  m  个  y_{i}  则为彼此不相关的新变量。
### 2.主成分的推导
设  y=a_{1} x_{1}+a_{2} x_{2}+\cdots+a_{p} x_{p}=a^{\prime} x 
其中,  a=\left(a_{1}, a_{2}, \cdots, a_{p}\right)^{\prime}, x=\left(x_{1}, x_{2}, \cdots, x_{p}\right)^{\prime} , 求主成分就是寻找  x  的线性函数  a^{\prime} x , 使相应的方差达到最大，即  \operatorname{var}\left(a^{\prime} x\right)=a^{\prime} \sum a  达到最大，且  a^{\prime} a=1  （目的是使  a  唯 一)。此处,  \Sigma  为  x  的协方差阵。
定理 8.1 设  A \geqslant 0  为对称阵，  \lambda_{i} 、 \lambda_{j}  是它的两个不相同的特征根，相应的特征向量  l_{i}  和  l_{j}  互相正交, 则  A  可表示为  A=T \Lambda T^{\prime}=\sum_{i=1}^{p} \lambda_{i} l_{i} l_{i}^{\prime} , 称为  A  的谱分解。即存在一个正交阵  T  ，使  T^{\prime} A T=\operatorname{diag}\left(\lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}\right)=\Lambda 。 T  的列向量为相应的特征向量。
设  \sum  的特征根为  \lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0 , 相应的单位特征向量为  u_{1}, u_{2}, \cdots, u_{p} , 令  U=\left(u_{1}, u_{2}, \cdots, u_{p}\right) , 则  U^{\prime} U=U U^{\prime}=I , 即  U  为正交阵, 且:

\Sigma=U \Lambda U^{\prime}=U \operatorname{diag}\left(\lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}\right) U^{\prime}=\sum_{i=1}^{p} \lambda_{i} u_{i} u_{i}{ }^{\prime}

因此,  a^{\prime} \sum a=\sum_{i=1}^{p} \lambda_{i} a^{\prime} u_{i} u_{i}{ }^{\prime} a=\sum_{i=1}^{p} \lambda_{i}\left(a^{\prime} u_{i}\right)\left(a^{\prime} u_{i}\right)^{\prime}=\sum_{i=1}^{p} \lambda_{i}\left(a^{\prime} u_{i}\right)^{2} 
于是,  a^{\prime} \sum a \leqslant \lambda_{1} \sum_{i=1}^{p}\left(a^{\prime} u_{i}\right)^{2}=\lambda_{1}\left(a^{\prime} U\right)\left(a^{\prime} U\right)^{\prime}=\lambda_{1} a^{\prime} U U^{\prime} a=\lambda_{1} a^{\prime} a=\lambda_{1}  。

当取  a=u_{1}  时,  u_{1}^{\prime} \sum u_{1}=u_{1}^{\prime} \lambda_{1} u_{1}=\lambda_{1}  。于是  y_{1}=u_{1}^{\prime} x  就是第一主成分, 它的方差最 大, 为  \operatorname{var}\left(y_{1}\right)=\operatorname{var}\left(u_{1}^{\prime} x\right)=\lambda_{1}  。
同理,  \operatorname{var}\left(y_{i}\right)=\operatorname{var}\left(u_{i}^{\prime} x\right)=\lambda_{i}  。
另外,  \operatorname{cov}\left(y_{i}, y_{j}\right)=\operatorname{cov}\left(u_{i}{ }^{\prime} x, u_{j}^{\prime} x\right)=u_{i}{ }^{\prime} \sum u_{j}=u_{i}{ }^{\prime} \lambda_{j} u_{j}=\lambda_{j} u_{i}{ }^{\prime} u_{j}=0, i \neq j  。
上述推导表明: 变量  x  的主成分  y  是以  \Sigma  的特征向量为系数的线性组合, 它们是互 不相关、方差为  \sum  的特征根。而  \Sigma  的特征根  \lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0 , 所以有:  \operatorname{var}\left(y_{1}\right) \geqslant   \operatorname{var}\left(y_{2}\right) \geqslant \cdots \geqslant \operatorname{var}\left(y_{p}\right)>0  。
3. 主成分的性质
根据以上分析, 我们可得出主成分的如下一些性质:
(1)  y=U^{\prime} x, U^{\prime} U=I , 这里,  U  为  x  的协方差阵的特征向量组成的正交阵。
(2)  y  的各分量之间是互不相关的。
(3)  y  的  p  个分量是按方差大小由大到小排列的。
(4)  y  的协方差阵为对角阵。
(5)  \sum_{i=1}^{p} \sigma_{i i}=\sum_{i=1}^{p} \lambda_{1} , 这里,  \sum=\left(\sigma_{i i}\right)_{p \times p}  。
由 (5) 知,  \sum_{i=1}^{p} \operatorname{var}\left(y_{i}\right)=\sum_{i=1}^{p} \operatorname{var}\left(x_{i}\right) , 也就是说, 主成分把  p  个原始变量的总方差分 解成  p  个不相关的新变量的方差之和。主成分分析的目的就是减少变量的个数, 忽略一 些较小方差的主成分不会给总方差带来大的影响。
定义  \lambda_{k} / \sum_{i=1}^{p} \lambda_{i}  为第  k  个主成分  y_{k}  的方差贡献率, 第一个主成分的贡献率最大, 表明  y_{1}  综合原始变量  x_{1}, x_{2}, \cdots, x_{p}  的能力最强, 而  y_{2}, y_{3}, \cdots, y_{p}  的综合能力依次递减。若 只取  m(<p)  个主成分, 则称  \sum_{i=1}^{m} \lambda_{i} / \sum_{i=1}^{p} \lambda_{i}  为主成分  y_{1}, y_{2}, \cdots, y_{m}  的累积方差贡献率, 它 表明  y_{1}, y_{2}, \cdots, y_{m}  的综合  x_{1}, x_{2}, \cdots, x_{p}  的能力, 通常取  m  使得累积贡献率不低于  80 \%  即可 (一些文献也认为只要特征根  \lambda_{i}  大于 1 即可)。
(6)  a\left(y_{i}, x_{j}\right)=\sqrt{\lambda_{i}} u_{i j} / \sqrt{\sigma_{i j}} , 这里  i, j=1,2, \cdots, p_{\text {。 }} 
这里,  a\left(y_{i}, x_{j}\right)  表示第  i  个主成分  y_{i}  与原来变量  x_{j}  的相关系数, 也称为主成分负荷 (loadings, 在因子分析中称为因子载荷), 矩阵  A=\left(a_{i j}\right)  称为因子载荷矩阵。在实际中, 通 常用  a_{i j}  代替  u_{i j}  作为主成分系数, 因为它是标准化系数，能反映变量影响的大小。
## 8.3 主成分分析的步骤
### 1.主成分的计算步骤
(1) 设有  n  个样品,  p  个指标, 将原始数据标准化, 得标准化数据矩阵:

X=\left[\begin{array}{cccc}
x_{11} & x_{12} & \cdots & x_{1 p} \\
x_{21} & x_{22} & \cdots & x_{2 p} \\
\vdots & \vdots & \vdots & \vdots \\
x_{n 1} & x_{n 2} & \cdots & x_{n p}
\end{array}\right]

(2) 建立变量的相关系数阵:  R=\left(r_{i j}\right)_{p \times p}=X^{\prime} X  。
(3) 求  R  的特征值  \lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0  及相应的单位特征向量:


u_{1}=\left[\begin{array}{c}
u_{11} \\
u_{21} \\
\vdots \\
u_{p 1}
\end{array}\right], u_{2}=\left[\begin{array}{c}
u_{12} \\
u_{22} \\
\vdots \\
u_{p 2}
\end{array}\right], \cdots, u_{p}=\left[\begin{array}{c}
u_{1 p} \\
u_{2 p} \\
\vdots \\
u_{p p}
\end{array}\right]

(4) 写出主成分:  y_{i}=u_{i 1} x_{1}+u_{i 2} x_{2}+\cdots+u_{i p} x_{p} , 这里  i=1,2, \cdots, p  。
2. 主成分的分析过程
(1) 将原始数据标准化, 以消除变量间在数量级和量纲上的不同。
(2) 求标准化数据的相关矩阵。
(3) 求相关矩阵的特征值和特征向量。
(4) 计算方差贡献率与累积方差贡献率：每个主成分的贡献率代表了原数据总信息 量的百分比。
(5) 确定主成分：设  C_{1}, C_{2}, \cdots, C_{p}  为  p  个主成分, 其中前  m  个主成分包含的数据信 息总量（即其累积方差贡献率）不低于  80 \%  时，可取前  m  个主成分来反映原评价对象。
（6）用原指标的线性组合来计算各主成分得分：以各主成分对原指标的相关系数 (即载荷系数) 为权, 将各主成分表示为原指标的线性组合, 而主成分的经济意义则由 各线性组合中权数较大的指标的综合意义来确定, 即

C_{j}=a_{j 1} x_{1}+a_{j 2} x_{2}+\cdots+a_{j p} x_{p} \text {, 这里 } j=1,2, \cdots, m

（7）综合得分：以各主成分的方差贡献率为权，将其线性组合得到综合评价函数。

C=\frac{\lambda_{1} C_{1}+\lambda_{2} C_{2}+\cdots+\lambda_{m} C_{m}}{\lambda_{1}+\lambda_{2}+\cdots+\lambda_{m}}=\sum_{i=1}^{m} \omega_{i} C_{i}

(8) 得分排序：利用总得分可以得到得分名次。
下面是用 R 语言进行主成分分析的主要命令。
princomp  (x , cor  =  FALSE, scores  =  TRUE, \ldots) 
 \mathrm{x}  : 数据矩阵或数据框 cor; 是否用相关阵, 默认为协差阵; scores:是否输出成分得分
screeplot  (  obj ,type  =c(  " barplot" , "lines"  ), \ldots) 
obj:主成分分析对象;type:图形类型
碎石图是一种可以帮助我们确定主成分合适个数的有用的视觉工具, 将特征值从大 到小排列, 选取一个拐弯点对应的序号, 此序号后的特征值全部较小且彼此大小差不多, 这样选出的号码作为主成分的个数。
自编综合得分排名函数 princomp. rank()  的用法
princomp. rank  <-  function  (\mathrm{PCA}, \mathrm{m}=2 , plot  =\mathrm{F}) \quad  \# library  (  mvstats  ) 
PCA:主成分对象;m: 主成分个数;plot: 是否画成分图
注: 该函数用来进行综合得分排名，建议读者使用下章的主因子综合评分函数 factpc，其效果更好些!
【例 8-2】(续例 7-2) 对例 7-2 数据应用主成分分析方法进行综合评价。

下面应用主成分分析方法, 以例 7-2 的八个指标作为原始变量, 使用  R  语言, 对我 国 31 个省、市、自治区的人均消费水平作分析评价，并根据因子得分和综合得分对各 省、市、自治区的人均消费水平进行综合分析。
(1) 计算相关矩阵。

```#在 mvstats4. xls: 7.2  中选取 A1: I32  区域, 然后拷贝  
X=read. table ("clipboard",header =T)   
cor(X) 
```

![[Pasted image 20230420102720.png]]

(2) 求相关矩阵的特征值和主成分负荷。
```
PCA  =princomp(X,cor=T) #主成分分析
PCA #特征值开根号结果
```

Call:

$princomp  (\mathrm{x}=\mathrm{X} , cor  =\mathrm{T})$

$Standard deviations:$

$Comp. 1 Comp. 2 Comp. 3 Comp. 4 Comp. 5 Comp. 6 Comp. 7 Comp. 8$

$\begin{array}{llllllll}2.388 & 1.014 & 0.710 & 0.522 & 0.431 & 0.402 & 0.296 & 0.242\end{array}$

$8 variables and 31 observations.$

```
summary (PCA)
```

$Importance of components :$

$Comp. 1 Comp. 2 Comp. 3 Comp. 4 Comp. 5 Comp. 6 Comp. 7 Comp. 8$
$\begin{array}{lllllllll}\text { Standard deviation } & 2.388 & 1.014 & 0.710 & 0.5223 & 0.4314 & 0.4016 & 0.2955 & 0.24155\end{array}$ 
$\begin{array}{lllllllll}\text { Proportion of Variance } & 0.713 & 0.129 & 0.063 & 0.0341 & 0.0233 & 0.0202 & 0.0109 & 0.00729\end{array}$ 
$\begin{array}{lllllllll}\text { Cumulative Proportion } & 0.713 & 0.841 & 0.904 & 0.9384 & 0.9616 & 0.9818 & 0.9927 & 1.00000\end{array}$ 

```
PCA $loadings \#主成分载荷
```

Loadings :
$Comp. 1 Comp. 2 Comp. 3 Comp. 4 Comp. 5 Comp. 6 Comp. 7 Comp. 8$
$\begin{array}{lrrrrrrrr}\mathrm{X} 1 & -0.353 & 0.429 & 0.175 & 0.299 & & -0.377 & 0.651 & \\ \mathrm{X} 2 & -0.249 & -0.677 & 0.521 & & -0.399 & -0.129 & 0.134 & \\ \mathrm{X} 3 & -0.374 & & & -0.789 & 0.261 & & 0.116 & 0.372 \\ \mathrm{X} 4 & -0.302 & -0.472 & -0.628 & 0.225 & 0.249 & -0.416 & & \\ \mathrm{X} 5 & -0.376 & 0.324 & 0.123 & 0.127 & -0.281 & -0.267 & -0.695 & 0.298 \\ \mathrm{X} 6 & -0.404 & & -0.200 & 0.132 & -0.156 & -0.857 & & \\ \mathrm{X} 7 & -0.371 & & -0.442 & & -0.584 & 0.535 & 0.166 & \\ \mathrm{X} 8 & -0.374 & -0.118 & 0.282 & 0.409 & 0.522 & 0.546 & & 0.141\end{array}$ 

(3) 确定主成分。
按照累积方差贡献率大于  80 \%  原则, 选定了两个主成分, 其累积方差贡献率为  80.7 \% , 本例取  m=2  。从碎石图上也可以看出  m  取 2 比较合适。

![[Pasted image 20230420105320.png]]

(4) 主成分得分。
```
PCA$scores[, 1:2] #主成分得分
```

![[Pasted image 20230420105858.png]]

 结果分析：由主成分载荷矩阵可以看出, 主成分 Comp. 1 在  X_{3}  (人均家庭设备用品 及服务支出）、  X_{5}  (人均交通和通信支出）、  X_{6}  （人均娱乐教育文化服务支出）、  X_{7}  (人 均居住支出）、  X_{8}  (人均杂项商品和服务支出）上的载荷值都很大, 可视为非必需消费 主成分; Comp. 2 在  X_{1}  (人均食品支出）、  X_{2}  (人均衣着商品支出)、  X_{4}  (人均医疗保健 支出）上有较大的载荷, 可视为反映日常必需消费的主成分。有了各个主成分的解释, 结合各个省、市、自治区在两个主成分上的得分和综合得分, 就可以对各省、市、自治 区的综合人均消费水平进行评价了。
最后, 由加权法估计出综合得分, 以各主成分的方差贡献率占两个主成分总方差贡 献率的比重作为权重进行加权汇总, 得出各省、市、自治区的综合得分, 即

$P C=\left(2.388^{\wedge} 2 \times \text { Comp. } 1+1.014^{\wedge} 2 \times \text { Comp. } 2\right) /\left(2.388^{\wedge} 2+1.014^{\wedge} 2\right)$

各省、市、自治区的主成分得分及排名如下。

```
library (mvstats)
princomp.rank(PCA, m=2)  #主成分排名
```

$$\begin{array}{lrrrr} 
& \text { Comp. } & \text { Comp. } & \text { PC } & \text { rank } \\
\text { 北京 } & -6.1223 & -1.523 & -5.4192 & 2 \\
\text { 天津 } & -3.0101 & -0.537 & -2.6321 & 5 \\
\text { 河北 } & 0.8875 & -0.692 & 0.6460 & 14 \\
\text { 山西 } & 1.1037 & -0.601 & 0.8431 & 16 \\
\text { 内蒙古 } & -0.5333 & -1.848 & -0.7343 & 8 \\
\text { 迣宁 } & -0.0944 & -0.655 & -0.1801 & 11 \\
\text { 吉林 } & 0.3271 & -1.425 & 0.0593 & 12 \\
\text { 黑龙江 } & 1.6886 & -0.996 & 1.2783 & 24 \\
\text { 上海 } & -7.0847 & 1.069 & -5.8383 & 1 \\
\text { 江苏 } & -1.1413 & 0.454 & -0.8975 & 6 \\
\text { 浙江 } & -3.8211 & -0.172 & -3.2634 & 3 \\
\text { 安徽 } & 1.1234 & 0.352 & 1.0054 & 20 \\
\text { 福建 } & -1.1717 & 1.378 & -0.7820 & 7 \\
\text { 江西 } & 1.6694 & 0.548 & 1.4981 & 26 \\
\text { 山东 } & -0.4811 & -0.808 & -0.5311 & 9 \\
\text { 河南 } & 1.2772 & -0.648 & 0.9830 & 19 \\
\text { 湖北 } & 1.0095 & 0.117 & 0.8730 & 17 \\
\text { 湖南 } & 0.3651 & -0.201 & 0.2786 & 13 \\
\text { 广东 } & -4.0320 & 2.480 & -3.0365 & 4 \\
\text { 广西 } & 1.6274 & 1.231 & 1.5667 & 27 \\
\text { 海南 } & 1.8731 & 2.353 & 1.9464 & 29 \\
\text { 重庆 } & -0.3940 & -0.462 & -0.4045 & 10 \\
\text { 四川 } & 1.1538 & 0.518 & 1.0566 & 22 \\
\text { 贵州 } & 2.0140 & 0.659 & 1.8070 & 28 \\
\text { 云南 } & 2.4295 & 0.418 & 2.1220 & 30 \\
\text { 西藏 } & 2.7204 & 1.011 & 2.4590 & 31 \\
\text { 陕西 } & 0.8880 & -0.117 & 0.7344 & 15 \\
\text { 甘肃 } & 1.3245 & -0.144 & 1.1000 & 23 \\
\text { 青海 } & 1.7685 & -0.209 & 1.4662 & 25 \\
\text { 宁夏 } & 1.3173 & -0.496 & 1.0402 & 21 \\
\text { 新疆 } & 1.3181 & -1.053 & 0.9558 & 18
\end{array}$$

以第一主成分为横轴, 第二主成分为纵轴, 绘制各省、市、区的成分图, 见下图。

```
princomp. rank(PCA, m=2, plot }=T)  #主成分作图
```

![[Pasted image 20230420162335.png]]

在非必需消费主成分 Comp. 1 上得分最高的前五个省、市、自治区依次是上海、北 京、广东、浙江和天津, 且上海、北京绝对值明显高于其他省、市、自治区, 这就是说 以设备、交通、教育、居住、杂项等为主的非日常必需消费而言, 上海、北京的消费水 平远远高于其他省、市、自治区; 而西藏和云南在这方面的消费相对较低些。北京、内 蒙古和吉林在主成分 Comp. 2 上的得分较高, 可见这些地自治区人们用于衣着和医疗方 面的消费支出不小。就该因子而言, 得分较低的是广东和海南。衣着受气候的影响较大, 北部、西北部省、市、自治区的人们为了御寒, 在这方面的支出较多。广东、海南、福 建、广西、上海和西藏在主成分 Comp. 2 上为正值且相对较高, 表明这些地区食品支出 较多。就综合得分来看, 上海、北京、广东、浙江、天津这 5 个省、市的得分最高, 江 西、贵州、黑龙江省得分位于全国之末, 故可知北京、上海、广东、浙江、天津这 5 个 省、市的综合人均消费水平居于全国前列，江西、贵州、黑龙江省的综合人均消费水平 居于全国之末。由于北京、上海、广东、浙江、天津这 5 个省、市是我国经济发展水平 较高的 5 个省、市，而西藏、云南、海南和贵州省是我国较为贫困的省份，可见我国各 地区城镇的人均消费水平主要是由经济发展水平决定的，经济发展水平较高的省、市、 自治区, 其城镇人均消费水平也相对较高, 经济较落后的地区, 其城镇人均消费水平也相对较低。

## 8. 4 应用主成分分析的注意事项
主成分分析是首先由 K. Pearson 于 1901 年提出，再由 Hotelling（1933）加以发展的 一种多变量统计方法。其主要目的是将许多变量减少，使其变为少数几个互相独立的线 性组合变量 (主成分), 而经由线性组合而得到的成分的变异数会变为最大，使得受试 者在这些成分上显出最大的个体差异来。
主成分分析除了用来概述变量间的关系外，亦可用来削减回归分析或聚类分析中变 量的数目。此外, 为了达到最大变异的目的, 我们可用主成分分析将原来的变量转变为成分, 在抽出成分之后, 可将各变量的原始分数转换为成分分数, 以供进一步深人地统 计分析。通常，在进行主成分分析时，应注意下列五点:
(1) 主成分分析, 可使用样本协方差矩阵或相关系数矩阵为出发点来进行分析, 但 大都以相关系数矩阵为主
(2) 为使方差达到最大, 通常主成分分析是不加以转轴的。
(3) 成分的保留: Kaiser (1960) 主张放弃特征值小于 1 的成分, 而只保留特征值大 于 1 的成分 (成分保留的其他标准，可参考书中的内容)。
(4) 在实际研究里, 研究者如果用不超过三或五个成分就能解释变异的  80 \% , 就算 令人满意。
(5) 使用成分得分后，会使各变量的方差为最大，而且各变量之间会彼此独立正交。
## 案例分析: 地区电信业发展情况的主成分分析

党的十三届四中全会以来, 我国的电信业始终保持高速发展的态势。目前, 电信业务 已经完成了从人工向自动、由模拟技术向数字技术、由小容量到大容量、由单一业务向多 种业务的转变, 已经成为我国国民经济的增长点和重要支柱产业之一。2003 年, 我国的电 信业仍然保持很高的增长速度, 广东电信业务发展也加快, 主要电信业务量稳居全国首位。 2003 年, 广东电信各运营公司在不断加剧的市场竞争中, 纷纷采取有力措施拼抢市 场份额，使电信用户获得更多实惠，电信业务保持高速发展，综合实力再上新台阶。然 而, 广东省各市之间发展却进一步分化, 表现出不平衡性。本例目的是探索广东省 2003 年各地区电信业发展的差异性, 探求引起差异的主要原因, 找出解决问题的方法, 实现 各地区的共同发展，避免因个别落后地区导致整体水平的下降。
本案例通过主成分分析和聚类分析的综合应用来研究各城市 2003 年在电信业发展方 面的相似性和差异性，并加以分析，以寻找取得进展的方法。
本例选取了广东省 21 个地级市 2003 年度电信业发展数据。这些城市分别是：广州 市、珠海市、汕头市、深圳市、佛山市、韶关市、河源市、梅州市、惠州市、汕尾市、 东莞市、中山市、江门市、阳江市、湛江市、茂名市、肇庆市、清远市、潮州市、揭阳 市、云浮市。共选取了电信业的如下七个主要指标:
 X_{1}  ：电信业务总量 (万元);
 X_{2}  ：每百人拥有固定电话数 (个);
 X_{3}  : 每百人拥有移动电话数 (个);
 X_{4}  ：国际互联网用户 (万户);
 X_{5}  : 互联网用户使用时长 (万分钟);
 X_{6}  : 长途电话通话量 (万次);
 X_{7}  ：长途电话通话时长 (万分钟)。

### 二、 R语言操作
#### 1.调入数据
将 Case7 中的数据复制, 然后在 RStudio 编辑器中执行 Case7 = read. table (" clipboard", header  =\mathrm{T})  。
#### 2.聚类分析 (宏观分析, 区域划分)
2003 年里, 广东省各地区电信业发展除了差异性外, 还有集中发展的趋势。我们可 以利用聚类分析将广东省的各市分成几类。各类代表了不同的发展水平, 同时每类所包 含的城市具有类似的发展水平。经过分析, 我们也得到一点启示：各市在发展电信业时, 不能只片面强调通信总量, 同时也要注意人均量的发展, 注意在全地区范围内的普及。 只有人均水平提升了, 才真正具有意义, 也才能说该城市的电信水平真正提高了。一个 城市的电信业只有全面发展了, 才能经受住 WTO 的冲击, 才能保持良好的竞争力。同 时, 就广东省而言, 尽管它的电信业总量 2003 年排到了全国之首, 但是各地区间存在严 重的差异。珠三角地区发展迅猛, 电信业务总量大, 市场份额高, 而经济欠发达地区特 别是山区和农村则发展较慢, 总量小、份额低。对此, 广东省政府应加快经济欠发达地 区的电信建设, 大力扩展山区电信市场, 并采取扶持措施加强农村市场建设, 促进广东 省各地区电信业的协调发展。作为落后城市, 也应该积极采取措施加速自身发展, 提高 竞争力, 从而避免成为 “拖油瓶”。
![[Pasted image 20230420165053.png]]

广东省各城市按电信业发展水平应该分成四类
![[Pasted image 20230420165211.png]]

#### 主成分分析 (微观分析, 综合排名)
由于指标多, 不便于综合分析, 先采用主成分分析法提取主要成分, 然后进行相应的 分析。用 R 软件运行后我们发现可以提取两个主要成分，这两个成分占全部的  96.14 \% , 可 以说是基本代表了全部指标的信息量。
经过主成分分析，我们发现可以提取两个主成分 Comp. 1、Comp. 2。
第一个主成分 Comp. 1 主要由  $X_{1}$  (电信业务总量)、  $X_{4}$  （国际互联网用户)、  $X_{5}$  (互联 网用户使用时长)、  $X_{6}$  (长途电话通话量)、  $X_{7}$  (长途电话通话时长) 决定, 这 5 个指标是 总量因素, 说明一个城市的电信业规模和电信通信业务发展水平。
第二个主成分 Comp. 2 主要由  $X_{2}$  (每百人拥有固定电话数)、  $X_{3}$  (每百人拥有移动电话 数）决定。这两个指标是平均量成分，反映了电信行业中的电话人均普及情况。
由于我们在主成分分析后选取的两个主成分  $P C_{1}$ 、 $P C_{2}$  就代表了  96.14 \%  的信息, 可以说基本表征了我们全部的指标。所以我们用提取的主成分进行各城市的综合分析。
我们发现七个经济指标可以用两个综合指标代替，而综合指标的信息没有损失多少。 在此基础上, 我们不仅可以算出各城市的成分得分, 而且可以利用线性加权方法, 以各主 成分的贡献率为权数, 即按公式  \left(0.738 \times P C_{1}+0.223 \times P C_{2}\right) /(0.738+0.223)  计算各城 市电信业发展水平的综合得分并据此排名。其主成分得分和排名见下图。
![[Pasted image 20230420165341.png]]
通过对各城市进行排名后, 我们发现, 排名比较靠前的地区有深圳、广州、东莞、惠 州和佛山。比较靠后的地区有汕尾、湛江、茂名和阳江。
我们也可以从主成分得分图上清楚地看到, 第一主成分 Comp. 1 和第二主成分 Comp. 2 得分最高的均为深圳, 而广东省各城市排名中稍有争议的是惠州、中山和茂名。我们回过 去看前面的数据, 发现尽管惠州市的第一主成分 Comp. 1 水平, 即通信发展水平低于中山 市, 但其第二主成分 Comp. 2 因子, 即电话普及水平是远远超过中山的, 而第二主成分 Comp. 2 所占的比重为全部变量的  22.34 \% , 这也是不容忽视的。而茂名市由于其互联网用 户不够多而且人均电话普及量不够, 其他两个主成分的得分都不高, 而第二主成分尤其偏 低, 从而它的排名比较靠后。从主成分得分图上看到:
(1) 广州在第二象限, 远离 Comp. 1 和 Comp. 2 轴。这说明广州的第一主成分 Comp. 1 得分比较高, 仅次于深圳; 但是第二主成分 Comp. 2 得分较低。我们知道 Comp. 1 代表了电 信业通信业务发展的总量水平, 而 Comp. 2 代表了电信业发展的平均量水平。结合 Comp. 1、 Comp. 2 的意义来分析, 广州是广东的省会城市, 经济、文化等各项总量发展水平都不错, 电信业发展总量也不错, 故而 Comp. 1 得分比较高, 仅次于深圳, 但是由于广州也是一个大 型开放性城市, 人口也很多, 人口增长的速度明显比电信业发展快, 这样计算下来的人均 量就不如深圳高了。

(2) 梅州和惠州的情况和广州有点相反, 它们在电信总量方面不如广州, 但由于其人 口比较少, 人均量高, 从而尽管 Comp. 1 得分比较低, 但 Comp. 2 有着很高的得分。这表现 在主成分图上就是离 Comp. 2 轴很近, 离 Comp. 1 轴很远。由于其特殊性, 我们将它们单独 分成一类。
(3) 从图上我们看到深圳的位置在图中离原点比较远, 同时它到 Comp. 1 轴和到 Comp. 2 轴的距离都比较远。这说明深圳 Comp. 1 和 Comp. 2 的得分都比较高。深圳作为一 个经济特区, 自改革开放以来, 各方面发展速度很快, 是个发达城市, 其移动电话用户比 较多。近年来移动电话的发展在电信业发展中异军突起, 也占据了重要地位。而与广州有 所不同, 深圳的人口总数不算太多, 从而其电话普及率可以达到很高。正因为如此, 它的 Comp. 2 得分较高。同时由于其发达性, 电话和互联网用户很多, 电信业发展总量也不错, 从而 Comp. 1 有着很高的得分, 在广东所有城市中排名第一。很高的 Comp. 1 得分和比较 高的 Comp. 2 得分就决定了深圳在排名时可以领先于广州而居于第一位。
(4) 东莞的情形有点类似于广州和深圳。它的 Comp. 1 和 Comp. 2 的得分都不低, 且 为负数, 所以具有比较高的排名。
(5) 佛山从主成分图上看比较接近 Comp. 2 轴, 离 Comp. 1 轴稍远。这表明佛山电信 业在总量方面取得的成绩还是很显著的。但是人均普及量不够高, 从而主成分 Comp. 2 得分为正。又由于其与 Comp. 1 的得分相当，故排在第 5 名。
(6) 汕头等六个城市集中在 Comp. 2 轴附近, 但由于其有正有负, 且得分比较低, 从而它们的排名相对比较靠后。而中山和汕头有着正的 Comp. 1 和 Comp. 2 得分, 从而也 使其排名靠后。江门等其余城市也集中在原点右上方, 这表明它们的两个主成分得分都 比较低, 这就解释了为什么它们的排名比较靠后。
该案例程序如下所示:

```
Case7 = read. table  ("clipboard" , header =T) ; Case7
library (mvstats)
H. clust ( scale ( Case7))
PC=princomp(Case7, cor =T) 
summary  (PC) 
m=2 
PC$loadings[, 1: m] 
princomp.  rank(PC, m) 
princomp.  rank(PC, m, plot=T) 
```

思考练习题
一、思考题（手工解答，上交作业本)
1. 试述主成分分析的基本思想。
2. 总结主成分分析的计算步骤。
3. 试述主成分分析在多指标统计分析应用中的注意事项。
4. 简要分析主成分分析如何解决多指标综合评价中的权重问题。