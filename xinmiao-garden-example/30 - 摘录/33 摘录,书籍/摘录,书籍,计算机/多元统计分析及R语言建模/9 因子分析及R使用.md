---
标题: 多元统计分析及R语言建模
创建时间: 2023-11-10 15:13
修改时间: <%+ tp.file.last_modified_date() %>
tags: 
类型1: 
用途: 模板
---

#软件 #笔记 #写作
```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🔖 
🎏 class: #📸  

description :: 【目的要求】要求学生了解因子分析的目的和实际意义, 特别是因子分析模型的统 计思想; 要熟悉因子分析数学模型建模的假设条件和各个分量的实际统计意义; 掌握由 主因子方法估计因子载荷矩阵的推导步骤以及重要的基本性质; 能够利用计算机软件, 自己编程解决实际问题中的因子分析问题, 同时能给出初步的统计分析报告。【教学内容】因子分析模型的基本思想, 因子分析模型与主成分分析模型在本质上 的区别; 因子分析的数学模型、基本假定, 因子载荷矩阵的估计方法, 因子旋转, 因子 得分；因子旋转（主要是方差最大正交旋转方法）与因子得分的实际统计意义和它们的 数学表达式; 计算程序中有关因子分析的算法基础。

来源::

📎

```

## 9.1 因子分析的思想
主成分分析通过线性组合将原变量综合成几个主成分, 用较少的综合指标来代替原 来较多的指标 (变量)。在多变量分析中, 某些变量间往往存在相关性。是什么原因使 变量间有关联吅? 是否存在不能直接观测到的、但会影响可观测变量变化的公共因子呢? 因子分析 (factor analysis) 就是寻找这些公共因子的模型分析方法, 它是在主成分的基 础上构筑若干意义较为明确的公因子, 以它们为框架分解原变量, 以此考察原变量间的 联系与区别。
例如，随着年龄的增长，儿童的身高、体重会跟着变化，它们具有一定的相关性。 身高和体重之间为何会有相关性呢? 因为存在着一个同时支配或影响身高与体重的生长 因子。那么, 我们能否通过对多个变量的相关系数矩阵的研究，找出同时支配或影响所 有变量的共性因子呢? 因子分析就是从大量的数据中 “由表及里” “去粗取精”, 寻找影 响或支配变量的多变量统计方法。
又如, 假设我们要研究影响人们对生活满意度的潜在因子, 为此对有关项目进行问 卷调查, 包括三项工作方面和三项家庭方面的满意度调查。由于三项工作满意度调查项 目之间具有较高的相关性, 三项家庭满意度调查项目之间也具有较高的相关性, 因此工 作满意度调查项目与家庭满意度调查项目之间的相关性较低。假定可以用变量间的相关 性将它们分组, 即假设在一个特定组内的所有变量之间是高度相关的, 而与不同组内的 变量却有较小的相关性。可想而知, 各组变量可以找到潜在的单一因子对观察到的相关 指标负责。因而, 一组变量存在一个潜在的因子-工作满意度, 另一组变量对应另一 个潜在因子一一家庭满意度，且两个因子相对独立。对于问卷的回答显然有赖于所找到 的两个潜在因子。而且, 每一调查项目线性依赖于这两个潜在的因子和每一调查项目独 有的特殊因子。
可以说, 因子分析是主成分分析的推广, 也是一种把多个变量化为少数几个综合变 量的多变量分析方法, 其目的是用有限个不可观测的隐变量来解释原始变量之间的相关
关系。
因子分析的主要用途在于：(1)减少分析变量个数; (2)通过对变量间相关关系的探测, 将原始变量进行分类。即将相关性高的变量分为一组, 用共性因子代替该组变量。
就统计上而言, 主成分分析所侧重的是如何 “转换” 原始变量, 使之成为一些综合 性的新指标, 其关键在于 “变异数” 问题。与主成分分析不同, 因子分析重视的是如何 解决变量之间的 “共变异数” 问题。因为每一反应变量均为一些 “共同因子变量” 和 “特殊性变量” 的线性函数。其中 “共同因子变量” 可反映变量之间的共变量, 而特殊 性变量部分则只对其所属的变量之变异数有所贡献, 所以主成分分析是 “变异数” 导向 的方法，因子分析则是 “共变异数” 导向的方法
因子分析也是数据缩减的一种多变量分析方法, 它是基于信息损失最小化而提出的 一种非常有效的方法。它把众多的指标综合成较少的几个公共指标，这些指标即因子。 因子的特点是：第一, 因子变量的数量远远少于原始变量的个数; 第二, 因子变量并非 原始变量的简单取舍, 而是一种新的综合; 第三, 因子变量之间没有线性关系; 第四, 因子变量具有明确的解释性, 可以最大限度地发挥专业分析的作用。因子分析就是以最 小的信息损失, 将众多的原始变量浓缩成少数几个因子变量, 使得变量具有更高的可解 释性的一种数据缩减方法，是多变量分析的主干技术之一。
## 9.2 因子分析模型
### 1.模型的提出
因子分析法是从研究变量内部相关的依赖关系出发, 把一些具有错综复杂关系的变 量归结为少数几个综合因子的一种多变量统计分析方法。它的基本思想是将观测变量进 行分类, 将相关性较高, 即联系比较紧密的分在同一类中, 而不同类变量之间的相关性 则较低, 那么每一类变量实际上就代表了一个基本结构, 即公共因子。对于所研究的问 题, 试图用最少个数的不可测的公共因子的线性函数与特殊因子之和来描述原来观测的 每一分量。
可以把因子分析看成是主成分分析的推广, 即可从研究相关矩阵内部的依赖关系出 发, 把一些具有错综复杂关系的变量归结为少数几个综合因子, 还可用于对变量或样本 进行分类处理。根据因子得分值, 在因子轴所构成的空间中把变量或样本点画出来, 达 到形象直观的分类目的。研究样本间的相互关系的因子分析称为  Q  型因子分析, 而研究 变量间相互关系的因子分析称为  \mathrm{R}  型因子分析, 下面主要讨论并运用的是  \mathrm{R}  型因 子分析。
### 2.因子分析模型
(1)  X=\left(x_{1}, x_{2}, \cdots, x_{p}\right)^{\prime}  是可观测随机向量, 均值向量  E(X)=0 , 协方差阵  \operatorname{cov}(X)=   \Sigma , 且协方差阵  \Sigma  与相关矩阵  R  相等 (只要将变量标准化即可实现)。
(2)  F=\left(F_{1}, F_{2}, \cdots, F_{m}\right)^{\prime}(m<p)  是不可测的向量, 其均值向量  E(F)=0 , 协方差阵  \operatorname{cov}(F)=I , 即向量的各分量是相互独立的。
(3)  \varepsilon=\left(\varepsilon_{1}, \varepsilon_{2}, \cdots, \varepsilon_{p}\right)^{\prime}  与  F  相互独立, 且  E(\varepsilon)=0, \varepsilon  的协方差阵  \Sigma  是对角阵, 即 各分量  \varepsilon  之间是相互独立的，则模型如下:


$$\left\{\begin{array}{c}
x_{1}=a_{11} F_{1}+a_{12} F_{2}+\cdots+a_{1 m} F_{m}+\varepsilon_{1} \\
x_{2}=a_{21} F_{1}+a_{22} F_{2}+\cdots+a_{2 m} F_{m}+\varepsilon_{2} \\
\vdots \\
x_{p}=a_{p 1} F_{1}+a_{p 2} F_{2}+\cdots+a_{p m} F_{m}+\varepsilon_{p}
\end{array}\right.$$

此为因子分析模型, 由于该模型是针对变量进行的, 各因子又是正交的, 所以也称 为  R  型正交因子模型。
其矩阵形式为:  X=A F+\varepsilon 
其中:

$$X=\left[\begin{array}{c}
x_{1} \\
x_{2} \\
\vdots \\
x_{p}
\end{array}\right], A=\left[\begin{array}{cccc}
a_{11} & a_{12} & \cdots & a_{1 m} \\
a_{21} & a_{22} & \cdots & a_{2 m} \\
\vdots & \vdots & \vdots & \vdots \\
a_{p 1} & a_{p 2} & \cdots & a_{p m}
\end{array}\right], \quad F=\left[\begin{array}{c}
F_{1} \\
F_{2} \\
\vdots \\
F_{m}
\end{array}\right], \quad \varepsilon=\left[\begin{array}{c}
\varepsilon_{1} \\
\varepsilon_{2} \\
\vdots \\
\varepsilon_{p}
\end{array}\right]$$

- 这里,
	- (1)  $m \leqslant p_{0}$
	- (2)  $\operatorname{cov}(F, \varepsilon)=0$  ， 即  F  和  $\varepsilon$  是不相关的。
	- (3)  $\operatorname{var}(F)=I_{m}$ , 即  $F_{1}, F_{2}, \cdots, F_{m}$  不相关, 且方差均为 1 。
 
 $$D(\varepsilon)=\operatorname{var}(\varepsilon)=\left[\begin{array}{cccc}\sigma_{1}^{2} & & & 0 \\ & \sigma_{2}^{2} & & \\ & & \ddots & \\ 0 & & & \sigma_{p}^{2}\end{array}\right]$$ , 
 
即  $\varepsilon_{1}, \varepsilon_{2}, \cdots, \varepsilon_{p}$  不相关, 且方差不同。

我们把  F  称为  X  的公共因子或潜在因子, 矩阵  A  称为因子载荷矩阵,  $\varepsilon$  称为  X  的特殊因子。  $A=\left(a_{i j}\right), a_{i j}$  为因子载荷。数学上可以证明, 因子载荷  $a_{i j}$  就是第  i  个变量与第  j  个因子的相关系数，反映了第  i  个变量在第  j  个因子上的重要性。
## 9.3 因子载荷的估计及解释
### 9.3.1 主因子估计法
要建立实际问题的因子模型, 关键是要根据样本数据估计因子的载荷矩阵, 其中最 为普遍的方法是主因子法（也称主成分法）。
设随机向量  X  的协方差阵为  $\sum, \lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0  为  \sum$  的特征根,  $u_{1}, u_{2}, \cdots, u_{p}$  为对应的标准正交化特征向量，则根据线性代数知识,  \sum  的谱分解为:

$$\sum=\sum_{i=1}^{p} \lambda_{i} u_{i} u_{i}^{\prime}=\left(\sqrt{\lambda_{1}} u_{1}, \sqrt{\lambda_{2}} u_{2}, \cdots, \sqrt{\lambda_{p}} u_{p}\right)\left[\begin{array}{c}
\sqrt{\lambda_{1}} u_{1}^{\prime} \\
\sqrt{\lambda_{2}} u_{2}^{\prime} \\
\vdots \\
\sqrt{\lambda_{p}} u_{p}^{\prime}
\end{array}\right]$$

上面的分解式是当因子个数与变量个数一样多, 特殊因子方差为 0 时, 因子模型中 协方差阵的结构。

此时因子模型为  $X=A F$ , 其中  F  的方差  $\operatorname{var}(F)=I_{p} , 于是  \operatorname{var}(X)=\operatorname{var}(A F)=   A \operatorname{var}(F) A^{\prime}=A A^{\prime} , 即  \Sigma=A A^{\prime}$  。对照  $\sum$  的分解式, 则因子载荷阵  A  的第  j  列应该是  $\sqrt{\lambda_{j}} u_{j}$ , 也就是说除常数  $\sqrt{\lambda_{j}}$  外, 第  j  列因子载荷恰好是第  j  个主成分的系数, 故该估计方法称为 主成分法。
上边给出的是  \sum  的精确表达式, 但实际中总是希望公共因子数  m  小于变量个数  p , 当最后  (p-m)  个特征根较小时, 可省略, 即

$$\Sigma \approx\left(\sqrt{\lambda_{1}} u_{1}, \sqrt{\lambda_{2}} u_{2}, \cdots, \sqrt{\lambda_{m}} u_{m}\right)\left[\begin{array}{c}
\sqrt{\lambda_{1}} u_{1}^{\prime} \\
\sqrt{\lambda_{2}} u_{2}^{\prime} \\
\vdots \\
\sqrt{\lambda_{m}} u_{m}^{\prime}
\end{array}\right]=A A^{\prime}$$

上式也表示了在因子分析模型中特殊因子是不重要的, 在计算中可将其忽略掉。 如果需要考虑特殊因子的作用, 此时协方差阵可分解为:

$$\Sigma=A A^{\prime}+D=\left(\sqrt{\lambda_{1}} u_{1}, \sqrt{\lambda_{2}} u_{2}, \cdots, \sqrt{\lambda_{m}} u_{m}\right)\left[\begin{array}{c}
\sqrt{\lambda_{1}} u_{1}^{\prime} \\
\sqrt{\lambda_{2}} u_{2}^{\prime} \\
\vdots \\
\sqrt{\lambda_{m}} u_{m}^{\prime}
\end{array}\right]+\left[\begin{array}{ccc}
\sigma_{1}^{2} & & 0 \\
& \sigma_{2}^{2} & \\
& \ddots & \\
0 & & \sigma_{m}^{2}
\end{array}\right]$$

通常  D  是末知的，需事先估计，这样主因子法的使用就比主成分法困难些。 当  \sum  末知时, 可用样本协方差阵去代替, 如果数据已经标准化, 则此时协方差阵与 相关阵  R\left(=X^{\prime} X\right)  相同，仍可作上面类似的表示。
于是可得因子载荷阵的估计  $A=\left(a_{i j}\right)$ , 即

$$A=\left(a_{1}, a_{2}, \cdots, a_{m}\right)=\left(\sqrt{\lambda_{1}} u_{1}, \sqrt{\lambda_{2}} u_{2}, \cdots, \sqrt{\lambda_{m}} u_{m}\right)
$$
从以上分析可知: (1)主成分分析的数学模型实质上是一种变换, 而因子分析模型是 描述原变量  X  的协方差阵  \Sigma  结构的一种模型; (2)主成分分析中每个主成分相应的系数  a_{i j}  是唯一确定的, 而在因子分析中每个因子的相应系数不是唯一的, 即因子载荷阵不是唯 一的。
### 9.3.2 极大似然估计法
如果假定公共因子  F  和特殊因子  $\varepsilon$  服从正态分布, 则可以得到因子载荷的极大似然 估计。设  $x_{1}, x_{2}, \cdots, x_{m}$  为来自正态总体  $N_{p}(\mu, \Sigma)$  的随机样本, 其中  $\Sigma=A A^{\prime}+D$  。 从似然函数理论知:

$$l(\mu, \Sigma)=(2 \pi)^{-n p / 2}|\Sigma|^{-n / 2} \mathrm{e}^{-1 / 21\left[\sum_{j=1}^{n}\left(x_{j}-\bar{x}\right)\left(x_{j}-\bar{x}\right)^{\prime}+n(\bar{x}-\mu)(\bar{x}-\mu)^{\prime}\right]}$$

它通过  $\sum$  依赖于  A  和  D , 但上面的似然函数并不能唯一确定  A , 为此, 需添加如下条 件:  $A^{\prime} D^{-1} A=\Lambda$ , 其中  $\Lambda$  是一个对角阵。
通过数值极大化的方法可以得到  A  和  D  的极大似然估计  $\hat{A}$ 、 $\hat{D}$ , 现在已有许多现成的 计算机程序可以得到这些估计。

### 9.3.3 因子载荷的统计意义
因子分析模型中  F_{1}, F_{2}, \cdots, F_{m}  叫主因子或公共因子, 它们是在各个原观测变量的 表达式中都出现的因子, 是相互独立的不可观测的理论变量。公共因子的含义, 必须结 合具体问题的实际意义而定。  \varepsilon_{1}, \varepsilon_{2}, \cdots, \varepsilon_{p}  叫特殊因子, 是向量  x  的分量  x_{i}(i=1 ,  2, \cdots, p)  所特有的因子, 各特殊因子之间以及特殊因子与所有公共因子之间都是相互 独立的。
#### 一、因子载荷  a_{i j}  的统计意义
在因子分析模型中, 载荷矩阵  A  中的元素  \left(a_{i j}\right)  为因子载荷。因子载荷  a_{i j}  是  x_{i}  与  F_{j}  的 协方差, 也是  x_{i}  与  F_{j}  的相关系数, 它表示  x_{i}  依赖于  F_{j}  的程度。可将  a_{i j}  看作第  i  个变量在 第  j  个公共因子上的权数,  a_{i j}  的绝对值越大  \left(\left|a_{i j}\right| \leqslant 1\right) , 表明  x_{i}  与  F_{j}  的相依程度越大, 或称公共因子  F_{j}  对于  x_{i}  的载荷量越大。其关系证明如下:

$$\begin{aligned}
\operatorname{cov}\left(x_{i}, F_{j}\right) & =\operatorname{cov}\left[\sum_{k=1}^{m} a_{i k} F_{k}+\varepsilon_{j}, F_{j}\right] \\
& =\operatorname{cov}\left[\sum_{k=1}^{m} a_{i k} F_{k}, F_{j}\right]+\operatorname{cov}\left(\varepsilon_{j}, F_{j}\right) \\
& =a_{i j}
\end{aligned}$$
 
如果对  x_{i}  作了标准化处理, 则  x_{i}  的标准差为 1 , 且  F_{j}  的标准差为 1 , 于是

$$r_{x_{i}, F_{j}}=\frac{\operatorname{cov}\left(x_{i}, F_{j}\right)}{\sqrt{D\left(x_{i}\right) D\left(F_{j}\right)}}=\operatorname{cov}\left(x_{i}, F_{j}\right)=a_{i j}$$

#### 二、共同度和方差贡献
为了得到因子分析结果的经济解释, 因子载荷矩阵  A  中有两个统计量十分重要, 即 变量共同度和公共因子的方差贡献。
由因子分析模型，当仅有一个公共因子  F  时,  x_{i}  的方差也可分解为两部分:

\operatorname{var}\left(x_{i}\right)=\operatorname{var}\left(a_{i} F\right)+\operatorname{var}\left(\varepsilon_{i}\right)

由于数据已标准化, 所以上式左端等于 1 , 右端两项分别记为共性方差和个性方差。

\begin{array}{l}
h_{i}^{2}=\operatorname{var}\left(a_{i} F\right)=a_{i}^{2} \operatorname{var}(F)=a_{i}^{2} \\
\sigma_{i}^{2}=\operatorname{var}\left(\varepsilon_{i}\right)
\end{array}

从而有  h_{i}^{2}+\sigma_{i}^{2}=1 , 共性方差越大, 说明共性因子的作用越大。选择模型后, 接下 来关心的是共性因子  F  的实际含义, 这可以通过各变量在共性因子上载荷的符号与绝对 值的大小来描述。
因子载荷矩阵  A  中第  i  行元素之平方和记为  h_{i}^{2} , 称为变量  x_{i}  的共同度。

$$\left\{\begin{array}{c}
h_{1}^{2}=a_{11}^{2}+a_{12}^{2}+\cdots+a_{1 m}^{2} \\
h_{2}^{2}=a_{21}^{2}+a_{22}^{2}+\cdots+a_{2 m}^{2} \\
\vdots \\
h_{p}^{2}=a_{p 1}^{2}+a_{p 2}^{2}+\cdots+a_{p m}^{2}
\end{array}\right.$$

它是全部公共因子对  x_{i}  的方差所作出的贡献，反映了全部公共因子对变量  x_{i}  的影响。  h_{i}^{2}  越大表明  x  的第  i  个分量  x_{i}  对于  F  的每一分量  $F_{1}, F_{2}, \cdots, F_{m}$  的共同依赖程度越大。 将因子载荷矩阵  A  的第  j  列  $(j=1,2, \cdots, m)$  的各元素的平方和记为  $g_{j}^{2}$ , 称为公共因子  $F_{j}$  对  x  的方差贡献。

$$\left\{\begin{array}{c}
g_{1}^{2}=a_{11}^{2}+a_{21}^{2}+\cdots+a_{p 1}^{2} \\
g_{2}^{2}=a_{12}^{2}+a_{22}^{2}+\cdots+a_{p 2}^{2} \\
\vdots \\
g_{m}^{2}=a_{1 m}^{2}+a_{2 m}^{2}+\cdots+a_{p m}^{2}
\end{array}\right.$$

 $g_{j}^{2}$  就表示第  j  个公共因子  F_{j}  对于  x  的每一分量  $x_{i}(i=1,2, \cdots, p)$  所提供方差的总和, 它是衡量公共因子相对重要性的指标。  g_{j}^{2}  越大, 表明公共因子  F_{j}  对  x  的贡献越大, 或者 说对  x  的影响就越大。如果将因子载荷矩阵  A  的所有  g_{j}^{2}(j=1,2, \cdots, m)  都计算出来, 将 其按照大小排序，就可以依此提炼出最有影响力的公共因子
#### 因子分析函数 factanal() 的用法
factanal ( X, factors, scores =  c(  "none" , "regression" ," Bartlett" ) , rotation = "varimax",, \ldots) 
 \mathrm{X}  : 数值矩阵或数据框, factors : 因子个数
scores:因子得分的计算方法,包括" regression" ,"Bartlett", rotation:因子旋转方法
注：该函数是基于极大似然方法来求解的。
自编因子分析函数 factpc() 的用法
factpc  <-  function  (\mathrm{X}, \mathrm{m}=2 , scores  =c(  " none" ," regression"  ) , rotation  =  " varimax"  ) 
 \mathrm{X}  : 数值矩阵或数据框;  \mathrm{m}  : 因子个数
scores: 因子得分的计算方法; rotation:因子旋转方法
注：该函数是基于主因子方法来求解的。
#### 【例  9-1  】水泥行业上市公司经营业绩因子模型实证分析。
如何客观、准确地评价企业经营业绩是多年来一直末能很好解决的问题，由于企业 的经营业绩是多种因素共同作用的结果，其众多的财务指标为分析上市公司经营业绩提 供了丰富的信息, 但同时也增加了问题分析的复杂性。由于各指标之间存在着一定的相 关关系, 因此可以用因子分析方法将较少的综合指标分别综合存在于各单独指标的信息 中, 而综合指标之间彼此不相关, 即各综合指标代表的信息不重叠, 代表各类信息的综 合指标即为因子。本例以上市公司中的水泥行业为例，研究因子分析方法在公司经营业 绩评价分析中的应用。
##### 1.评价指标的选择
现代企业经营业绩综合评价的内容主要有盈利能力、偿债能力，此外还有发展能力。 常用的盈利能力指标有主营业务利润率、净资产收益率、销售毛利率和净值报酬率, 偿 债能力有自有流动比率、速动比率、现金比率、资产负债率等, 发展能力主要有主营业 务收人增长率、营业利润增长率、净利润增长率。
##### 2.数据整理和标准化
根据中国上市公司的资料, 截至 2003 年底, 水泥行业上市公司有 14 家, 依据上市 公司披露的财务信息，按照前述指标要求，收集 2003 年中期的各项经营指标数据 如表  9-1  。

$$表 9-1 \quad原始经营指标数据表 \quad(单位: \%)$$
![[Pasted image 20230420233054.png]]
##### 3.计算相关系数矩阵
在评价指标体系中，观测数据很多, 因此指标之间不可避免地存在多重共线性问题。 因此有必要先计算观测数据的相关矩阵 (以下计算均采用  \mathrm{R}  语言), 各财务指标的相关 矩阵如下:
```
\#在 mvstats4. xls:  \mathrm{d} 9.1  中选取  \mathrm{A} 1: \mathrm{G} 15  区域, 然后拷贝  
\mathrm{X}=  read.table ( " clipboard" , header  =\mathrm{T})  \#读取例  9-1  数据
```

$$\begin{array}{rrrrrrr} 
& {\mathrm{x} 1} & {\mathrm{x} 2} & {\mathrm{x} 3} & {\mathrm{x} 4} & {\mathrm{x} 5} & \mathrm{x} 6 \\
\mathrm{x} 1 & 1.00000 & 0.9992 & -0.09975 & 0.18851 & 0.2010 & 0.29778 \\
\mathrm{x} 2 & 0.99920 & 1.0000 & -0.10420 & 0.19673 & 0.1904 & 0.28748 \\
\mathrm{x} 3 & -0.09975 & -0.1042 & 1.00000 & -0.83716 & -0.4088 & 0.01519 \\
\mathrm{x} 4 & 0.18851 & 0.1967 & -0.83716 & 1.00000 & 0.2585 & -0.02928 \\
\mathrm{x} 5 & 0.20100 & 0.1904 & -0.40876 & 0.25851 & 1.0000 & 0.58029 \\
\mathrm{x} 6 & 0.29778 & 0.2875 & 0.01519 & -0.02928 & 0.5803 & 1.00000
\end{array}$$

从上面的相关矩阵可以看出, 主营业务利润率  x_{1}  与销售毛利率  x_{2}  呈高度正相关, 速 动比率  x_{3}  与资产负债率  x_{4}  呈较强的负相关, 主营业务收人增长率  x_{5}  和营业利润增长率  x_{6}  呈中度相关。为了消除各财务指标之间的相关性，采用因子分析方法提取因子。

##### 4. 计算特征值、因子载荷及共同度
在  \mathrm{R}  软件上进行数据计算, 选择用极大似然法提取公共因子, 得到如下结果：
```
(\mathrm{FA} 0=\operatorname{factanal}(\mathrm{X}, 3, \mathrm{rot}=\text { "none" })) \quad \text { \#极大似然法因子分析 }
```

$Call:$

$factanal  (x=X , factors  =3 , rotation  =  "none"  )$

$Uniquenesses :$

$\begin{array}{cccccc}\mathrm{x} 1 & \mathrm{x} 2 & \mathrm{x} 3 & \mathrm{x} 4 & \mathrm{x} 5 & \mathrm{x} 6 \\ 0.005 & 0.005 & 0.005 & 0.271 & 0.005 & 0.548\end{array}$ 

$Loadings :$

$\begin{array}{rrrr}\
&Factor1 & Factor2 & Factor3\\
\text { x1 } & 0.950 & -0.307 & \\ \text { x2 } & 0.948 & -0.310 & \\ \text { x3 } & -0.340 & -0.782 & 0.517 \\ \text { x4 } & 0.363 & 0.561 & -0.531 \\ \text { x5 } & 0.454 & 0.693 & 0.556 \\ \text { x6 } & 0.383 & 0.163 & 0.527\end{array}$

$\begin{array}{rrrr}\
&Factor1 &Factor2& Factor3\\
SS\quad loadings  \quad &2.402&1.623& 1.140 \\
Proportion\quad Var & 0.400& 0.271 & 0.190 \\
Cumulative\quad Var & 0.400 & 0.671 &0.861\end{array}$

$The degrees of freedom for the model is 0 and the fit was 1.1422$

```
library (mvstats)
 (Fac=factpc(X, 3))  #主成分法因子分析
```

由结果可以看出, 前三个因子所解释的方差占整个方差的  86 \%  以上, 基本上能全面 地反映六项财务指标的信息。所以我们提取前三个因子作为公共因子。但各因子的经济 含义并不是很明显, 还需进一步分析 (见下节 “因子旋转方法”)。从上面的结果可以看 出, 主因子法要比极大似然法的提取效果好些, 因为极大似然法要求数据来自多元正态 分布，这点一般是很难满足的。

$\$  Vars$

$\begin{array}{lccc} & \text { Vars } & \text { Vars. Prop } & \text { Vars. Cum } \\ \text { Factor1 } & 2.570 & 0.4283 & 42.83 \\ \text { Factor2 } & 1.713 & 0.2855 & 71.38 \\ \text { Factor3 } & 1.249 & 0.2082 & 92.19\end{array}$ 

$\$loadings$

$\begin{array}{rrr} 
&Factor & { Factor2 } &{ Factor3 } \\
x1&0.7829 & 0.5029 & -0.3624 \\
x2&0.7811 & 0.4964 & -0.3756 \\
x3&-0.5786 & 0.7685 & 0.0802 \\
x4&0.5951 & -0.6990 & -0.2415 \\
x5&0.6317 & -0.1457 & 0.6557 \\
x6&0.5084 & 0.3367 & 0.6943
\end{array}$

由结果可以看出, 前三个因子所解释的方差占整个方差的  $86 \%$  以上, 基本上能全面 地反映六项财务指标的信息。所以我们提取前三个因子作为公共因子。但各因子的经济 含义并不是很明显, 还需进一步分析 (见下节 “因子旋转方法”)。从上面的结果可以看 出, 主因子法要比极大似然法的提取效果好些, 因为极大似然法要求数据来自多元正态 分布, 这点一般是很难满足的。

## 9.4 因子旋转方法
### 1.旋转的目的
建立因子分析模型的目的不仅是找出主因子, 更重要的是知道每个主因子的意义, 以便对实际问题进行分析。如果求出主因子后, 各个主因子的典型代表变量不是很突出, 还需要进行因子旋转，通过适当的旋转得到比较满意的主因子。
因子旋转的方法有很多, 正交旋转 (orthogonal rotation) 和斜交旋转 (oblique rotation）是因子旋转的两类方法。最常用的方法是最大方差正交旋转（Varimax）法。进行 因子旋转, 就是要使因子载荷矩阵中因子载荷的绝对值向 0 和 1 两个方向分化, 使大的 载荷更大, 小的载荷更小。因子旋转过程中, 如果因子对应轴相互正交, 则称为正交旋 转; 如果因子对应轴相互间不是正交的, 则称为斜交旋转。常用的斜交旋转方法有 Pro \max  法等。
若已经求得因子分析模型为  $X=A F+\varepsilon$ , 设  $\Gamma=\left(\gamma_{i j}\right)$  为一正交矩阵, 作正交变换  B=A \Gamma , 可以证明,  $h_{i}^{2}(B)=h_{i}^{2}(A), g_{j}^{2}(B)=\sum_{k=1}^{p} \gamma_{k i} g_{k}^{2}(A)$ , 其中  $B=\left(b_{i j}\right)$  。 这表明经过正交旋转后, 共同度  $h_{i}^{2}$  并不改变, 但公共因子的方差贡献  $g_{j}^{2}$  不再与原 来相同。这样我们就可以对因子进行合理的解释了。
对已知的因子载荷矩阵进行正交变换的目的是使各因子上的载荷两极分化, 也就是 要使各个因子上的载荷之间方差极大化。由于各个变量  x_{i}  在某因子上的载荷  b_{i j}  的平方是 该因子对该变量的共性方差  h_{i}^{2}  的贡献, 而各变量的共性方差  h_{i}^{2}  一般又互不相同, 若某 个变量  x_{i}  的共性方差  h_{i}^{2}  较大, 则分配在各个因子上的载荷就大些; 反之, 则小些。因 此, 为了消除各个变量的共性方差大小的影响, 计算某因子上的载荷的方差时, 可先将 各个载荷的平方除以共性方差, 即类似于将其标准化, 然后再计算标准化后的载荷的方 差, 记为  c_{i j}=b_{i j}^{2} / h_{i}^{2}  。选择除以  h_{i}  是为了消除各个原始变量  X_{i}  对公共因子依赖程度不同的 影响, 而且这样的选择还不影响因子的共同度。取平方的目的是消除  b_{i j}  符号不同的影响。 对于某一因子  j , 可定义其载荷之间的方差为:

$$V_{j}=\frac{1}{p} \sum_{i=1}^{p}\left(c_{i j}-\bar{c}_{j}\right)^{2}=\frac{1}{p} \sum_{i=1}^{p}\left(\frac{b_{i j}^{2}}{h_{i}^{2}}-\frac{1}{p} \sum_{i=1}^{p} b_{i j}^{2} h_{i}^{2}\right.$$

全部公共因子各自载荷之间的总方差为：

$$V=\sum_{j=1}^{m} V_{j}$$

现在就是要寻找一个正交矩阵  \Gamma , 经过对已知的载荷矩阵  A  的正交变换后, 新的因 子载荷矩阵  B=A \Gamma  中的元素能使  V  取得极大值。
### 2.如何旋转
下面以方差最大正交旋转为例进行介绍。
先考虑两个因子的平面正交旋转, 设因子载荷矩阵为:

$$A=\left[\begin{array}{cc}
a_{11} & a_{12} \\
\vdots & \vdots \\
a_{p 1} & a_{p 2}
\end{array}\right], \quad \Gamma=\left[\begin{array}{cc}
\cos \theta & -\sin \theta \\
\sin \theta & \cos \theta
\end{array}\right]$$

显然  $\Gamma$  是一个正交阵。

$$B=A \Gamma=\left[\begin{array}{cc}
a_{11} \cos \theta+a_{12} \sin \theta & -a_{11} \sin \theta+a_{12} \cos \theta \\
\vdots & \vdots \\
a_{p 1} \cos \theta+a_{p 2} \sin \theta & -a_{p 1} \sin \theta+a_{p 2} \cos \theta
\end{array}\right]=\left[\begin{array}{cc}
b_{11} & b_{12} \\
\vdots & \vdots \\
b_{p 1} & b_{p 2}
\end{array}\right]$$

先要求总方差  V  达到最大, 即要求  $V=V_{1}+V_{2}$  达到最大, 根据求极值的原理, 令  $\frac{\mathrm{d} V}{\mathrm{~d} \theta}=0$ , 经计算，其旋转角度  $\theta$  可按下面公式求得：

$$\begin{array}{l} 
\tan 4 \theta=\frac{D-2 A B / p}{C-\left(A^{2}-B^{2}\right) / p} \\
\text { 其中, } A=\sum_{i=1}^{p} u_{i}, B=\sum_{i=1}^{p} v_{i}, C=\sum_{i=1}^{p}\left(u_{i}^{2}-v_{i}^{2}\right), D=2 \sum_{i=1}^{p} u_{i} v_{i}, u_{i}=\left(\frac{a_{i 1}}{h_{i}}\right)^{2}-\left(\frac{a_{i 2}}{h_{i}}\right)^{2}, v_{i}=2 \frac{a_{i 1} a_{j 2}}{h_{i}^{2}} \text { 。 }
\end{array}$$

关于  \theta  的取值范围和公式的详细证明参见相关文献。当  m>2  时, 可逐次对每两个 因子进行上述旋转。


### 【例 9-2】
(续例 9-1) 对例 9-1 的数据应用极大似然法进行因子旋转。 从例 9-1 中的因子载荷矩阵可知, 各因子的实际意义并不明显, 所以有必要对因子 进行旋转, 以获得更有意义的解释。
表 9-2 是采用最大方差正交旋转（Varimax) 法所得的因子贡献。

$$表  9-2  \quad Varimax 法旋转因子贡献$$
$$\begin{array}{c|ccc|ccc}
\hline & & {\text { 旋转前因子方差及其贡献 }} &  & & {\text { 旋转后因子方差及其贡献 }} \\
\hline \text { 因子 } & \text { 方差 } & \text { 贡献率 } & \text { 累积贡献率 } & \text { 方差 } & \text { 贡献率 } & \text { 累积贡献率 } \\
\hline 1 & 2.400 & 0.400 & 0.400 & 1.998 & 0.333 & 0.333 \\
2 & 1.623 & 0.271 & 0.671 & 1.800 & 0.300 & 0.633 \\
3 & 1.140 & 0.190 & 0.861 & 1.367 & 0.228 & 0.861 \\
\hline
\end{array}$$

$$表 9-3 旋转前因子载荷$$
$$\begin{array}{c|rrr}
\hline { 变量名 }&& {\text { 公共因子 }} \\
\ & F_{1}& F_{2}& F_{3}\\
\hline x_{1} & 0.950 & -0.307 & \\
x_{2} & 0.948 & -0.310 & \\
x_{3} & -0.340 & -0.782 & 0.517 \\
x_{4} & 0.363 & 0.561 & -0.531 \\
x_{5} & 0.454 & 0.693 & 0.556 \\
x_{6} & 0.383 & 0.163 & 0.527 \\
\hline
\end{array}$$

$$表 9-4 \quad旋转后因子载荷$$

$$\begin{array}{c|ccc}
\hline {\text { 变量名 }} & &  {\text { 公共因子 }} \\
\ & F_{1} & F_{2} & F_{3} \\
\hline x_{1} & 0.983 & & 0.155 \\
x_{2} & 0.985 & & 0.142 \\
x_{3} & & -0.990 & -0.124 \\
x_{4} & 0.127 & 0.844 & \\
x_{5} & & 0.293 & 0.953 \\
x_{6} & 0.210 & & 0.631 \\
\hline
\end{array}$$

表 9-3 和表 9-4 分别是旋转前后的因子载荷。由该因子载荷对比表可以看出, 旋 转前各综合因子代表的具体经济意义不是很明显, 而旋转后各因子代表的经济意义则十 分明显。因子  $F_{1}$  在主营业务利润率  $x_{1}$  上的载荷值达到 0.983 , 在销售毛利率  $x_{2}$  上的载荷 转营运能力的表现, 也是资金流动偿债能力的基础。因子  $F_{2}$  在速动比率  $x_{3}$  和资产负债率  $x_{4}$  上的载荷值分别是 -0.990 和 0.844 , 即因子  $F_{2}$  代表了企业的偿债能力。类似地, 因子  $F_{3}$  在主营业务收人增长率  $x_{5}$  和营业利润增长率  $x_{6}$  上的载荷值分别是 0.953 和 0.631 , 所以因子$F_{3}$ 代表了企业的发展能力, 是反映企业持续经营发展能力的指标。

```
(Fal=factanal(X, 3,rot="varimax" )) #varimax 法旋转因子分析
```

$Call : factanal  (\mathrm{x}=\mathrm{X} , factors  =3 , rotation  =  "varimax"  )$

$Uniquenesses :$

$\begin{array}{cccccc}x 1 & x 2 & x 3 & x 4 & x 5 & x 6 \\ 0.005 & 0.005 & 0.005 & 0.271 & 0.005 & 0.548\end{array}$ 

$Loadings:$

$\begin{array}{cccc}\
&Factor 1&Factor2 &Factor3\\
x1& 0.983& &0.155\\ 
x2&0.985&&0.142 \\
 x3&&-0.990&-0.124 \\
x4&0.127&0 .844&\\
 x5&&0.293&  0.953 \\
x6 &0.210&& 0.631\end{array}$ 

 $\begin{array}{cccc} & \text { Factor1 } & \text { Factor2 } & \text { Factor3 } \\ \text { SS loadings } & 1.998 & 1.800 & 1.367 \\ \text { Proportion Var } & 0.333 & 0.300 & 0.228 \\ \text { Cumulative Var } & 0.333 & 0.633 & 0.861\end{array}$ 
 
$The degrees of freedom for the model is 0 and the fit was 1.1422$

## 9.5 因子得分计算
因子分析模型建立后, 还有一个重要的作用是应用因子分析模型去评价每个样本在 整个模型中的地位, 即进行综合评价。例如, 地区经济发展的因子分析模型建立后, 我 们希望知道每个地区经济发展的情况, 把区域经济划分归类, 以清晰地看出哪些地区发 展较快, 哪些地区发展不快不慢, 哪些地区发展较慢等。这时需要将公共因子用变量的 线性组合来表示, 也即由地区经济的各项指标值来估计它的因子得分。
设公共因子  F  由变量  x  表示的线性组合为:

$$F_{j}=a_{j 1} x_{1}+a_{22} x_{2}+\cdots+a_{j p} x_{p} \quad j=1,2, \cdots, m$$

该式称为因子得分函数, 由它来计算每个样品的公共因子得分。若取  m=2 , 则将每 个样品的  p  个变量代人上式即可算出每个样品的因子得分  $F_{1}$  和 $ F_{2}$ , 并将其在平面上作因 子得分散点图, 进而对样品进行分类或对原始数据进行更深人的研究。
但因子得分函数中方程的个数  m  小于变量的个数  p , 所以并不能精确计算出因子得 分, 只能对因子得分进行估计。估计因子得分的方法较多, 常用的有回归 (regression) 估计法和 Bartlett 估计法。
### 1.回归估计法
设因子对  p  个变量的回归模型为

$$F_{j}=b_{j 0}+b_{j 1} x_{1}+b_{j 2} x_{2}+\cdots+b_{j p} x_{p} \quad j=1,2, \cdots, m$$

因为变量和因子均已标准化, 所以  $b_{j 0}=0$ , 上式可写成矩阵形式  $F=X b$ , 根据最小 二乘估计, 有  $b=\left(X^{\prime} X\right)^{-1} X^{\prime} F$ , 又由于因子载荷矩阵  $A=X F^{\prime}$ , 于是:

$$F=X b=X\left(X^{\prime} X\right)^{-1} A^{\prime}=X R^{-1} A^{\prime}$$

这里  R  为相关阵, 且  $R=X^{\prime} X$  。
### 2.Bartlett 估计法
Bartlett 估计因子得分可由最小二乘法或极大似然法导出, 下面给出最小二乘法求解 Bartlett 因子得分。
在因子分析模型  X=A F+\varepsilon  中, 若将载荷矩阵  A  看作自变量的数据矩阵, 将  X  看作 因变量的数据向量, 将  F  看作末知的回归系数, 将  \varepsilon  看作随机误差, 那么因子分析模型 就是一个回归模型。由于  \varepsilon  的方差各不相同, 需将异方差的  \varepsilon  化为同方差, 将上述模型 进行变换:

$$\Omega^{-1 / 2} X=\Omega^{-1 / 2} A F+\Omega^{-1 / 2} \varepsilon$$

变成同方差回归模型, 这里  $\Omega=\operatorname{diag}\left(\sigma_{1}^{2},\sigma_{2}^{2}, \cdots, \sigma_{p}^{2}\right)$ , 利用最小二乘法, 可求得因子得分的估计值:

$$\begin{aligned}
F & =\left[\left(\Omega^{-1 / 2} A\right)^{\prime} \Omega^{-1 / 2} A\right]^{-1}\left(\Omega^{-1 / 2} A\right)^{\prime} \Omega^{-1 / 2} X \\
& =\left(A^{\prime} \Omega^{-1} A\right)^{-1} A^{\prime} \Omega^{-1} X
\end{aligned}$$

【例 9-3】(续例 9-1) 根据例 9-1 的因子计算因子得分。
在了解各个综合因子的具体含义后, 可采用回归估计法、Bartlett 估计法等估计方法 计算样本的因子得分。

```
Fal=  factanal  (X, 3 , scores  =  "regression"  ) 
#使用回归估计法的极大似然法因子分析
Fal$scores
```

```
Facl=factpc(X, 3 , scores  =  "regression"  ) 
#使用回归估计法的主成分法因子分析
Fac1$scores
```

![[Pasted image 20230421175045.png]]

## 9.6 因子分析的步骤
因子分析的核心问题有两个: 一是如何构造因子变量, 二是如何对因子变量进行命 名解释。因此，因子分析的基本步骤和解决思路就是围绕这两个核心问题展开的。
### 1.因子分析的步骤
因子分析常常有以下四个基本步骤：
(1) 确认待分析的原变量是否适合作因子分析
(2）构造因子变量。
(3) 利用旋转方法使因子变量更具有可解释性。
(4) 计算因子变量得分。
### 2.因子分析的计算过程
(1) 将原始数据标准化, 以消除变量间在数量级和量纲上的不同。
(2) 求标准化数据的相关矩阵。
(3) 求相关矩阵的特征值和特征向量。
(4) 计算方差贡献率与累积方差贡献率。
(5) 确定因子: 设  F_{1}, F_{2}, \cdots, F_{p}  为  p  个因子, 其中前  m  个因子包含的数据信息总 量（即其累积贡献率）不低于  80 \%  时, 可取前  m  个因子来反映原评价指标。
(6）因子旋转: 若所得的  m  个因子无法确定或其实际意义不是很明显, 这时需将因 子进行旋转以获得较为明显的实际含义。
(7）用原指标的线性组合来求各因子得分：采用回归估计法、Bartlett 估计法计算因 子得分。
(8) 综合得分：以各因子的方差贡献率为权, 由各因子的线性组合得到综合评价指 标函数 :

$$F=\frac{\lambda_{1} F_{1}+\lambda_{2} F_{2}+\cdots+\lambda_{m} F_{m}}{\lambda_{1}+\lambda_{2}+\cdots+\lambda_{m}}=\sum_{i=1}^{m} w_{i} F_{i}$$

此处  $w_{i}$  为旋转前或旋转后因子的方差贡献率。
(9) 得分排序：利用综合得分可以得到得分名次。

【例 9-4】(续例  9-1  ) 根据例 9-1 的数据计算综合因子得分, 对水泥行业进行综 合评价。
由回归估计法计算出各个样本的综合经营业绩得分, 以各因子的方差贡献率占三个 因子总方差贡献率的比重作为权重进行加权汇总, 得出各上市公司的综合得分, 即

$$F=\left(0.333 \times F_{1}+0.300 \times F_{2}+0.228 \times F_{3}\right) / 0.861$$

水泥行业各上市公司的因子得分及排名如下:
```
factanal.rank(Fa1, plot =T) #因子得分排名
```

$\$ \mathrm{Fs}$

$\begin{array}{l}
\begin{array}{lrrr} 
& \text { Factor1 } & \text { Factor2 } & { Factor3 } \\
\text { 冀东水泥 } & 1.057 & 0.4986 & -0.0193 \\
\text { 大同水泥 } & 0.251 & -1.9718 & -0.5506 \\
\text { 四川双马 } & -0.762 & 0.6194 & -0.3564 \\
\text { 牡丹江 } & -1.262 & 0.1083 & -0.8249 \\
\text { 西水股份 } & -1.412 & -0.3652 & 2.0984 \\
\text { 狮头股份 } & 0.299 & -2.2841 & 0.0654 \\
\text { 太行股份 } & 0.537 & -0.0173 & -0.1655 \\
\text { 海螺水泥 } & 1.138 & 0.8609 & 1.8555 \\
\text { 䏌峰集团 } & -1.799 & 0.6214 & -0.2024 \\
\text { 四川金顶 } & 0.440 & 0.8391 & -1.8752 \\
\text { 祁连山 } & 1.022 & -0.2776 & 0.1024 \\
\text { 华新水泥 } & -0.438 & 0.5332 & 0.2601 \\
\text { 福建水泥 } & 1.114 & 0.9199 & 0.1356 \\
\text { 天鹅股份 } & -0.185 & -0.0848 & -0.5231
\end{array}
\end{array}$

$\$ R i$

$\begin{array}{l}
& {\text { F }} & text { rank } \\
\text { 冀东水泥 } & 0.5776 & 3 \\
\text { 大同水泥 } & -0.7358 & 14 \\
\text { 四川双马 } & -0.1732 & 9 \\
\text { 牡丹江 } & -0.6689 & 13 \\
\text { 西水股份 } & -0.1185 & 8 \\
\text { 狮头股份 } & -0.6629 & 12 \\
\text { 太行股份 } & 0.1579 & 5 \\
\text { 海螺水泥 } & 1.2314 & 1 \\
\text { 尖峰集团 } & -0.5330 & 11 \\
\text { 四川金顶 } & -0.0337 & 7 \\
\text { 祁连山 } & 0.3258 & 4 \\
\text { 华新水泥 } & 0.0851 & 6 \\
\text { 福建水泥 } & -0.7876 & 2 \\
\text { 天鹅股朌 }& -0.2394 & 10
\end{array}$

![[Pasted image 20230421181648.png]]

结果分析： (1)从因子得分表可以看出, 在盈利能力因子  $F_{1}$  上得分最高的四个公司依 次是海螺水泥、福建水泥、冀东水泥和祁连山, 这四家公司的得分远高于其他公司, 这 说明就盈利能力而言, 这四家公司的盈利水平远高于其他公司, 而盈利能力相对较弱的 公司是尖峰集团、西水股份和牡丹江。(2)福建水泥、海螺水泥、四川金顶三家公司在因 子 $F_{2}$  上的得分较高, 说明在水泥行业中, 这三家公司的偿债能力是较好的, 而狮头股份 和大同水泥这两家公司在因子  $F_{2}$  上的得分较低, 则表明这两家的偿债能力相对较差, 应 着力提高。(3)在发展能力因子  $F_{3}$  上, 西水股份、海螺水泥的得分远远高于其他公司, 反 映在现实情况中, 这两只股票从 2008 年到现在是稳中有升的, 这也要得益于它们良好的 发展能力。同时也说明在水泥行业上市公司中, 就发展能力而言, 好的公司还是少数, 很多公司不注重长远稳健的发展，而只注重短期利润。这一点需要引起有关企业的注意。 四川金顶在因子  $F_{3}$  上的得分最低, 说明它的发展能力最差, 并且它的前两个因子得分也 不高, 在综合排名上也是靠后的, 因此这家公司应从企业内部着手, 进行整改, 要从整 体上提高公司的各项经营能力，达到提升公司经营业绩的目的。

在因子得分图中, 综合排名靠前的海螺水泥、冀东水泥、福建水泥位于因子得分图 的第一象限, 当然, 这几家公司的因子  $F_{1}$  和因子  $F_{2}$  得分都比较高。而排名靠后的狮头股 份、大同水泥位于第四象限的左下方, 牡丹江位于第二象限的左下方, 这和它们的因子  $F_{1}$  、因子  $F_{2}$  得分低, 且综合名次靠后是相一致的。其余因子  $F_{1}$  、因子  $F_{2}$  得分在中间的公司 反映在因子得分图上是出现在离原点不远的因子  $F_{1}$  轴上或因子  $F_{2}$  轴上。总的来说, 各企业 间的差距非常明显, 而且三种经营能力都好的企业很少, 因此, 在水泥行业的发展方面, 各上市公司应该兼顾三种经营能力的协调发展，锐意改革，提高公司的经营业绩。

### 信息重叠图函数 biplot () 的用法
```
biplot ( scores, loadings...)
scores: 因子得分, loadings: 因子载荷
```

注: biplot () 画出了数据关于因子的散点图和原坐标在因子的方向, 全面反映了因子和原始数据的关系。

```
biplot(Fa1$scores, Fa1$loadings) #前2个因子信息重叠图
```

![[Pasted image 20230421183625.png]]

以公共因子  F_{1}  和公共因子  F_{2}  为坐标轴, 绘制出各个公司的因子得分图, 见上图。上 面的分析结果可以在该因子得分图中得到直观的反映。
上面我们采用的是  \mathrm{R}  语言自带的因子分析函数 factanal, 该函数是基于极大似然估计 法求解的, 这就要求数据资料服从多元正态分布, 但实际中大多数数据都很难满足多元 正态分布要求, 所以通常采用主成分估计法或主因子估计法求解, 我们编制了基于主成 分估计法的因子分析函数 factpc，效果要优于基于极大似然法的因子分析函数 factanal 。
【例 9-5】(续例  7-2  和例 8-2) 对例  7-2  数据应用因子分析模型, 以其 8 个指标 作为原始变量, 使用  \mathrm{R}  语言, 对这 31 个省、市、自治区的人均消费水平作分析评价, 并 根据因子得分和综合得分对各省、市、自治区的人均消费水平进行因子分析。

```
#在 mvstats4.xls: d7.2  中选取 A1: I32  区域, 然后拷贝 
X=  read. table (" clipboard" , header=T) #读取例 7-2 数据 
library (mvstats)
Fac0=factpc(X, 3) #因子分析
Fac0$Vars  #方差及贡献率
 ```
 
 $\begin{array}{lccc} & \text { Vars } & \text { Vars. Prop } & \text { Vars. Cum } \\ \text { Factor1 } & 5.7012 & 0.71265 & 71.26 \\ \text { Factor2 } & 1.0287 & 0.12858 & 84.12 \\ \text { Factor3 } & 0.5043 & 0.06304 & 90.43\end{array}$

```
Fac1 = factpc (X, 3, rot=" varimax")  #运用旋转因子分析
Fac1$Vars #方差及贡献率
```

 $\begin{array}{lccc} & \text { Vars } & \text { Vars. Prop } & \text { Vars. Cun } \\ \text { Factor1 } & 4.016 & 50.20 & 50.20 \\ \text { Factor2 } & 1.680 & 21.00 & 71.20 \\ \text { Factor3 } & 1.538 & 19.22 & 90.43\end{array}$ 


$$表 9-5\quad各因子特征根及方差贡献$$
$$\begin{array}{c|ccc|ccc}
\hline{\begin{array}{c}
\\\
\text { 公共 }
\end{array}} && {\text { 旋转前 }} &&& {\text { 旋转后 }} \\
\ { 因子 }& \text { 特征根 } & \begin{array}{c}
\text { 方差贡 } \\
\text { 献率\% }
\end{array} & \begin{array}{c}
\text { 累积方差 } \\
\text { 贡献率\% }
\end{array} & \text { 特征根 } & \begin{array}{c}
\text { 方差贡 } \\
\text { 献率\% }
\end{array} & \begin{array}{c}
\text { 累积方差 } \\
\text { 贡献率\% }
\end{array} \\
\hline 1 & 5.7012 & 0.71265 & 71.26 & 4.016 & 50.20 & 50.20 \\
2 & 1.0287 & 0.12858 & 84.12 & 1.680 & 21.00 & 71.20 \\
3 & 0.5043 & 0.06304 & 90.43 & 1.538 & 19.22 & 90.43 \\
\hline
\end{array}$$

由于公共因子在原始变量上的载荷值不太好解释, 故对其进行因子旋转, 选用方差 最大化正交旋转, 得到载荷矩阵如表 9-6 所示。

![[Pasted image 20230421184854.png]]

$$表  9-6 \quad旋转前后因子的载荷矩阵$$
$$\begin{array}{c|rrr|rrr}
\hline {\text { 变量 }} & &{\text { 旋转前 }} &&& {\text { 旋转后 }} \\
 & \text { 公因子 } F_{1} & \text { 公因子 } F_{2} & \text { 公因子 } F_{3} & \text { 公因子 } F_{1} & \text { 公因子 } F_{2} & \text { 公因子 } F_{3} \\
\hline \text { 食品 } X_{1} & 0.8429 & -0.43524 & 0.12432 & 0.9463 & 0.1159 & 0.08084 \\
\text { 衣着 } X_{2} & 0.5956 & 0.68671 & 0.37005 & 0.1527 & 0.2499 & 0.93676 \\
\text { 设备 } X_{3} & 0.8926 & -0.09008 & -0.05094 & 0.7580 & 0.4145 & 0.24728 \\
\text { 医疗 } X_{4} & 0.7202 & 0.47829 & -0.44596 & 0.2249 & 0.8743 & 0.36250 \\
\text { 交通 } X_{5} & 0.8979 & -0.32885 & 0.08740 & 0.9231 & 0.2125 & 0.15722 \\
\text { 教育 } X_{6} & 0.9647 & -0.07045 & 0.06403 & 0.8252 & 0.3638 & 0.35547 \\
\text { 居住 } X_{7} & 0.8858 & -0.05691 & -0.31385 & 0.6864 & 0.6337 & 0.11656 \\
\text { 杂项 } X_{8} & 0.8939 & 0.12018 & 0.20046 & 0.6843 & 0.2980 & 0.54462 \\
\hline
\end{array}$$

由旋转后的因子载荷矩阵可以看出, 公共因子  F_{1}  在  X_{1}  (人均食品支出)、  X_{3}  (人均 家庭设备用品及服务支出）、  X_{5}  （人均交通和通信支出）、  X_{6}  （人均娱乐教育文化服务支 出）、  X_{7}  (人均居住支出)、  X_{8}  （人均杂项商品和服务支出）上的载荷值都很大, 可视为 反映日常消费的公共因子；  F_{2}  在  X_{4}  （人均医疗保健支出）上的载荷值很大, 可视为医疗 因子;  F_{3}  仅在  X_{2}  （人均衣着商品支出）上有很大的载荷, 可直接视为衣着因子。有了对 各个公共因子合理的解释，结合各个省、市、自治区在三个公共因子上的得分和综合得 分，就可以对各省、市、自治区的综合人均消费水平进行评价了。
最后, 由回归法估计出因子得分, 以各因子的方差贡献率占四个因子总方差贡献率 的比重作为权重进行加权汇总，得出各省、市、自治区的综合得分，即

$$F=\left(0.5020 \times F_{1}+0.2100 \times F_{2}+0.1922 \times F_{3}\right) / 0.9043$$

各省、市、自治区的因子得分及排名如下：

```
Fac1$scores #因子得分
```

$$\begin{array}{lrrr} 
& \text { Factorl } & \text { Factor2 } & \text { Factor3 } \\
\text { 北京 } & 1.18092 & 1.74118 & 2.0290303 \\
\text { 天津 } & 0.20460 & 2.96179 & -0.7387309 \\
\text { 河北 } & -0.92649 & 1.20877 & -0.4632058 \\
\text { 山西 } & -0.78973 & 0.43269 & -0.0522166 \\
\text { 内蒙古 } & -0.62006 & -0.18964 & 2.1005492 \\
\text { 迣宁 } & -0.51315 & 1.07679 & -0.1140626 \\
\text { 吉林 } & -1.04765 & 1.15843 & 0.4542682 \\
\text { 黑龙江 } & -1.16020 & 0.29219 & 0.2627968 \\
\text { 上海 } & 3.25451 & -0.50217 & 1.4096665 \\
\text { 江苏 } & 0.60518 & 0.14247 & -0.2101378 \\
\text { 浙江 } & 1.38897 & -0.19508 & 1.4370242 \\
\text { 安徽 } & -0.15415 & -0.44702 & -0.3504643 \\
\text { 福建 } & 1.14760 & -0.30179 & -0.7812963 \\
\text { 江西 } & -0.08324 & -1.25789 & -0.1147615 \\
\text { 山东 } & -0.26270 & 0.28871 & 0.7222037 \\
\text { 河南 } & -0.75769 & -0.09266 & 0.3236384 \\
\text { 湖北 } & -0.18783 & -0.59587 & 0.0211735 \\
\text { 湖南 } & -0.24456 & 0.06551 & 0.0408756 \\
\text { 广东 } & 2.50339 & 0.69802 & -1.7414243 \\
\text { 广西 } & 0.01884 & -0.23030 & -1.5152172 \\
\text { 海南 } & 0.43204 & -0.14803 & -2.7440469 \\
\text { 重庆 } & -0.16768 & 0.43917 & 0.2490205\\ 
\text { 四川 } & 0.05602 & -1.08548 & -0.0581755 \\
\text { 贵州 } & -0.11095 & -1.47558 & -0.1667687 \\
\text { 云南 } & -0.61547 & -0.42528 & -0.8159804 \\
\text { 西藏 } & 0.01200 & -2.46313 & -0.0009129 \\
\text { 陕西 } & -0.42416 & 0.17032 & -0.2713572 \\
\text { 甘肃 } & -0.45628 & -0.46636 & 0.0892125 \\
\text { 青海 } & -0.66054 & -0.42814 & -0.0065357 \\
\text { 宁夏 } & -0.78567 & 0.27927 & -0.1067207 \\
\text { 新疆 } & -0.83587 & -0.65089 & 1.1125557
\end{array}$$

```
Fac1.$Rank #排名
```

![[Pasted image 20230421205439.png]]

在日常消费因子  F 1  上得分最高的前五个省、市依次是上海、北京、广东、浙江、天 津, 且上海和广东明显高于其他, 这就是说就日常消费而言, 沿海地区相对要高些, 且 上海和广东的消费水平远远高于其他省、市、自治区; 而吉林和黑龙江在这方面的消费 相对较小些。天津、北京、河北、吉林和迣宁在因子  F 2  上的得分较高, 可见该地区人们 用于医疗保健方面的消费支出不小, 西藏、贵州、江西和四川排到全国最末, 这是符合 实际情况的。就衣着因子而言, 西藏、北京、山东、新疆、青海这 5 个省、市、自治区 的得分最高, 得分较低的是广东、海南、广西。这说明衣着因子受气候的影响最大, 北 部、西北部省、市、自治区的人们为了御寒, 因此在这方面的支出较多。其次影响衣着因子的就是各地人们的衣着习惯了, 例如天津和广东, 它们的经济都比较发达, 但排名 却较后，根据资料可知, 天津虽和北京一样同为直辖市，且与北京相邻，但由于衣着习 惯的原因，北京人是非常注重衣着的，而天津人就没有北京人那么注重着装，因而它的 衣着因子得分较低; 同样的道理, 同为经济发达地区的广东和上海相比, 上海人的穿着 就比广东人要讲究得多, 广东人平时的穿着很随意, 因而该省人们衣着方面的人均消费 支出相对较少也就不足为奇了。就综合得分来看, 上海、北京、广东、浙江、天津这 5 个省、市的得分最高，河南、海南、江西省得分位于全国之末，故可知北京、上海、广 东、浙江、天津这 5 个省、市的综合人均消费水平居于全国前列，云南、西藏和黑龙江 的综合人均消费水平居于全国之末。

```
plot. text(Fac1$scores) #因子得分图
```
![[Pasted image 20230421211508.png]]

我国各地区城镇的人均消费水平主要是由经济发展水平决定的, 经济发展水平较高 的省、市、自治区, 其城镇人均消费水平也相对较高, 经济较落后的地区, 其城镇人均 消费水平也相对较低。
以因子 1 和因子 2 为坐标轴, 绘制各省、市、自治区的因子得分图, 见上图。从图 中可以看出, 在前两个因子上, 广东、上海得分较高, 但这只是前两个因子  $F_{1}$  和  $F_{2}$  的片 面分析, 要全面分析还得作  $F_{1}$  和  $F_{3}$, $F_{2}$  和  $F_{3}$  的因子得分图, 此处从略。

![[Pasted image 20230421211725.png]]

从双重信息图 biplot 上我们看到, 各个变量在广东、上海、北京、天津这些地区的 反应强烈, 说明这些地区在各个指标消费都较高, 广东人明显在变量  X_{5}  (人均交通和通 信支出）上花的钱多于其他地区，而北京在变量  X_{7}  （人均居住支出）上花的钱较多。
## 9.7 实际中如何进行因子分析
统计软件如 SAS、SPSS、R 等的广泛应用使因子分析的实际计算过程相当简易, 但 是对研究人员而言, 明白一种分析方法的意义往往比知晓其计算过程更为重要。一个完 整的因子分析过程应当包含如下几个方面:
### 1.问题的定义
这包括定义一个因子分析的问题并确定实施因子分析的变量。应用统计分析方法的 关键往往并不在于方法本身, 而在于对合适的问题选择合适的方法。因子分析适用的场 合往往是一些多变量、大样本的情形, 研究者的目的则在于寻求这些具有内在相关性的 变量背后的一种基本结构。包含在因子分析中的变量应当依据过去的经验、理论或者研 究者自己的判断而被选择。但非常重要的一点是, 这些变量必须具备区间或者比率测度 等级。在样本大小方面, 粗略而言, 进行因子分析的样本容量至少应是因子分析所涉及 变量数目的 4 到 5 倍。
### 2.选择因子分析的方法
主成分分析法和因子分析法是两种主要的寻找公因子的方法。前者主要考虑变量的 全部方差, 而后者则着重考虑共同方差。因此, 主成分分析法使用直接由数据计算出的 协方差阵, 而因子分析法则先将计算出的协方差阵的对角线元素替换为一个估计的共同 度, 再进行后续分析。如果研究者关注的问题是寻求可以解释数据中的最大方差的尽可 能少的因子, 主成分分析法是一种值得推荐的方法, 同时这也是应用比较广泛的一类 方法。
### 3.确定因子数目
主成分分析法所获取的因子的数目和原来变量的个数是一样多的, 而因子分析的主 要目的则是用少数几个公因子来阐释数据的基本结构。这既要求因子的数目远比原来的 变量个数少, 同时又要求保留的因子能够尽可能多地保留原来变量的信息。因此因子数 目的选取也就比较讲究。除了经验判断外, 特征值法是较常使用的判断方法。因子对应 的特征值就是因子所能解释的方差大小, 而由于标准化变量的方差为 1 , 因此特征值法 要求保留因子特征值大于 1 的那些因子。这意味着要求所保留的因子至少能够解释一个 变量的方差。需要注意的是, 如果变量的数目少于 20 , 该方法通常会给出一个比较保守 的因子数目。此外, 基于所保留的因子能够解释的方差比例的方法也常常使用。一般而 言，所保留的公因子至少应该能够解释所有变量  80 \%  的方差。
### 4.因子旋转
因子载荷给出了观测变量和提取的因子之间的相关程度, 这意味着在某一因子上负 载大的变量对该因子的影响较大, 因子的实际意义较大地取决于这些变量。这可以帮助 我们解释因子的实际意义。但是, 基于公因子本身的意义, 实际中往往会出现所有变量 在一个因子上的负载都比较大的情形, 这就为因子的解释带来了困难。因子旋转为因子解释提供了便利。因子旋转的目的是使某些变量在某个因子上的负载较高, 而在其他因 子上的负载则显著较低，这事实上是依据因子对变量进行更好的 “聚类”。同时，一个 合理的要求是, 这种旋转应不影响共同度和全部所能解释的方差比例。因子模型本身的 协方差结构在正交阵下的 “不可识别性” 决定了因子旋转的可行性。正交旋转 ( orthogonal rotation) 和斜交旋转（oblique rotation) 是因子旋转的两类方法。正交旋转由于保持 了坐标轴的正交性（成直角), 即因子之间的不相关性, 因此使用得最多, 它也是正交 因子模型的旋转方法。正交旋转的方法很多, 其中以最大方差正交旋转法 (Varimax) 最 为常用。斜交旋转可以更好地简化因子模式矩阵, 提高因子的可解释性, 但是因为因子 间的相关性小而不受欢迎。然而如果总体中各因子间存在明显的相关关系，则应该考虑 斜交旋转。
### 5.因子解释
因子分析的重要一步应该是对所提取的公因子给出合理的解释。因子解释可以通过 考虑在因子上具有较高载荷的变量的意义进行。经过因子旋转后的因子载荷矩阵可以大 大地提高因子的可解释性。需要注意的是, 即使是经过旋转, 仍有可能存在一个因子的 所有因子载荷均较高的情形, 这种因子通常被称为一般或者基础性因子, 一个合理的解 释是它是由所研究的问题的共性所决定的, 而并不单一地取决于问题的某一个方面。此 外, 对于某些载荷较小、难以解释或者实际意义不合理的因子，如果其解释的方差较小, 则通常予以舍弃。
### 6.因子得分
如果后续分析需要, 如进行回归分析等, 通常需要进一步计算各公因子的因子得分, 即给出各因子在每一个样本上的值。事实上, 既然各观测变量可以表示为各公因子的线 性组合, 那么反之, 各公因子也可以表示为各观测变量的线性组合。
因子得分正是通过这样的方法利用各观测变量的值估计得到的。主成分分析法可以 给出各因子得分的精确值, 并且这些值之间是不相关的。因子得分值可以用来代替原来 的变量用于后续的分析。由于消除了相关性，为后续的统计分析方法的使用提供了较大 便利。
### 7.因子分析法的意义
因子分析法的意义在于简化数据结构, 通过科学的定量分析构造一个统计上优良的 指标体系, 然后对被评价对象进行综合评价。运用该方法, 不仅可以将所研究各上市公 司的综合因子的得分进行排序, 以判别公司的经营状况优劣，还可以根据计算的结果, 找出公司的相对竞争优势所在, 取长补短, 发挥企业的特长, 提高公司综合竞争力。利 用因子分析法评价企业综合经营业绩有两个大的优点：一是客观地反映各因素对经营业 绩的影响, 即各指标权重赋值的科学性; 二是消除各指标相关性对综合评价的影响。通 过以上的分析和评价可以看出, 使用因子分析法很好地解决了多指标下的经营业绩问题, 它通过分析事件的内在关系, 抓住主要矛盾, 找出主要因素, 使多变量的复杂问题变得 易于研究和分析。在上述案例中, 虽然只选择了 8 个指标, 可能存在不全面的问题, 但 不影响方法和过程的一般性研究。在指标全面的条件下，按同样的思路和方法, 就可以 得到更好的结果

## 案例分析：因子分析在上市公司经营业绩评价中的应用
随着中国资本市场的发展, 上市公司的经营业绩日益成为股东、债权人、研究人员 所关心的主要问题, 本案例运用因子分析方法, 从上市公司对股东的回报能力、资产管 理能力、偿债能力、盈利能力四个方面对上海股票市场医药、生物行业的上市公司经营 业绩进行综合评价分析，并得出评价的结果。
(1) 案例的背景分析: 对上市公司的经营业绩的评价一直是经营者、投资者和研究 者的关注重心。但是, 能够反映上市公司经营业绩的指标很多, 而各个指标之间往往又 存在一定的相关性, 容易造成信息的重复。与此同时, 公司之间的情况各异, 各个指标 彼高此低, 因此, 必须对上市公司进行综合的评价和分析, 从众多的指标中提取合适和科 学的公共因子, 以方便对业绩进行解释。因子分析方法无疑是解决这一问题的有效途径。
(2) 案例的分析对象: 本案例所探讨的就是面对众多的指标应该如何利用因子分析 方法进行综合的分析和评价, 其所依托的客体是 2003 年上海股市医药、生物行业 28 家 上市公司年报中的有关指标。所引用资料取自巨潮资讯网 (www. cninfo. com. cn)。本案 例一共选取了 11 个指标:  X_{1}  一一每股收益、  X_{2}  一每股净资产、  X_{3}  一净资产收益率、  X_{4}  一一扣除后每股收益、  X_{5}  一一存货周转率、  X_{6}  一一固定资产周转率、  X_{7}  一一总资产周转 率、  X_{8}  一一主营业务利润率、  X_{9}  一销售毛利率、  X_{10}  —流动比率、  X_{11}  一速动比率。
### 一、数据管理
### 二、  R语言操作
#### 1.调入数据
将 Case8 中的数据复制, 然后在 RStudio 编辑器中执行 Case8 = read. table ("clipboard", header  =T)  。
#### 2.计算过程及结果分析
从样本相关阵  R  可计算出  R  的特征值、相应的方差贡献率及累积方差贡献率（见表  9-7) , 表  9-8  是旋转前后的因子载荷矩阵。
![[Pasted image 20230421212216.png]]
$$表 9-7\quad旋转前、后因子的方差贡献$$
$$\begin{array}{c|ccc|ccc}
\hline {\text { 因子 }} & &{\text { 旋转前 }} &&& {\text { 旋转后 }} \\
&\text { 总方差 } & \begin{array}{c}
\text { 方差 } \\{ 贡献率\% }
\end{array} & \begin{array}{c}
\text { 累积方差 } \\
\text { 贡献率\% }&
\end{array} & \text { 总方差 } & \begin{array}{c}\text { 方差 } \\{ 贡献率\% } &\end{array} &\begin{array}{c} \text { 累积方差 } \\ \text { 贡献率\% }&
\end{array}\\
\hline 1 & 3.371 & 30.6 & 30.6 & 3.258 & 29.6 & 29.6 \\
2 & 3.225 & 29.3 & 60.0 & 2.061 & 18.7 & 48.4 \\
3 & 1.398 & 12.7 & 72.7 & 2.008 & 18.3 & 66.6 \\
4 & 1.244 & 11.3 & 84.0 & 1.911 & 17.4 & 84.0 \\
\hline
\end{array}$$

$$表  9-7 \quad旋转前、后因子的方差贡献$$
![[Pasted image 20230421213959.png]]

从表 9-7 可以看出, 前 4 个因子的方差贡献率已经占到累积方差贡献率的  $83.9 \%$  所以只需要取前 4 个因子就可以较好地概括原始指标。
由旋转后的因子载荷矩阵可以看出，因子  $F_{1}$  在每股收益 $X_{1}$  、每股净资产  $X_{2}$  、净资 产收益率  $X_{3}$  、扣除后每股收益  $X_{4}$  上的载荷量较大, 分别反映上市公司给予其股东的回 报, 在这个因子上得分越高, 则公司能够给孕股东的回报一般而言也越高。因子  F_{2}  由于 在存货周转率  X_{5}  、固定资产周转率  X_{6}  上有较大的载荷量, 所以是反映公司的资产管理能 力的综合指标。第三个因子  F_{3}  在总资产周转率  X_{7}  、主营业务利润率  X_{8}  上的载荷量较大 主要体现了公司的短期偿债能力, 是债权人非常关心的项目。第四个因子  F_{4}  在销售毛和 率  X_{9}  、流动比率  X_{10}  、速动比率  X_{11}  上的载荷较大, 是反映公司的盈利能力的公共因子 从  \mathrm{R}  给出的成分图可以更清晰地看到各个原始指标之间的关系。
从因子排名表可以看到, 在偿债能力方面, 片仔癀可谓一枝独秀。这与该公司独家 生产和拥有 400 余年历史的名贵中药片仔癀不无关系。由于其独特的地位, 所以漳州片 仔癀集团公司的现金流相当充足。另外, 片仔癀拥有的片仔癀配方属于国家秘密, 因此 在上市时没有进行资产评估, 片仔癀的无形资产包括品牌、商标、技术、专利、药品扡 文等, 都没有作评估就无偿进人股份公司, 致使其在无形资产方面没有显示出应有的数 据。这两方面的原因使得片仔癀在着重考察流动资产质量的短期偿债能力指标方面有着 极为优秀的表现。康美药业在股东回报方面领先，但是其他三个方面却都在平均水平以 下，这与其特殊的股本结构和小盘股有着重要的联系。首先, 翻看康美药业的年度报告 就可以知道无论对整个资本市场还是对医药行业的上市公司而言, 康美药业都属于小㭧 股；其次, 康美药业属于典型的 “家族企业”，公司的第一、二大股东关系密切, 两老 股权合计拥有超过  78 \%  的公司股份。这两个原因使得尽管康美药业在其他方面表现平平 但是因为其没有一般上市公司的所有权和经营权分离所产生的矛盾, 所以康美药业的待 东可以享有较高的投资回报。

![[Pasted image 20230421214047.png]]

与片仔癀相比, 排名第四的天士力则在盈利能力方面表现突出, 尽管在 2003 年上半 年受到 SARS (传染性非典型肺炎) 的冲击, 其盈利水平却仍然位居同行业上市公司的前 列。天士力制药股份有限公司是目前国内最大的滴丸剂型生产企业, 与医药流通领域的 利润水平不断降低相反，医药生产企业的利润水平得到了相当的提高。作为一家中药上市企业, 随着中国加人世界贸易组织, 知识产权得到更大的保障, 自然绿色治疗概念逐 步兴起，天士力必然会保持更加良好的发展势头。
同仁堂的综合得分排名第三, 在股东回报和盈利能力上出现负数, 低于平均水平, 究其原因, 主要是因为同仁堂的主营业务是在医药商业方面, 而随着医药行业原有体系 被打破, 在医药流通和商业方面的竞争加剧（例如越来越多平价药房的出现, 连锁药店 逐渐步人微利时代), 其盈利能力受到一定冲击也是在意料之中的。尽管如此, 同仁堂作 为一家在医药行业有着很强竞争力的上市公司, 其资产管理和综合营运水平仍然保持在 同行业的前列。
### 三、案例小结
(1) 根据上述结果, 可以认为对上市公司业绩进行综合评价时主要考察该公司对股 东的回报能力、盈利能力、偿债能力、资产管理能力等方面。而且对股东的回报能力主 要考察每股收益、每股净资产、净资产收益率、扣除后每股收益; 盈利能力主要考察销 售毛利率、流动比率、速功比率; 偿债能力主要考察总资产周转率和主营业务利润率两 项指标；资产管理能力则主要考察存货周转率、固定资产周转率两项指标。
（2）从评价上市公司业绩的四项主因子来看, 对股东的回报放在了首位, 其次是资 产管理能力、偿债能力、盈利能力。这一结论基本符合现代企业经营理论。公司的首要 任务是为股东创造价值, 增加财富, 回报股东。随着中国资本市场的成熟, 市场对上市 公司的资源配置逐渐由上市圈钱挽救国企和概念炒作转向对公司资产管理能力的关注。 在风险益高的今天, 上市公司资产的安全也被赋予了仅次于股东回报能力和资产管理能 力的地位, 而盈利能力则为公司的各方面提供了原动力。
![[Pasted image 20230421214547.png]]
(3) 该评价方法是根据上市公司 11 项指标数据的内在关系确定各项指标在总体评价 体系中的权重, 即由原始数据本身确定综合指标的权重, 并且随着上市公司样本或数据 时期不同, 最后得到的权重和结果也有所不同, 但这并不影响在同一样本或时期范畴公 司综合经营效果评价的可比性。因子分析方法有严谨的数学科学性, 可以较好地体现公 司经营业绩评价的客观性和公正性。
该案例程序如下所示:
```
Case  8=  read. table ("clipboard", header  =T) ; Case 8
 (  FA0  =  factanal (Case8,4, rotation = 'hone") ) #因子不旋转
pairs ( FA0$loadings)
 (  FA1  =  factanal  (  Case8 ,4, rot = "varimax")  ) #varimax 法旋转因子分析
pairs (FA1$loadings)
( FA1 = factanal ( Case8,4 , rot = "varimax" , scores  =  "reg"  )) 
factanal. rank(FA1 , plot  =T)  \#因子得分作图与排名
biplot (FA1$scores, FA1$loadings)
```

思考练习题
一、思考题 (手工解答, 上交作业本)
1. 比较因子分析和主成分分析模型的关系, 说明它们的相似之处和不同之处。
2. 使用因子分析时有哪些需要注意的问题?
3. 能否将因子旋转的技术用于主成分分析, 使主成分有更鲜明的实际背景?

