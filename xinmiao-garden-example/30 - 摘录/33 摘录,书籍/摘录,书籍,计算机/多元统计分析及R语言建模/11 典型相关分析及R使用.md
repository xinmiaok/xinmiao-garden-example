---
书名: 多元统计分析及R语言建模
---

```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🔖 
🎏 class: #📸  

description ::  【目的要求】要求了解典型相关分析的目的和基本统计思想, 以及典型相关分析的 实际意义; 了解计算软件程序中有关典型相关分析的基本内容; 能运用  \mathrm{R}  语言进行典型相关分析。【教学内容】典型相关分析的目的和基本思想; 典型相关分析的数学模型; 典型相 关系数以及典型变量的计算; 典型相关系数的假设检验。
来源::

📎

```

## 11.1 引言
在相关分析中, 当考察的一组变量仅有两个时, 可用简单相关系数衡量之; 当考察 的一组变量有多个时, 可用复相关系数衡量之。在多变量线性回归中, 我们所探讨的是 一组解释变量与一个反应变量之间的关系, 然而在经济管理所面临的复杂研究中, 经常 需要找出一个以上的反应变量与一组解释变量的关系。如在心理测验的研究中, 我们想 知道的是一群有关 “个性” 的解释变量及一群有关受测验者各种不同的 “能力” 量度 (反应变量) 之间的关系。在商业与经济方面的研究中, 可能对于一组价格指数与一组 生产指数感兴趣, 并且想从其中一组变量来预测另一组变量。在管理问题中, 也经常需 要研究两组变量间的关系。例如, 在体育训练中, 考察运动员身体的各项指标与训练成 绩之间的关系; 在工厂里，考察原材料主要质量指标与产品质量指标的相关性等。用于 探讨一组解释变量（亦即预测变量）与一组反应变量间的关系即典型相关分析 (canonical correlation analysis), 典型相关分析可以说是复相关分析的延伸
大量的实际问题需要我们把指标之间的联系扩展到两组随机变量之间的相互依赖关 系。典型相关分析就是为了解决此类问题而提出的一种多变量统计分析方法。它实际上 是利用主成分的思想来讨论两组随机变量的相关性问题, 把两组变量间的相关性研究化 为少数几对变量之间的相关性研究, 而且这少数几对变量之间又是不相关的, 以此来达 到简化复杂相关关系的目的。更确切地说, 就是在第一组变量中找出一个变量的线性组 合, 在第二组变量中也找出一个变量的线性组合, 使它们具有最大的相关性, 还可继续 在每一组中找出第二个线性组合, 使其在与第一个线性组合不相关的线性组合中具有最 大的相关性。如此继续下去, 可将两组变量间的相关性提取完毕。不过, 在实际中, 希 望只提取少数几对就能反映两组变量之间的相关关系。

## 11.2 典型相关分析的基本架构
![[Pasted image 20230422095502.png]]
## 11. 3 典型相关分析的基本原理
### 1.典型相关的概念
如上所述, 典型相关分析是研究两组变量之间相关关系的一种多变量统计分析方法, 它可以真正反映两组变量之间相互依赖的线性关系。设两组变量用  x_{1}, x_{2}, \cdots, x_{p}  及  y_{1} ,  y_{2}, \cdots, y_{p}  表示, 采用类似主成分分析的做法, 在每一组变量中选择若干个有代表性的 综合指标 (变量的线性组合), 通过研究两组的综合指标之间的关系来反映两组变量之 间的相关关系。其基本原理是：首先在每组变量中找出变量的线性组合, 使其具有最大 相关性, 然后在每组变量中找出第二对线性组合, 使其分别与第一对线性组合不相关, 而第二对线性组合本身具有最大的相关性, 如此继续下去, 直到两组变量之间的相关性被提取完毕。
在单变量复相关中, 有  p  个  x  变量和一个  y  变量, 分析的目的在于找出适当的回归 系数作为这  p  个  x  变量的加权值, 使  p  个  x  变量线性组合分数与这一个  y  变量分数之间的 相关最大。在典型相关分析中也有  p  个  x  变量, 但是  y  变量却有  q  个  (q>1)  。典型相关 分析的目的在于找出这  p  个  x  变量的加权值和这  q  个  y  变量的加权值, 使这  p  个  x  变量线 性组合分数与这  q  个  y  变量线性组合分数相关程度达到最大。
### 2.典型相关的求法
假设有两组变量, 一组变量为  $x=\left(x_{1}, x_{2}, \cdots, x_{p}\right)^{\prime}$ , 另一组变量为  $y=\left(y_{1}, y_{2}, \cdots\right. ,  \left.y_{q}\right)^{\prime}$ , 且  $p \leqslant q \circ x$  与  y  的协方差矩阵为:

$$\Sigma=\operatorname{cov}(x, y)=\left(\begin{array}{cc}
\operatorname{var}(x) & \operatorname{cov}(x, y) \\
\operatorname{cov}(y, x) & \operatorname{var}(y)
\end{array}\right)=\left(\begin{array}{cc}
\Sigma_{11} & \sum_{12} \\
\Sigma_{21} & \Sigma_{22}
\end{array}\right)$$

为研究变量  x  和变量  y  之间的线性相关关系, 可考虑它们之间的线性组合:

$$\left\{\begin{array}{l}
u=a_{1} x_{1}+a_{2} x_{2}+\cdots+a_{p} x_{p}=a^{\prime} x \\
v=b_{1} y_{1}+b_{2} y_{2}+\cdots+b_{q} y_{q}=b^{\prime} y
\end{array}\right.$$

 u  和  v  的方差和协方差分别为:

$$\begin{array}{l}
\operatorname{var}(u)=\operatorname{var}\left(a^{\prime} x\right)=a^{\prime} \operatorname{var}(x) a=a^{\prime} \sum_{11} a \\
\operatorname{var}(v)=\operatorname{var}\left(b^{\prime} y\right)=b^{\prime} \operatorname{var}(y) b=b^{\prime} \sum_{22} b \\
\operatorname{cov}(u, v)=\operatorname{cov}\left(a^{\prime} x, b^{\prime} y\right)=a^{\prime} \operatorname{cov}(x, y) b=a^{\prime} \sum_{12} b
\end{array}$$

于是, 两个新变量  u  和  v  之间的相关系数（即典型相关系数）为:

$$\rho=\operatorname{corr}(u, v)=\operatorname{corr}\left(a^{\prime} x, b^{\prime} y\right)=\frac{a^{\prime} \sum_{12} b}{\left(a^{\prime} \sum_{11} a \times b^{\prime} \sum_{22} b\right)^{1 / 2}}$$

由于对任意常数  c \neq 0 , 有  $\operatorname{corr}\left(c a^{\prime} x, c b^{\prime} y\right)=\operatorname{corr}\left(a^{\prime} x, b^{\prime} y\right)$ , 所以通常需对  a  和  b  附加 约束条件, 使其唯一, 最好的约束条件是:

$$\operatorname{var}(u)=\operatorname{var}\left(a^{\prime} x\right)=a^{\prime} \sum_{11} a=1, \operatorname{var}(v)=\operatorname{var}\left(b^{\prime} y\right)=b^{\prime} \sum_{22} b=1$$

于是, 我们的问题就变成在上述约束条件下求  a  和  b , 使得:

$$\rho=\operatorname{corr}(u, v)=\operatorname{corr}\left(a^{\prime} x, b^{\prime} y\right)=a^{\prime} \sum_{12} b$$

达到最大。构造拉格朗日乘数法函数：

$$G=a^{\prime} \sum_{12} b-\frac{\lambda}{2}\left(a^{\prime} \Sigma_{11} a-1\right)-\frac{\mu}{2}\left(b^{\prime} \sum_{22} b-1\right)$$

两边分别对向量  a  和  b  求导, 并令其为 0 , 得方程组:

$$\left\{\begin{array}{l}
\frac{\partial G}{\partial a}=\Sigma_{12} b-\lambda \sum_{11} a=0 \\
\frac{\partial G}{\partial b}=\sum_{21} a-\mu \Sigma_{22} b=0
\end{array}\right.$$

以  $a^{\prime}$  和  $b^{\prime}$  分别左乘上方程两式得:

$$\left\{\begin{array}{l}
a^{\prime} \sum_{12} b=a^{\prime} \sum_{11} a=\lambda \\
b^{\prime} \sum_{21} a=b^{\prime} \sum_{22} b=\mu
\end{array}\right.$$

但  $\left(b^{\prime} \sum_{21} a\right)^{\prime}=a^{\prime} \Sigma_{12} b$ , 所以  $\lambda=\mu$ , 也就是说,  $\lambda$  恰好就是  u  和  v  的相关系数。 另外, 由上述方程组的第二式得  $b=\frac{1}{\mu} \sum_{22}^{-1} \sum_{12} a=\frac{1}{\lambda} \sum_{22}^{-1} \sum_{12} a$ , 将其代人方程组的 第一式得  $\Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21} a-\lambda^{2} \Sigma_{11} a=0$ , 两边左乘以  $\Sigma_{11}^{-1}$  得  $\Sigma_{11}^{-1} \Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21} a-\lambda^{2} a=0$ , 同理可得  $$\Sigma_{22}^{-1} \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12} b-\lambda^{2} b=0 , 记  A=\Sigma_{11}^{-1} \Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21}, B=\sum_{22}^{-1} \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12}$$ , 则得：

$$\left\{\begin{array}{l}
A a=\lambda^{2} a \\
B b=\lambda^{2} b
\end{array}\right.$$

说明  $\lambda^{2}$  既是  A  的特征根又是  B  的特征根,  a 、 b  是其相应的特征向量, 于是求  \lambda  和  a 、 b  的问题就转化为求矩阵  A  和  B  的特征根和特征向量的问题。
设  A  的  p  个特征根为  $\lambda_{1}^{2}, \lambda_{2}^{2}, \cdots, \lambda_{p}^{2}$ , 则称  $\lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0$  为典型相关系数, 相应的特征向量为  $a_{1}, a_{2}, \cdots, a_{p}  和  b_{1}, b_{2}, \cdots, b_{p}$ , 从而可得  p  对线性组合:

$$\left\{\begin{array}{l}
u_{i}=a_{i 1} x_{1}+a_{i 2} x_{2}+\cdots+a_{i i p} x_{p}=a_{i}^{\prime} x \\
v_{i}=b_{i 1} y_{1}+b_{i 2} y_{2}+\cdots+b_{i q} y_{q}=b_{i}^{\prime} y
\end{array}\right.$$

 $i=1,2, \cdots, p$ , 每一对变量称为典型变量。
### 3.典型变量的性质
(1) 每一对典型变量  $u_{i}$  及  $v_{i}(i=1,2, \cdots, p)$  的标准差为 1 。
(2) 任意两个典型变量  $u_{i}(i=1,2, \cdots, p)$  彼此不相关, 任意两个典型变量  $v_{i} .(i=1 ,  2, \cdots, p)$  彼此不相关，且当 $i \neq j$  时,  $u_{i}  及  v_{j}$  也彼此不相关。
(3) 各典型变量  $u_{i}$  及  $v_{i}$  的相关系数为  $\lambda_{i}(i=1,2, \cdots, p)$ , 典型相关系数满足关系式  $1 \geqslant \lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{p}>0$  。
在理论上, 典型变量的对数和相对应的典型相关系数的个数可以等于两组变量中数 目较少的那一组变量的个数, 其中,  $u_{1}$  及 $ v_{1}$  的相关系数  $\lambda_{1}$  反映的相关成分最多, 所以 称为第一对典型变量;  $u_{2}$  及  $v_{2}$  的相关系数  $\lambda_{2}$  反映的相关成分次之, 所以称为第二对典 型变量; 以此类推。在应用上, 只保留前面几对典型变量, 确定保留对数的方法为: (1)对典型相关系数作显著性检验, 看显著性检验的结果; (2)结合应用, 看典型变量和典 型相关系数的实际解释, 通常所求得的典型变量的对数愈少愈容易解释, 最好是第一对 典型变量就能反映足够多的相关成分, 只保留一对典型变量便比较理想。透过典型变量 之间的典型相关系数来综合地描述两组变量的线性相关关系并进行检验和分析的方法, 称为典型相关分析法。
典型相关的平方表示此两组变量的典型变量间享有的共同变异的百分比, 如果将它 乘以典型变量对该组变量解释变异的比例, 即为重迭系数, 它表示一组的变量被对方的 典型变量解释的平均百分比。
在实际例子中一般并不知道  $\Sigma$ , 因此在只有样本数据的情况下, 只要把  \Sigma  用样本协 方差阵代替就行了。但是这时的特征根可能不在 0 和 1 的范围内, 因此会出现软件输出 中的特征根（比如远远大于 1) 不等于相关系数的平方的情况, 这时, 各种软件会给出 调整后的相关系数。大多数情况下, 我们在进行典型相关分析时, 需将数据标准化, 这 时样本协方差阵即为样本相关阵, 就不会出现这种情况。
## 11.4 典型相关系数的显著性检验
确定典型变量相关系数的显著性检验, 可求出 “去掉前  k  个典型相关系数的影响” 之后所剩的  (p-k)  个典型相关系数是否可达到显著性水平, 所计算的  $\chi^{2}$  值若大于

 $\chi^{2}[(p-r+1)(q-r+1)]$ , 便要拒绝典型相关为 0 的假设。以下为典型相关系数  $\lambd$a  的显 著性检验。
检验假设  $H_{0}$: $\lambda_{r}=0$ 
检验第  r  个  (r<k)  典型相关系数的显著性时，作统计量：

$$\begin{array}{l} 
Q_{r-1}=-\left[n-r-\frac{1}{2}(p+q+1)\right] \ln \Lambda_{r-1} \sim \chi^{2}[(p-r+1)(q-r+1)] \\
\text { 其中, } \Lambda_{r-1}=\left(1-\lambda_{r}^{2}\right)\left(1-\lambda_{r+1}^{2}\right) \cdots\left(1-\lambda_{p}^{2}\right)=\prod_{i=r}^{p}\left(1-\lambda_{i}^{2}\right)
\end{array}$$

## 11.5 典型相关系数及变量的计算
设所观测对象来自正态总体的样本, 每个样品测量两组指标, 分别记为  $X=\left(x_{1}\right.$ ,  $\left.x_{2}, \cdots, x_{p}\right)^{\prime}$, $Y=\left(y_{1}, y_{2}, \cdots, y_{q}\right)^{\prime}$ , 不妨设  p<q , 原始资料矩阵为:

$$X Y=[X, \quad Y]=\left[\begin{array}{cccccccc}
x_{11} & x_{12} & \cdots & x_{1 p} & y_{11} & y_{12} & \cdots & y_{1 q} \\
x_{21} & x_{22} & \cdots & x_{2 p} & y_{21} & y_{22} & \cdots & y_{2 q} \\
\vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\
x_{n 1} & x_{n 2} & \cdots & x_{n p} & y_{n 1} & y_{n 2} & \cdots & y_{n q}
\end{array}\right]$$

(1) 计算相关系数阵  R , 并将  R  剖分为:

$$R=\left[\begin{array}{ll}
R_{11} & R_{12} \\
R_{21} & R_{22}
\end{array}\right]$$

其中,  $R_{11}$ 、 $R_{22}$  分别为第一组变量和第二组变量的相关系数阵,  $R_{12} 、 R_{21}\left(R_{12}=R_{21}^{\prime}\right)$  为第一组变量与第二组变量的相关系数阵。
(2) 计算典型相关系数及典型变量。
首先求  $A=R_{11}^{-1} R_{12} R_{22}^{-1} R_{21}$  的特征根  $r_{1}^{2}>r_{2}^{2}>\cdots>r_{p}^{2}>0$ , 并求  $r_{1}, r_{2}, \cdots, r_{p}$  对应的特征向量  $a_{1}, a_{2}, \cdots, a_{p}$ ; 再求  $B=R_{22}^{-1} R_{21} R_{11}^{-1} R_{12}$  的特征根  $s_{1}^{2}>s_{2}^{2}>\cdots>s_{p}^{2}>0$ , 并求  $s_{1}, s_{2}, \cdots ,  s_{p}$  对应的特征向量  $b_{1}, b_{2}, \cdots, b_{p}$ , 此处  $r_{i}^{2}=s_{i}^{2}$  。
(3) 写出样本的典型变量为:

$$\begin{array}{cc}
u_{1}=a_{1}^{\prime} x, & v_{1}=b_{1}^{\prime} y \\
u_{2}=a_{2}^{\prime} x, & v_{2}=b_{2}^{\prime} y \\
\vdots & \vdots \\
u_{p}=a_{p}^{\prime} x, & v_{p}=b_{p}^{\prime} y
\end{array}
$$
其中,  a  和  b  分别为变量  x  和  y  的典型载荷。
(4) 对典型相关系数进行假设检验, 以确定相关系数的个数。
(5) 根据典型相关系数对资料进行典型相关分析。
### 【例  11-1  】
某健康倶乐部对 20 名中年人测量了三个生理指标: 体重  $\left(x_{1}\right)$  、腰围  $\left(x_{2}\right)$  和脉搏  $\left(x_{3}\right)$ ; 同时也测量了三个训练指标: 引体向上次数  $\left(y_{1}\right)$  、仰卧起坐次数  $\left(y_{2}\right)$  和跳跃次数  $\left(y_{3}\right)$  。数据如表  11-1 , 试作生理指标和训练指标之间的典型相关 分析。

$$表 11-1 \quad 20名中年人的生理指标和训练指标$$
$$\text {  }\begin{array}{ccccccc}
\hline & x_{1} & x_{2} & x_{3} & y_{1} & y_{2} & y_{3} \\
\hline 1 & 191 & 36 & 50 & 5 & 162 & 60 \\
2 & 189 & 37 & 52 & 2 & 110 & 60 \\
3 & 193 & 38 & 58 & 12 & 101 & 101 \\
4 & 162 & 35 & 62 & 12 & 105 & 37 \\
5 & 189 & 35 & 46 & 13 & 155 & 58 \\
6 & 182 & 36 & 56 & 4 & 101 & 42 \\
7 & 211 & 38 & 56 & 8 & 101 & 38 \\
8 & 167 & 34 & 60 & 6 & 125 & 40 \\
9 & 176 & 31 & 74 & 15 & 200 & 40 \\
10 & 154 & 33 & 56 & 17 & 251 & 250 \\
11 & 169 & 34 & 50 & 17 & 120 & 38 \\
12 & 166 & 33 & 52 & 13 & 210 & 115 \\
13 & 154 & 34 & 64 & 14 & 215 & 105 \\
14 & 247 & 46 & 50 & 1 & 50 & 50 \\
15 & 193 & 36 & 46 & 6 & 70 & 31 \\
16 & 202 & 37 & 62 & 12 & 210 & 120 \\
17 & 176 & 37 & 54 & 4 & 60 & 25 \\
18 & 157 & 32 & 52 & 11 & 230 & 80 \\
19 & 156 & 33 & 54 & 15 & 225 & 73 \\
20 & 138 & 33 & 68 & 2 & 110 & 43 \\
\hline
\end{array}$$

分析步骤：首先通过编程方式演示如何确定典型相关系数。
(1) 计算相关系数矩阵:  $R=\left[\begin{array}{ll}R_{11} & R_{12} \\ R_{21} & R_{22}\end{array}\right]$ , 下面是各分块矩阵的值。

```
在 mvstats4. xls: d 11.1  中选取A1: J24  区域,然后拷贝
X=  read. table ( "clipboard", header  =T  ) #读取例  11-1  数据  
(R=cor}(X)) 
```

$\#\begin{array}{rrrrrrr} 
& \mathrm{x} 1 & \mathrm{x} 2 & \mathrm{x} 3 & \mathrm{y} 1 & \mathrm{y} 2 & \mathrm{y} 3 \\
\mathrm{x} 1 & 1.0000 & 0.8702 & -0.36576 & -0.3897 & -0.4931 & -0.22630 \\
\mathrm{x} 2 & 0.8702 & 1.0000 & -0.35289 & -0.5522 & -0.6456 & -0.19150 \\
\mathrm{x} 3 & -0.3658 & -0.3529 & 1.00000 & 0.1506 & 0.2250 & 0.03493 \\
\mathrm{y} 1 & -0.3897 & -0.5522 & 0.15065 & 1.0000 & 0.6957 & 0.49576 \\
\mathrm{y} 2 & -0.4931 & -0.6456 & 0.22504 & 0.6957 & 1.0000 & 0.66921 \\
\mathrm{y} 3 & -0.2263 & -0.1915 & 0.03493 & 0.4958 & 0.6692 & 1.00000
\end{array}$

其中,  $R_{11}=R[1: 3,1: 3], R_{12}=R[1: 3,4: 6], R_{21}=R[4: 6,1: 3], R_{22}=R[4: 6,4: 6]$ 。
(2) 求  $R_{11}^{-1} R_{12} R_{22}^{-1} R_{21}$  的特征值和典型相关系数: 分别为  0.6330,0.0402  和 0.0053 , 开方得相应的典型相关系数:  $r_{1}=0.7965, r_{2}=0.2006, r_{3}=0.0726$  。

```
R11=R[1: 3,1: 3]
R12=R[1: 3,4: 6] 
R21=R[4: 6,1: 3] 
R22=R[4: 6,4: 6]
A=solve(R11) %*% R12%*% solve(R22)%*%R21#第一组变量对应的矩阵 
ev  =  eigen  (A) $ v a l u e s  #  特征值 
ev
```

[1]  0.632992   0.040223   0.005266

```
sqrt(e v)   #典型相关系数
```

[1]  0.79561   0.20056  0.07257

(3) 典型相关系数检验, 确定典型变量。
典型相关分析函数 cancor}() 的用法

```
cancor. test  <-  function  (x, y , plot=F) #包含对典型相关系数的检验
x : 第一组变量数值矩阵,  y  : 第二组变量数值矩阵, plot: 是否绘制典型相关图
cancor. test (xy[, 1: 3], xy[, 4: 6], plot = T ) #典型相关分析及检验作图
```

$Scor$

$[1]  0.79561 \quad 0.200560 .07257$

$\$xcoef$

$\begin{array}{rrrr} & {[, 1]} & {[, 2]} & {[, 3]} \\ \text { x1 } & -0.17789 & -0.43230 & 0.04381 \\ \text { x2 } & 0.36233 & 0.27086 & -0.11609 \\ \mathrm{x} 3 & -0.01356 & -0.05302 & -0.24107\end{array}$ 

$Sycoef$

 $\begin{array}{rrrr} & {[, 1]} & {[, 2]} & {[, 3]} \\ \text { yl } & -0.08018 & -0.08616 & 0.29746 \\ \text { y2 } & -0.24181 & 0.02833 & -0.28374 \\ \text { y3 } & 0.16436 & 0.24368 & 0.09608\end{array}$ 
 
$\$xcenter$

$\begin{array}{rrr}x 1 & x 2 & x 3 \\ -5.551 e-18 & -1.943 e-17 & 1.821 e-17\end{array}$ 

$\$ycenter$

$\begin{array}{rrr}
y 1 & y 2 & y 3 \\
-2.776 e-17 & 3.331 e-17 & 3.365 e-17
\end{array}$

$cancor test :$

$\begin{array}{cccc} & \mathrm{r} & \mathrm{Q} & \mathrm{P} \\ {[1,]} & 0.79561 & 16.25496 & 0.06174\end{array}$ 

$\left[\begin{array}{llll}{[2,]} & 0.20056 & 0.67185 & 0.95475\end{array}\right.$

$\left[\begin{array}{llll}{[3,]} & 0.07257 & 0.07128 & 0.78948\end{array}\right.$

![[Pasted image 20230422140811.png]]

经检验, 不拒绝原假设, 也即认为在  $\alpha=0.05$  水平上没有一个典型相关是显著的。 从典型相关图上也可以看出效果不是很理想, 所以就不需要作进一步的典型相关分析了

### 【例 11-2】
广东省能源消费量与经济增长之间的典型相关分析。
一个地区在一定时期内的能源消费量与经济增长存在很大的相关性。一定时期的能 源消费量的多少, 可以在很大程度上反映经济增长的快慢, 一般情况下可以对两者进行 回归分析、主成分分析或因子分析。但是如果深人地考察此问题, 可以发现, 评价能源 消费量的指标很多, 如原煤消费量、电力消费量等; 评价经济增长的指标也有很多, 如农业增长、工业增长、服务业增长, 而且国民经济各个行业对能源的依赖程度有所不同。 这时涉及一组变量对另一组变量的相关性研究, 若用上面的方法就不能解决。本例利用 了典型相关分析的方法来解决此问题, 目的是希望找出能源消费量和经济增长之间深层 次的关系，为决策者提供一点借鉴。
#### （1）指标选取与资料收集
能源消费量是指一个地区在一定时期内消费的能源的总量。能源具体可分为原煤、 油品 (包括汽油、煤油、柴油等)、电力等方面。为了能具体分析能源消费量的变动情 况，收集了以下四个指标作为第一组变量：
 $x_{1}$  ：原煤消费量（万吨标准煤）  $\quad x_{2}$  ：油品消费量（万吨标准煤）
 $x_{3}$  ：电力消费量 (折算成万吨标准煤) $ x_{4}$  ：进口能源量 (万吨标准煤)
经济增长反映了一个地区在一定时期内的经济发展情况。为了从各个方面全面评价 经济增长, 特别收集了以下六个指标:
 $\begin{array}{ll}y_{1}: \text { 农业生产总值 (亿元) } & y_{2}: \text { 工业生产总值 (亿元) } \\ y_{3}: \text { 建筑业生产总值 (亿元) } & y_{4}: \text { 第三产业生产总值 (亿元) } \\ y_{5}: \text { 全省户籍人口 (万人) } & y_{6}: \text { 人均可支配收人 (元) }\end{array}$

$$表  11-2 \quad能源消费量与经济增长指标数据$$
![[Pasted image 20230422141108.png]]

#### (2) 典型相关分析
```
#在 mvstats4.xls: d11.2  中选取 A1 : J24 区域,然后拷贝 
d11. 2 = read. table ("clipboard", header=T)  #选取例  11-2  数据 
cancor. test  (d11.2[, 1: 4], d11.2[5: 10] ,plot = T) #典型相关分析及检验作图
```

$\$cor$

$[1] 0.99900 .95490 .73730 .4267$

$\$xcoef$

$\begin{array}{rrrrr} & {[, 1]} & {[, 2]} & {[, 3]} & {[, 4]} \\ \mathrm{x} 1 & -0.01398 & 0.2627 & -0.1634 & -0.05500 \\ \mathrm{x} 2 & 0.11887 & 0.4359 & 1.5137 & -0.02025 \\ \times 3 & 0.09036 & -0.7627 & -1.6045 & -0.96536 \\ \mathrm{x} 4 & 0.03687 & 0.1724 & 0.1985 & 1.04168\end{array}$
 
$\$ycoef$

$\$xcenter$

$\begin{array}{rrrr}x 1 & x 2 & x 3 & x 4 \\ 3.418 e-16 & -4.382 e-17 & -8.035 e-17 & -9.641 e-17\end{array}$ 

$\$ycenter$

$\begin{array}{lrrrrrr} & y 1 & y 2 & y 3 & y 4 & y 6 \\ -5.551 \mathrm{e}-17 & 3.871 \mathrm{e}-17 & -9.641 \mathrm{e}-17 & 7.888 \mathrm{e}-17 & 3.494 \mathrm{e}-16 & 8.327 \mathrm{e}-17 \\ & & & & & & \\ & & & & & \\ \text { cancor test : } & \mathrm{r} & \mathrm{Q} & \mathrm{P} & & & \\ {[1,]} & 0.9990 & 120.648 & 7.438 \mathrm{e}-15 & & \\ {[2,]} & 0.9549 & 39.264 & 5.851 \mathrm{e}-04 & & \\ {[3,]} & 0.7373 & 10.345 & 2.416 e-01 & & & \\ {[4,]} & 0.4267 & 1.909 & 5.914 e-01\end{array}$

![[Pasted image 20230422141605.png]]
经检验, 在  $\alpha=0.05$  水平上, 有三个典型相关是显著的, 即需要三个典型变量, 于 是可得出前三对典型变量的线性组合是：

$$\begin{array}{l}
\left\{\begin{array}{l}
u_{1}=-0.01398 x_{1}+0.11887 x_{2}+0.09036 x_{3}+0.03687 x_{4} \\
v_{1}=-0.05901 y_{1}-0.22982 y_{2}+0.05815 y_{3}+0.32723 y_{4}+0.08586 y_{5}+0.05439 y_{6}
\end{array}\right. \\
\left\{\begin{array}{l}
u_{2}=0.2627 x_{1}+0.4359 x_{2}-0.7627 x_{3}+0.1724 x_{4} \\
v_{2}=1.7712 y_{1}-5.0797 y_{2}+1.2193 y_{3}+4.4700 y_{4}-0.3787 y_{5}-1.9202 y_{6}
\end{array}\right.
\end{array}$$

#### (3) 对结果进行经济意义的解释
1)由于  $r_{1}=0.999$ , 说明  $u_{1}$ 、$v_{1}$  之间具有高度的相关关系（尤其是绝对值较大的权系数), 而各自的线性组合中变量的系数大部分都为正号, 因此一般说来, 能源消费越 多，经济增长也就越快。
2)在第一对典型变量  $u_{1} 、 v_{1}  中,  u_{1}$  为能源消费指标的线性组合, 其中  $x_{2}$  (油品消 费量）、  $x_{3}$  (电力消费量) 和  $x_{4}$  (进口能源量) 较其他变量有较大的载荷, 说明油品、 电力是能源消费量的主要指标, 它们在能源消费中占主导地位。 $x_{4}$  (进口能源量) 较  $x_{1}$  (原煤消费量) 有较大的载荷, 说明随着经济的逐渐发展, 本地的能源逐渐不能满足经 济发展的需要, 进口能源逐渐显示其重要性。  $v_{4}$  是对经济增长有影响的各种指标的线性 组合, 其中有较大载荷的变量是  $y_{2}$  (工业生产总值)、  $y_{4}$  (第三产业生产总值) 及  $y_{5}$  (全省户籍人口)。这说明  $x_{2}$  (油品消费量)、  $x_{3}$  (电力消费量) 和  $x_{4}$  (进口能源量) 与  $y_{2}$  (工业生产总值)、  $y_{4}$  (第三产业生产总值) 及  $y_{5}$  (全省户籍人口) 有较为密切的联系。以油品和电力为代表的能源消费对经济的促进作用主要体现在工业和第三产业的增 长上。换句话说, 如果要想保持经济 (尤其是工业和第三产业) 的快速增长, 那么油品 和电力必须有充足的供应, 进口能源也不可轻视, 不然就会成为制约经济增长的瓶颈。
3)在第二对典型变量中, 能源消费指标的线性组合方面，仍以  $x_{2}$  (油品消费量） 和  $x_{3}$  (电力消费量) 较其他变量有较大的载荷, 说明油品、电力是能源消费量的主要指 标, 它们在能源消费中占主导地位。而在经济增长各项指标的线性组合中, 又以  $y_{2}$  (工) 业生产总值）、  $y_{4}$  (第三产业生产总值） 的载荷最大, 再次说明第三产业对能源也有较大 的依赖性，并再一次显示了工业对能源的高度依赖性。
4)从上面两对典型变量中, 我们可以看出, 在能源消费这一方面, 原煤所起的作用 已经不那么重要了。事实上, 从原始数据, 我们也可以看出, 随着经济的快速增长, 原 煤消费量的增长已很缓慢。而在经济增长这一方面, 农业生产总值、建筑业生产总值、 人口的载荷都不是很大, 这说明这两个指标的增长与能源的消费没有太大关系。这一点 也很容易理解, 因为在实际生活中, 我们往往会发现, 农业的发展并不会消耗太多的能 源, 并且, 这些年来广东省的农业发展并不快, 所以和能源的关系并不太大。建筑业的 增长也不会消耗太多能源。
5)将原始数据代人第一对典型变量中, 可得到典型变量  $u_{1}$ 、 $v_{1}$  的得分, 根据每一 年的得分，可画出得分平面等值图，如上图所示。
从得分等值平面图上可以很清楚地看出, 散点在一条近似的直线上分布, 两者之间 呈线性相关关系。这说明用典型相关分析的方法能较好地说明能源消费与经济增长之间 的相关关系。散点图上几乎没有离开群体的差异点, 这表明能源消费量和经济增长之间 的关系很稳定，波动也非常平稳。
## 案例分析: 农村居民收入和支出的典型相关分析
“三农” 问题在近年来一直备受关注, 每年的 “两会” 都为妥善地解决三农问题提出 相应的对策。而农民的增收问题一直是 “三农” 问题的核心议题之一。因此, 提高农民的 收人对于解决 “三农” 问题来说是重中之重。本文通过对 2005 年我国 31 个省、市、自治 区的农村居民收人及支出作典型相关分析，了解我国各省、市、自治区农村居民的收人与 支出之间的结构关系及相关状况，希望能对解决农民的增收问题提供一些思路与帮助。
### 一、指标的选取及数据搜集
选取 4 个反映农村居民收人的变量，  
- $x_{1}$  : 工资性收人（元）；  $x_{2}$  : 家庭经营收人 (元)；  x_{3}  : 财产性收人 (元)；  $x_{4}$  : 转移性收人 (元)。

选取 5 个反映农村居民支出的变量,  
- $y_{1}$  : 生活消费（元）;  $y_{2}$  : 家庭经营支出（元）;  $y_{3}$  : 购置生产性固定资产的支出（元）；  $y_{4}$  : 财产性支出 (元)；  $y_{5}$  : 转移性支出（元）。

![[Pasted image 20230422142332.png]]

工资性收人是指农村住户成员受雇于单位或个人, 靠出卖劳动力而获得的收人, 常 住人口外出务工收人和从其他单位劳动得到的收人。
家庭经营收人指农村住户以家庭为生产经营单位进行农、林、牧、渔等生产筹划和 管理而犾得的收人。
财产性收人包括利息、股息、租金、红利、土地征用补偿等。
转移性收人主要指农民从国家或集体所获得的补贴, 如农村养老基金、农村医疗社 会救济和保险补偿等。
生活消费包括衣着、食品、家庭设备、交通通信、教育、医疗保健等各项日常生活 消费支出。
家庭经营支出指农村家庭在进行农、林、牧、渔等自主经营活动时的所需成本。 购置生产性固定资产的支出指购买农村住户用于建造和购置生产性固定资产的费用。 财产性支出在农村主要体现为承包其他农户转让的土地上的支出。 转移性支出包括对父母的赡养支出、保险费用及公益性支出等。 
### 二、R语言操作
#### 1.调入数据
将 Case10 中的数据复制, 然后在 RStudio 编辑器中执行 Case10 = read. table ("clipboard", header  =T)  。
#### 2.计算过程及结果分析
![[Pasted image 20230422142520.png]]
由R语言得出四对典型相关变量的相关系数  R , 依次分别为  0.99,0.944,0.718 , 0.337。前两对典型变量的相关系数较大。经过卡方检验, 可知前三对典型变量的相关关 系是显著的，即通过检验。因此我们只需分析前三对典型相关变量。
根据 R 软件分析得出的特征根及相应的单位正交化的特征变量, 可得出前三对典型 变量的线性组合如下:

$$\begin{array}{l}
\left\{\begin{array}{l}
u_{1}=-0.1245 x_{1}-0.00076 x_{2}+0.0151 x_{3}-0.0776 x_{4} \\
v_{1}=-0.1469 y_{1}+0.0199 y_{2}+0.00533 y_{3}+0.02069 y_{4}-0.04389 y_{5}
\end{array}\right. \\
\left\{\begin{array}{l}
u_{2}=0.02876 x_{1}-0.1772 x_{2}-0.02925 x_{3}-0.02157 x_{4} \\
v_{2}=-0.03959 y_{1}-0.17833 y_{2}+0.02131 y_{3}-0.03531 y_{4}+0.03534 y_{5}
\end{array}\right. \\
\left\{\begin{array}{l}
u_{3}=0.37734 x_{1}+0.04587 x_{2}-0.14036 x_{3}-0.26841 x_{4} \\
v_{3}=0.06015 y_{1}+0.18335 y_{2}-0.15763 y_{3}-0.08336 y_{4}-0.09252 y_{5}
\end{array}\right.
\end{array}$$

#### 3.对结果进行分析
(1) 从两组变量的组间相关阵可以看出, 我国农村居民的各项收人与各支出的相关 系数大部分都是正的, 这表明在总体上农村居民的收人增加, 支出也会增加, 二者呈正 相关关系。其中, 工资性收人  $\left(x_{1}\right)$  与生活消费  $\left(y_{1}\right)$ , 转移性收人  $\left(x_{4}\right)$  与生活消费  $\left(y_{1}\right)$  及家庭经营收人  $\left(x_{2}\right)$  与家庭经营支出  $\left(y_{2}\right)$  的相关系数分别达到了  0.95 、 0.92  和 0.926
（2） 由于  $r_{1}=0.99, r_{2}=0.944, r_{3}=0.718$ . 说明  $u_{1}$ 、 $v_{1}$  和  $u_{2}$ 、 $v_{2}$  及  $u_{3}$ 、 $v_{3}$  之间分别 有较高的相关性,  $r_{1}$  和  $r_{2}$  尤为明显。
（3）在第一组典型变量  $u_{1}$ 、 $v_{1}$  中,  $u_{1}$  为农村居民各项收人的线性组合，其中  $x_{1}$  (工资性收人）和  $x_{4}$  （转移性收人）较其他变量有较大的载荷,  $x_{1}$  的载荷最大。这说明  $u_{1}$  主 要受丁资性收人及转移性收人的影响。而  $v_{1}$  为农村居民各项支出的线性组合，其中  $y_{\text {～}}$  (生活消费) 的载荷最大，说明  $v_{1}$  主要受生活消费支出的影响，  $y_{5}$  （转移性支出）对  $v_{1}$  的 影响也较大。从而也可以说明农村居民的生活消费支出中，较大的部分是由工资性收入及转移性收人来维持的。
（4）在第二组典型变量  u_{2} 、 v_{2}  中，在农村居民各项收人的线性组合  u_{2}  中，  x_{2}  （家庭 经营收人）的载荷量最大，且要比其他各个变量的载荷量大得多。这说明家庭经营收人 在农村居民的总收人中占有很重要的位置。而在农村居民各项支出的线性组合  v_{2}  中， 又 以  y_{2}  (家庭经营支出）的载荷量为最大, 同样说明家庭经营支出在农村居民支出中占有 较大的比重。在这对典型变量中, 显示了家庭经营收人与家庭经营支出之间的密切相 关性。
（5）第三组典型变量  u_{3} 、 v_{3}  之间的相关系数仅为 0.718 , 比前两组典型相关变量的 相关系数要小一些, 但仍能说明农村居民各项收人及支出的相关关系。  u_{3}  中载荷量较大 的几个变量为  x_{1}  (工资性收人) 和  x_{4}  (转移性收人)。  v_{3}  中  y_{2}  (家庭经营支出) 的载荷 量最大，但各变量对  v_{3}  的影响较为平均，并没有明确突出各项收人和支出的相关关系。
（6）将原始数据代人第一对典型变量中, 可得到典型变量  u_{1} 、 v_{1}  的得分, 根据各省、 市、自治区的得分，可画出得分平面等值图，如上图所示。
从得分等值平面图上可以看出, 代表各省、市、自治区的点形成近似直线的分布, 表明用典型相关分析的方法能较好地说明农村居民收人与支出的相关关系。
该案例程序如下所示:
```
Case  10=  read. table  (  "clipboard" , header=T) ;
Case10
Z=scale(Case10) 
ca=cancor(Z[, 1: 4], Z[, 5: 9]) ; ca 
library(mvstats)
cancor. test  (Z[, 1: 4], Z[, 5: 9] , plot =T) 
```

一、思考题（手工解答, 上交作业本)
1. 试述典型相关分析的基本思想。
2. 指出根据协方差阵和相关阵所作的典型相关分析的区别和联系。
3. 分析一组原始变量的典型变量与其主成分的异同。
4. 给出某研究的协方差矩阵

$$\operatorname{cov}\left[\begin{array}{l}
X_{1}^{(1)} \\
X_{2}^{(1)} \\
X_{1}^{(2)} \\
X_{2}^{(2)}
\end{array}\right]=\left[\begin{array}{ll}
\Sigma_{11} & \Sigma_{12} \\
\Sigma_{21} & \Sigma_{22}
\end{array}\right]=\left[\begin{array}{llll}
1.00 & 0 & 0 & 0 \\
0 & 1.00 & 0.95 & 0 \\
0 & 0.95 & 1.00 & 0 \\
0 & 0 & 0 & 1.00
\end{array}\right]$$

验证: 第一对典型变量为  $U_{1}=X_{2}^{(1)}, V_{1}=X_{1}^{(2)}$ , 且它们的典型相关系数  $r_{1}=0.95$  。
















