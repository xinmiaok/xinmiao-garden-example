---
书名: 多元统计分析及R语言建模
---

```ad-info
title: <u></u>**描述**
collapse: open
color: 233, 244, 240

**◀️ 父节点| ▶️ 子节点** 

🪁 status: #🔖 
🎏 class: #📸  

description :: 【目的要求】了解多维标度的基本思想和实际意义, 以及它的数学模型和二维空间 上的几何意义; 掌握多维标度法的基本性质；能㿟利用软件自己编程解决实际问题。【教学内容】多维标度法的基本理论与方法;多维标度法的古典解和非度量方法; 计算程序中有关多维标度法的算法基础; 多维标度法的基本步骤以及实证分析。
来源::

📎

```


在实际中, 我们常会遇到这样的问题: 有  n  个由多个指标反映的客体, 但反映这些 客体的指标个数是不清楚的, 甚至连指标本身也是模糊的, 更谈不上对它直接测量或观 测, 所能知道的仅仅是这  n  个客体之间的某种距离（不一定是通常的欧氏距离）或某种 相似性, 我们希望仅由这种距离或者相似性给出的信息出发, 在较低维的欧氏空间把这  n  个客体 (作为几何点) 的图形绘制出来, 从而尽可能及时地反映这些客体之间的真实 结构关系, 这就是多维标度法所要研究的问题。
多维标度 (multi-dimensional scaling, MDS) 分析是以空间分布的形式表现对象之间 相似性或亲疏关系的一种多元数据分析方法。其主要结果是偏好图（又称多维标度图) 等。1958 年 Torgerson 在其博士论文中首次正式提出这一方法。MDS 分析多见于市场营 销，近年来在经济管理领域的应用也日趋增多，但国内在这方面的应用报道得极少。
MDS 分析技术的理论手段主要是多元统计分析方法, 如二元正态分布变量的散点图 大致为一个椭圆中的主成分分析、因子分析和对应分析等方法。这些方法都是数学上特 别是统计学上进行降维处理的有效手段。我们知道, 因子分析和对应分析都是在主成分 分析的基础上发展而来的，所以本文重点讨论如何利用主成分分析法来实现 MDS 技术。
## 12.1 MDS的基本理论和方法
多维标度法是一种利用客体间的相似性数据去揭示它们之间的空间关系的统计分析 方法。它是通过一系列技巧, 识别构成一个关键的维数, 并在这个确定维数的空间中估 计一组样本的坐标, 其基础数据可以是配对样本间的距离阵  $D=\left(d_{i j}\right)^{2}$ , 也可以是相似系 数矩阵 (相似阵)  $C=\left(c_{i j}\right)^{2}$ , 后者可以通过标准变换  $d_{i j}=\left(c_{i i}-2 c_{i j}+c_{i j}\right)^{1 / 2}$  转换成 距离阵。
根据分析数据的类型, 可将多维标度法分为度量化模型与非度量化模型: 若模型所 需要的相似性数据是用距离尺度或比率尺度测得的, 则这类模型就是度量化模型; 若模 型只需要顺序量表水平的相似数据，就称其为非度量化模型。
为了说明多维标度法, 先看一个经典的例子

### 【例  12-1  】
表 12-1 列出了美国 10 个城市间的公路距离, 由于公路弯弯曲曲, 这 些距离并不是城市间真正的距离。我们希望在地图上重新标出这 10 个城市, 使得它们之 间的距离接近表  12-1  中的距离。
$$表  12-1 \quad美国 10 个城市间的公路距离$$
$$\begin{array}
{crrrrrrrrrrr}
\hline & Atl & Chi & Den & Hou & LA & Mia & NYC & SF & Sea & WDC \\
\hline Atl & 0 & 587 & 1212 & 701 & 1936 & 604 & 748 & 2139 & 2182 & 543 \\
Chi & 587 & 0 & 920 & 940 & 1745 & 1188 & 713 & 1858 & 1737 & 597 \\
Den & 1212 & 920 & 0 & 879 & 831 & 1726 & 1631 & 949 & 1021 & 1494 \\
Hou & 701 & 940 & 879 & 0 & 1374 & 968 & 1420 & 1645 & 1891 & 1220 \\
LA & 1936 & 1745 & 831 & 1374 & 0 & 2339 & 2451 & 347 & 959 & 2300 \\
Mia & 604 & 1188 & 1726 & 968 & 2339 & 0 & 1092 & 2594 & 2734 & 923 \\
NYC & 748 & 713 & 1631 & 1420 & 2451 & 1092 & 0 & 2571 & 2408 & 205 \\
SF & 2139 & 1858 & 949 & 1645 & 347 & 2594 & 2571 & 0 & 678 & 2442 \\
Sea & 2182 & 1737 & 1021 & 1891 & 959 & 2734 & 2408 & 678 & 0 & 2329 \\
WDC & 543 & 597 & 1494 & 1220 & 2300 & 923 & 205 & 2442 & 2329 & 0 \\
\hline
\end{array}$$

如果用  $D=\left(d_{i j}\right)$  表示表  12-1  的矩阵, 它名义上是距离阵, 但并不一定是  n  个点的 距离, 即不是我们通常所理解的距离阵。于是首先我们需要将距离阵的概念加以拓展。

定义 12.1一个  $n \times n$  矩阵  $D=\left(d_{i j}\right)$ , 若满足  $D^{\prime}=D$, $d_{i i}=0, d_{i j} \geqslant 0,(i, j=1,2, \cdots, n ;  i \neq j)$ , 则称  D  为距离阵。
对于距离阵  $D=\left(d_{i j}\right)$ , 多维标度法的目的是要寻找  p  和  $R^{p}$  中的  n  个点  $x_{1}, \cdots, x_{n}$ , 用  $\hat{d}_{i j}$  表示  $x_{i}$  与  $x_{j}$  的欧氏距离,  $\hat{D}=\left(\hat{d}_{i j}\right)$ , 使得  $\hat{D}$  与  D  在某种意义下相近。在实际运用中, 常取  k=1,2,3  。将寻找到的  n  个点  $x_{1}, x_{2}, \cdots, x_{n}$ , 写成矩阵形式:

$$X=\left(x_{1}, x_{2}, \cdots, x_{n}\right)^{\prime}$$

则称  X  为  D  的一个解 (或叫多维标度解)。在多维标度法中, 形象地称  $x_{i}$  为距离阵  D  的 一个拟合构造点,  X  为拟合构图, 由这  n  个点之间的欧氏距离构成的距离阵称为  D  的拟 画出图来, 使得它们的距离阵  $\hat{D}$  与原始的  n  个点的距离阵  D  接近, 并可对原始  n  个客体 的关系作出一个有意义的解释。特别地, 当  $\hat{D}=D$  时, 称  $x_{i}$  为  D  的构造点,  X  为构图。 需要指出的是, 多维标度法的解并不唯一。若  X  是解, 令

$$Y=X \Gamma+\alpha$$

上式中,  $\Gamma$  为正交阵,  $\alpha$  为任一常数向量, 则  $Y=\left(y_{1}, \cdots, y_{n}\right)$  也是解, 因为平移和正交变换不改变欧氏距离。

下面我们将利用主成分分析的思想给出求古典解的方法, 并讨论古典解的优良性 本章还将对非度量法进行描述。

## 12.2 MDS的古典解
### 1.欧氏型距离阵及其判定定理
定义 12.2 一个距离阵  $D=\left(d_{i j}\right)$  称为欧氏型的, 若存在某个正整数  p  及  p  维空间  $R^{p}$  中的  n  个点  $x_{1}, \cdots, x_{n}$ , 使得

$$d_{i j}^{2}=\left(x_{i}-x_{j}\right)^{\prime}\left(x_{i}-x_{j}\right), i, j=1,2, \cdots, n$$

如何判断一个距离是不是欧氏型的? 如何求得欧氏型距离阵所相应的  n  个点呢? 这 是下面首先要解决的问题。令

$$\begin{array}{l}
A=\left(a_{i j}\right), a_{i j}=-\frac{1}{2} d_{i j}^{2} \\
B=H^{\prime} A H, H=I_{n}-\frac{1}{n} 1_{n} 1_{n}{ }^{\prime}
\end{array}$$

借助于这些定义, 下面的定理给出判断  D  是否为欧氏型的充分必要条件。
定理 12.1 一个  $n \times n$  的距离阵  D  是欧氏型的充要条件是  $B \geqslant 0  c$

证明:
(必要性)
设  D  是欧氏型的, 则由定义 12.2 可知, 存在  $x_{1}, \cdots, x_{n} \in R^{P}$ , 使得

$d_{i j}^{2}=-2 a_{i j}=\left(x_{i}-x_{j}\right)^{\prime}\left(x_{i}-x_{j}\right)$

由式 (12.4) 可得

$B=H^{\prime} A H=A-\frac{1}{n} A J-\frac{1}{n} J A+\frac{1}{n^{2}} J A J$

式中,  $J=1_{n} 1_{n}^{\prime}$  。注意

$\frac{1}{n} A J=\left[\begin{array}{c}
\bar{a}_{1 .} \\
\bar{a}_{2 .} \\
\vdots \\
\bar{a}_{n .}
\end{array}\right] 1_{n}^{\prime}, \frac{1}{n} J A=1_{n}\left(\bar{a}_{.1}, \bar{a}_{.2}, \cdots, \bar{a}_{. n}\right), \frac{1}{n^{2}} J A J=\bar{a}_{. .} 1_{n} 1_{n}^{\prime}$

其中,  $\bar{a}_{i .}=\frac{1}{n} \sum_{j=1}^{n} a_{i j}, \bar{a}_{. j}=\frac{1}{n} \sum_{i=1}^{n} a_{i j}, \quad \bar{a} .=\frac{1}{n^{2}} \sum_{i=1 j}^{n} \sum_{j=1}^{n} a_{i j}$ 
将它们代人式 (12.6) 中, 得到

$$b_{i j}=a_{i j}-\bar{a}_{i .}-\bar{a}_{. j}+\bar{a}_{. .}$$

再由式 (12.5) 可求得  $a_{i j}, \bar{a}_{i,}, \bar{a}_{. j}, \bar{a}_{. .}$ , 将它们代人式 (12.8), 得

$$b_{i j}=\left(x_{i}-\bar{x}\right)^{\prime}\left(x_{i}-\bar{x}\right) \geqslant 0$$

式中,  $\bar{x}=\frac{1}{n} \sum_{i=1}^{n} x_{i}$  。
式 (12.9) 的矩阵表达为:

$$B=(H X)(H X)^{\prime} \geqslant 0$$

因为  H X  正是将  X  的数据中心化, 即

$$H X=\left(X_{1}-\bar{X}, \cdots, X_{n}-\bar{X}\right)^{\prime}$$

(充分性)
记  $p=\operatorname{rank}(B), \lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}$  为  B  的正特征根，  $x_{(1)}, \cdots, x_{(p)}$  为相应的特征向量。 若  $B \geqslant 0$ , 则由谱分解定理

$B=H^{\prime} A H=\Gamma \Lambda \Gamma^{\prime}$

其中  $\Lambda=\operatorname{diag}\left(\lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}\right), \lambda_{1} \geqslant \cdots \geqslant \lambda_{P}$  为  B  的  p  个正特征根  $\Gamma=X \Lambda^{-1 / 2}, \Gamma$  的  p  个 列为对应的  p  个标准正交化的特征向量。取  $X=\Gamma \Lambda^{1 / 2}$ , 它是一个  $n \times p$  阶矩阵。把此  X  写 成  $X=\left(x_{1}, x_{2}, \cdots, x_{n}\right)^{\prime}=\left(x_{(1)}, x_{(2)}, \cdots, x_{(p)}\right)$ , 于是有
$X^{\prime} X=\left(\Gamma \Lambda^{1 / 2}\right)^{\prime}\left(\Gamma \Lambda^{1 / 2}\right)=\Lambda, B=X X^{\prime}$

即  $b_{i j}=x_{i}{ }^{\prime} x_{j}$  。由此求得  $x_{i}$  与  $x_{j}$  两点的距离平方

$$\begin{array}{l}
\left(x_{i}-x_{j}\right)^{\prime}\left(x_{i}-x_{j}\right)=x_{i}{ }^{\prime} x_{i}-2 x_{i}{ }^{\prime} x_{j}+x_{j}{ }^{\prime} x_{j}=b_{i i}-2 b_{i j}+b_{j i} \\
=a_{i i}-2 a_{i j}+a_{i j} \quad \text { [由式(12.8)] } \\
=-2 a_{i j} \quad\left(\text { 由 } a_{i i}=a_{i j}=0\right. \text { ) } \\
=d_{i j}^{2} \\
\end{array}$$

这表明存在正整数  p  和一个  $n \times p$  阶矩阵  $X=\left(x_{1}, x_{2}, \cdots, x_{n}\right)=\Gamma \Lambda^{1 / 2}$ , 使得  X  是  D  的 构造点，从而  D  是欧氏型的。
### 2.多维标度法的古典解
当  D  是欧氏型时，定理 12. 1 已给出了寻求构造点  X  的办法; 当  D  不是欧氏型时, 不存在  D  的构造点，只能寻求  D  的拟合构造点, 记作  $\hat{X}$ , 以区分真正的构造点  X_{0}  在实 际中, 若  D  是欧氏型, 则存在  $n \times p$  阶的构造点, 但如果  p  太大, 则会失去直观意义而不 便于解释, 这时宁可不用  X , 而是去寻求低维的拟合构造点  $\hat{X}_{\circ}$  所以，在这两种情形下， 都需要寻求拟合构造点（拟合构图)。
在定理 12.1 中，由  D  获得  X  的途径（式 12. 14）给我们一个启示，可仿造这个途径来给 出（非欧氏型）距离阵的拟合构造点, 基于这种思想得到的拟合构造点称为多维标度法的 古典解。
下面我们给出古典解的求解步骤:
(1) 由距离阵  $D=\left(d_{i j}\right)$  构造  $A=\left(a_{i j}\right)=\left(-\frac{1}{2} d_{i j}^{2}\right)$  。
(2) 令  $B=\left(b_{i j}\right)$ , 使  $b_{i j}=a_{i j}-\bar{a}_{i .}-\bar{a}_{. j}-\bar{a}_{\ldots .0}$
(3) 求  B  的特征根  $\lambda_{1} \geqslant \lambda_{2} \geqslant \cdots \geqslant \lambda_{n}$ , 若无负特征根, 表明  $B \geqslant 0$, 从而  D  是欧氏型 的; 若有负特征根，  D  一定不是欧氏型的。令

$$a_{1, k}=\frac{\sum_{i=1}^{k} \lambda_{i}}{\sum_{i=1}^{n}\left|\lambda_{i}\right|}, a_{2, k}=\frac{\sum_{i=1}^{k} \lambda_{i}^{2}}{\sum_{i=1}^{n} \lambda_{i}^{2}}$$

这两个量相当于主成分分析中的累积贡献率, 当然我们希望取  k  不要太大, 而  $a_{1, k}$  和  $a_{2, k}$  比较大。当  k  取定后, 用  $\hat{x}_{(1)}, \cdots, \hat{x}_{(k)}$  表示  B  的对应于  $\lambda_{1}, \cdots, \lambda_{k}$  的正交化特征向量, 使得  $\hat{x}_{(i)}^{\prime} \hat{x}_{(i)}=\lambda_{i}, i=1, \cdots, k$ , 通常还要求  $\lambda_{k}>0$ , 若  $\lambda_{k}<0$ , 要缩小  k  的值。
(4) 令  $\hat{X}=\left(\hat{x}_{(1)}, \cdots, \hat{x}_{(k)}\right)$ , 则  $\hat{X}$  的行向量  $x_{1}, \cdots, x_{n}$  即为欲求的古典解。 为了说明上述求解的步骤, 下面看一个例子。

#### 多维持度函数 isoMDS 用法
```
isoMDS(D, k)
D距离矩阵,  k维度
```

【例  12-2  】设有距离阵如下:

$D=\left[\begin{array}{ccccccc}
0 & 1 & \sqrt{3} & 2 & \sqrt{3} & 1 & 1 \\
& 0 & 1 & \sqrt{3} & 2 & \sqrt{3} & 1 \\
& & 0 & 1 & \sqrt{3} & 2 & 1 \\
& & & 0 & 1 & \sqrt{3} & 1 \\
& & & & 0 & 1 & 1 \\
& & & & & & 1 \\
& & & & & & 0
\end{array}\right]$

由  $a_{i j}=-\frac{1}{2} d_{i j}^{2}$ , 求得  $A, \bar{a}_{i .}, \bar{a}_{. j}, \bar{a}_{. .}$ 如下:

$\begin{array}{l}
A=\left[\begin{array}{ccccccc}
0 & -1 / 2 & -3 / 2 & -2 & -3 / 2 & -1 / 2 & -1 / 2 \\
& 0 & -1 / 2 & -3 / 2 & -2 & -3 / 2 & -1 / 2 \\
& & 0 & -1 / 2 & -3 / 2 & -2 & -1 / 2 \\
& & & 0 & -1 / 2 & -3 / 2 & -1 / 2 \\
& & & & 0 & -1 / 2 & -1 / 2 \\
& & & & & 0 & -1 / 2 \\
& & & & & & 0
\end{array}\right] \\
\bar{a}_{i,}=\left[-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{3}{7}\right] \\
\bar{a}_{. j}=\left[-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{13}{14},-\frac{3}{7}\right] \\
\bar{a}_{. .}=-\frac{6}{7} \\
\end{array}$

再由式 (12.8) 得到

$2 B=\left[\begin{array}{ccccccc}
2 & 1 & -1 & -2 & -1 & 1 & 0 \\
& 2 & 1 & -1 & -2 & -1 & 0 \\
& & 2 & 1 & -1 & -2 & 0 \\
& & & 2 & 1 & -1 & 0 \\
& & & 2 & 1 & 0 \\
& & & & 2 & 0 \\
& & & & & & 0
\end{array}\right]$

由于  B  的列有如下的线性关系：

$b_{(3)}=b_{(2)}-b_{(1)}, b_{(4)}=-b_{(1)}, b_{(5)}=-b_{(2)}, b_{(6)}=b_{(1)}-b_{(2)}, b_{(7)}=0 \text {, }$

故  B  的秩最多为 2 , 再由  B  的第一个二阶主子式非退化，故  $\operatorname{rank}(B)=2$  。
并求得  $\lambda_{1}=\lambda_{2}=3, \lambda_{3}=\cdots=\lambda_{7}=0$  。 特征向量  $x_{(1)}$  和  $x_{(2)}$  可取对应于  $\lambda=3$  的子空间 中任一对正交化的向量, 比如取

$$x_{(1)}=(a, a, 0,-a,-a, 0,0)^{\prime}, a=\frac{\sqrt{3}}{2},$$


$$x_{(2)}=(b, b,-2 b,-b, b, 2 b, 0)^{\prime}, b=\frac{1}{2}$$

于是七个点的坐标分别为:

$\left(\frac{\sqrt{3}}{2}, 2\right),\left(\frac{\sqrt{3}}{2},-\frac{1}{2}\right),(0,-1),\left(-\frac{\sqrt{3}}{2},-\frac{1}{2}\right),\left(-\frac{\sqrt{3}}{2}, \frac{1}{2}\right),(0,1),(0,0)$

因为  B \geqslant 0 , 所以原矩阵  D  是欧氏型的, 故这个古典解是  D  的古典解。
【例  12-3  】考虑例  12-1  中美国 10 个城市的距离阵, 相应  B  的特征根如下:

$$\begin{array}{l}
\lambda_{1}=958214, \lambda_{2}=168682, \lambda_{3}=8157, \lambda_{4}=1433, \lambda_{5}=509, \lambda_{6}=25, \lambda_{7}=0, \\
\lambda_{8}=-898, \lambda_{9}=-5468, \lambda_{10}=-35479
\end{array}$$

最后三个特征根是负的, 表明  D  不是欧氏型的。当  k=2  时,

$a_{1,2}=99.5 \%, \quad a_{2,2}=100.0 \%$

故取  k=2  就可以了, 前两个主成分相应的特征向量 [满足式 (12.12)] 为:

$$\begin{array}{l}
x_{(1)}=(-719,-382,482,-161,1204,-1134,-1072,1421,1342,-980)^{\prime} \\
x_{(2)}=(143,-341,-25,573,390,582,-519,113,-580,-335)^{\prime}
\end{array}$$

于是可将  $x_{(1)}, x_{(2)}$  相应的 10 个坐标点画在图上, 就可以看到由古典解确定的 10 个 城市的位置。

```
#在 mvstats4. xls: d 12.1  中选取  A1: K11  区域,然后拷贝
D=  read. table (" clipboard", header = T)
library (MASS)
D=  as. matrix(D) 
fit  =  isomDS(D, k=2) 
fit
```

$Spoints$

$\begin{array}{lrr} 
& { [, 1] } & { [, 2] } \\
Atl & -718.8 & 142.99 \\
Chi & -382.1 & -340.84 \\
Den & 481.6 & -25.29 \\
Hou & -161.1 & 572.77 \\
LA & 1203.8 & 389.78 \\
Mia & -1133.9 & 581.91 \\
NYC & -1072.2 & -519.02 \\
SF & 1420.6 & 112.59 \\
Sea & 1341.7 & -579.42 \\
WDC & -979.6 & -335.47 \\
\end{array}$

$\$stress$
 
$[1] \quad 0.04128$

```
x=fitpoints[, 1] 
y= fitspoints[, 2]
plot(x, y, type= " n") 
text (x, y,labels = row.names(D))
```

![[Pasted image 20230422172513.png]]

### 3.古典解的优良性
设  X  是一个  $n \times p$  矩阵, 令  $A=X^{\prime} H X, I_{n}=\frac{1}{n} 1_{n} 1_{n}{ }^{\prime}, A$  的特征根记作  $\lambda_{1} \geqslant \cdots \geqslant \lambda_{p}$ , 为 简单起见, 设  $\lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}>0$ , 可见,  $\lambda_{1}, \lambda_{2}, \cdots, \lambda_{p}$  也为  $B=H X X^{\prime} H$  的非零特征 根。由于  H X  的行是  X  行的中心化, 因此  $B=\left(b_{i j}\right)$  中的元素可表示为:

$b_{i j}=\left(x_{i}-x_{j}\right)^{\prime}\left(x_{i}-x_{j}\right)$

记  $v_{(i)}$  为  B  对应于  $\lambda_{i}$  的特征向量, 且  $v_{(i)}{ }^{\prime} v_{(i)}=\lambda_{i}, i=1,2, \cdots, p$ , 此时令

$V_{(k)}=\left(v_{(1)}, v_{(2)}, \cdots, v_{(k)}\right)=\left(v_{1}, v_{2}, \cdots, v_{n}\right)^{\prime}$

则称  $\left(v_{1}, v_{2}, \cdots, v_{n}\right)$  为  X  的  k  维主坐标。
显然, 主坐标的概念是从构造点的古典解引出来的。若将  X  的行看作  p  维实数空间 的  n  个点, 它们之间的欧氏距离阵记作  D  。由定理 12.1 可知,  D  在  k  维实数空间中拟合 构造点的古典解就是  X  的  k  维主坐标。

定理  12.2 X  的  k  维主坐标是将  X  中心化后  n  个样本的前  k  个主成分的值。
在一切形如  $\hat{X}=X \Gamma_{t}$  的  k  维构造点中,  $\Gamma_{t}=\Gamma_{k}$  为最优, 即拟合度最高。而  $\hat{X}=X \Gamma_{k}$  正 是  X  的  k  维主坐标，表明古典解的优良性。

### 12.3 非度量方法
古典解是基于主成分分析的思想，这时

$$d_{i j}=\hat{d}_{i j}+\varepsilon_{i j}$$

式中,  $\hat{d}_{i j}$  是拟合  $d_{i j}$  的值,  $\varepsilon_{i j}$  是误差。但有时,  $d_{i j}$  和  $\hat{d}_{i j}$  之间的拟合关系可以表示为:

$$d_{i j}=f\left(\hat{d}_{i j}+\varepsilon_{i j}\right)$$

式中,  f  为一个末知的单调增加的函数。这时, 我们用来构造  $\hat{d}_{i j}  的唯一的信息是利用  \left\{d_{i j}\right\}$  的秩, 将  $\left\{d_{i j}, i<j\right\}$  由小到大排列为:

$$d_{i_{1} j_{1}} \leqslant d_{i_{2} j_{2}} \leqslant \cdots \leqslant d_{i_{m} j_{m}}, m=\frac{1}{2} n(n-1)$$

 $(i, j)$  所对应的 $d_{i j}$  在上面的排列中的名次（由小到大）称为  $(i, j)$  或  $d_{i j}$  的秩。我们欲寻找一个拟合构造点, 使后者相互之间的距离也是如上的次序, 即

$\hat{d}_{i_{1} j_{1}} \leqslant \hat{d}_{i_{2} j_{2}} \leqslant \cdots \leqslant \hat{d}_{i_{m} j_{m}}$

并记为:  $\hat{d}_{i j} \stackrel{\text { monotone }}{\longrightarrow} d_{i j}$ 
这种模型多数出现在相似系数矩阵的场合, 因为相似系数强调的是物品之间的相似, 而非距离。
求这个模型的解有一些方法, 其中以 $Shepard-Kruskal$ 算法最为流行, 它的步骤如下:
(1) 已知相似系数矩阵  $D=\left(d_{i j}\right)$ , 并将其非对角线元素由小到大排列起来:

$d_{i_{1} j_{1}} \leqslant d_{i_{2} j_{2}} \leqslant \cdots \leqslant d_{i_{m} j_{m}}, m=\frac{1}{2} n(n-1), i_{l}<j_{l}, l=1,2, \cdots, m$

（2）设  $\hat{X}_{n \times k}  是  k  维拟合构造点, 相应的距离阵  \hat{D}=\left(\hat{d}_{i j}\right)$ , 令

$S^{2}(\hat{X})=\frac{\min \sum_{i<j}\left(d_{i j}^{*}-\hat{d}_{i j}\right)^{2}}{\sum_{i<j} d_{i j}^{2}}$

极小是对一切  $\left\{d_{i j}^{*}\right\}\left(d_{i j}^{*} \stackrel{\text { monotone }}{\longrightarrow} d_{i j}\right)$  进行的, 使上式达到极小的  $\left\{d_{i j}^{*}\right\}$  称为  $\hat{d}_{i j}  对  \left\{d_{i j}\right\}$  的 最小二乘单调回归。
如果  $\hat{d}_{i j} \stackrel{\text { monotone }}{\longrightarrow} d_{i j}$  在式 (12.15) 中取  $d_{i j}^{*}=\hat{d}_{i j}(i<j)$ , 这时,  $S^{2}(\hat{X})=0$, $\hat{X}$  是  D  的构 造点。
(3) 若  k  固定, 且能存在一个  $\hat{X}_{0}$ , 使得

$S\left(\hat{X}_{0}\right)=\min \hat{X}_{n \times k} S(\hat{X})=S_{k}$

则称  $\hat{X}_{0}$  为  k  维最佳拟合构造点。
(4) 由于  $S_{k}$  (也称压力指数）是  k  的单调下降序列, 取  k  使  $S_{k}$  适当小。例如  $S_{k}<5 \%$  最好,  $5 \% \leqslant S_{k} \leqslant 10 \%$  次之,  $S_{k}>10 \%$  较差。
求解可用梯度法进行迭代。
## 12.4 多维标度法的计算过程
多维标度法的计算实现步骤主要包括以下几步：
(1) 确定研究的目的。
(2) 选择需要进行比较分析的样品和变量。
(3) 计算样品间的距离矩阵。
(4) 选择适当的求解方法, 分析样品间的距离矩阵。
(5) 选择适当的维数, 得到距离阵的古典解, 将各个样品直观地表现出来并对结果 进行解释。
(6) 检验模型的拟合效果。
#### 【例 12 -4】
广东省各地区农村发展状况评价分析。
改革开放以来, 我国经济飞速发展, 城市化进程加快, 现代化程度越来越高, 城镇 人民的生活水平也越来越高。但是相对来说, 农村人民的生活水平变化不是很大, 现代 化程度也不高。中国的目标是建设一个有中国特色的社会主义现代化国家, 提高人民的生活水平。要实现这个目标, 首要问题是农民的问题, 中国是一个农民大国, 有着 8 亿 农民，农民在中国占有举足轻重的地位。只有实现了农村的现代化, 提高了农民的生活 水平，才能实现中国的现代化。因此，农民问题始终是中国的首要问题。
##### (1) 背景分析
农民问题始终是中国的首要问题。要实现中国的现代化, 首先要实现农村的现代化, 提高农民的生活水平, 因此, 长期以来, 对农村发展状况进行评价分析一直是科学研究 者和政府工作者关注的重点。但是, 能够反映农村发展状况的指标众多, 而各个指标之 间往往又存在一定的相关性，容易造成信息的重复。与此同时，各地区之间的情况各异， 各个指标此高彼低。因此, 必须对各地区的农村发展状况进行综合的评价和分析。从众 多的指标中提取合适和科学的公共因子, 以便于对各地区农村发展状况进行评价, 有助 于政府部门制定决策并对决策的效果进行评价分析。因此, 因子分析方法无疑是解决这 一问题的有效途径。
##### (2) 分析对象
本分析是对众多的指标进行笽选，并利用多维标度法进行分析与评价，其所依托的 客体是 2003 年广东省各地区农村经济发展状况统计中的有关指标。所引用的资料来自 《中国统计年鉴》。一共选取了 6 个指标：  $x_{1}=$  农业产值、  $x_{2}=$  林业产值、  $x_{3}=$  牧业产值、  $x_{4}=$  企业人数、  $x_{5}=$  企业总产值、  $x_{6}=$  利润总额。具体的指标数据见表  12-2  。

$$表  12-2 \quad广东省各地区农村经济发展状况指标列表$$
$$\begin{array}{ccccccc}
\hline \text { 地区 } & x_{1} & x_{2} & x_{3} & x_{4} & x_{5} & x_{6} \\
\hline \text { 广州 } & 97.84 & 1.28 & 38.86 & 141.98 & 2089.55 & 121.07 \\
\text { 深圳 } & 11.20 & 0.66 & 12.59 & 156.52 & 418.16 & 50.12 \\
\text { 珠海 } & 5.67 & 0.11 & 3.60 & 17.39 & 360.58 & 10.58 \\
\text { 汕头 } & 29.87 & 0.57 & 17.26 & 52.45 & 673.74 & 24.07 \\
\text { 佛山 } & 52.39 & 0.29 & 32.14 & 90.77 & 1649.81 & 62.74 \\
\text { 韶关 } & 47.82 & 4.47 & 18.44 & 27.91 & 144.51 & 16.14 \\
\text { 河源 } & 33.57 & 3.10 & 12.84 & 12.62 & 51.25 & 4.73 \\
\text { 梅州 } & 57.10 & 2.74 & 28.02 & 44.12 & 226.65 & 19.75 \\
\text { 惠州 } & 61.57 & 4.70 & 25.20 & 70.38 & 568.79 & 40.39 \\
\text { 汕尾 } & 29.82 & 1.70 & 12.09 & 30.52 & 189.00 & 6.78 \\
\text { 东莞 } & 20.97 & 0.14 & 20.35 & 134.63 & 1380.42 & 74.01 \\
\text { 中山 } & 16.87 & 0.21 & 5.33 & 91.43 & 1.148 .14 & 52.10 \\
\text { 汀门 } & 57.33 & 1.79 & 39.21 & 85.64 & 1252.07 & 32.68 \\
\text { 阳江 } & 47.72 & 3.27 & 21.39 & 19.52 & 191.64 & 11.08 \\
\text { 湛江 } & 87.20 & 4.72 & 34.07 & 40.60 & 390.06 & 20.96 \\
\text { 茂名 } & 112.00 & 7.85 & 81.36 & 76.47 & 739.34 & 40.85 \\
\text { 肇庆 } & 76.06 & 16.45 & 46.77 & 52.97 & 569.93 & 19.40 \\
\text { 清远 } & 57.35 & 6.67 & 28.47 & 17.95 & 75.29 & 6.76 \\
\text { 潮州 } & 27.05 & 1.63 & 14.88 & 35.22 & 501.63 & 20.97 \\
\text { 揭阳 } & 71.08 & 2.09 & 26.43 & 50.52 & 891.76 & 17.79 \\
\text { 云浮 } & 44.07 & 4.65 & 38.97 & 22.23 & 188.47 & 8.70 \\
\hline
\end{array}$$
##### (3) 计算过程及结果分析
```
#在 mvstats4.xls:d12.2  中选取 A1: G22  区域, 然后拷贝  
X=read. table( "clipboard" , header=T) 
d=dist(X) 
fit=isomDS (d, k=2) 
fit
```

$$\begin{array}{l}
\text { Spoints }\\
\begin{array}{lrr} 
& {[, 1]} & {[, 2]} \\
\text { 广州市 } & 1442.5 & 17.80 \\
\text { 深圳市 } & -227.9 & -100.30 \\
\text { 珠海市 } & -295.1 & -17.90 \\
\text { 汕头市 } & 20.2 & -10.22 \\
\text { 佛山市 } & 997.9 & 11.35 \\
\text { 韶关市 } & -509.2 & 2.37 \\
\text { 河源市 } & -603.7 & -1.42 \\
\text { 梅州市 } & -426.0 & 4.08 \\
\text { 惠州市 } & -82.3 & -2.40 \\
\text { 汕尾市 } & -465.3 & -10.64 \\
\text { 东莞市 } & 731.7 & -51.57 \\
\text { 中山市 } & 496.5 & -36.87 \\
\text { 江门市 } & 599.7 & 12.98 \\
\text { 阳江市 } & -462.8 & 10.72 \\
\text { 湛江市 } & -262.7 & 34.16 \\
\text { 茂名市 } & 89.1 & 53.58 \\
\text { 肇庆市 } & -82.8 & 29.98 \\
\text { 清远市 } & -579.0 & 18.02 \\
\text { 潮州市 } & -152.6 & -7.34 \\
\text { 揭阳市 } & 237.8 & 30.61 \\
\text { 云浮市 } & -465.9 & 12.01
\end{array}
\end{array}$$

```
x=fit$points [, 1] 
y=fitspoints [, 2] 
plot(x, y) ; abline (v=0, h=0, lty=3) 
text (x, y, labels=row.names(X))
```

![[Pasted image 20230422184219.png]]

由于我们在维数中选择了二维，所以可以用二维平面比较直观地反映各地区的位置。 在农村中的工、企业产值中，广州市表现非常出色，排名第一，紧接其后的是佛山市， 这是有其原因的。广州市和东莞市都是工业化程度比较高的城市，其周围的郊区也建有 工业区，拥有许多公司。在郊区，由于地理位置的便利，许多外商在此进行投资办厂, 而且在这些地方，郊区农民自己也都办了许多集体加工企业。所以在农村中的工业、企 业产值中，广州市、佛山市、东莞市依次排在前列。但是在农村的农、林、牧业的产值 中，又有不同。广州市由于工业的发展，同时也刺激了对农产品的需求，而且土地面积 比较宽广, 所以使用其他的土地来发展农、林、牧业, 因此在农、林、牧业的产值中, 广州市的得分也是比较高的。但是和广州市不同，东莞市、佛山市和深圳市由于大部分 已经城市化, 没有充足的土地面积来发展农、林、牧业, 排名就相对靠后, 深圳在此方 面尤为突出。所以, 在综合排名中, 广州市处于总排名的第一名, 佛山市排在第二名, 东莞市排在第三名，而深圳市则明显落后于其他城市
而茂名市、中山市、珠海市和江门市则在农、林、牧业产值上表现得很优秀。这是 因为这些地区地处比较偏僻, 环境比较优美, 林业和牧业发展也相对较好, 带来了旅游 业的发展。广东的这些地区特别适合荔枝和龙眼生长, 由此也带来了丰厚的创收。因此, 在综合排名中，这些地区的排名相对靠前。
请读者用主成分分析法分析一下该问题，看结果如何。
## 案例分析：国内各地区工资水平的多维标度分析
工资水平问题是个收人问题，收人问题不仅有收人差距的问题，还有收人水平的问 题。当前大多数中国老百姓的收人来源是劳动收人，其劳动报酬即工资增长得快不快, 工资水平高不高, 自然成为大家十分关心的问题, 特别是近年来物价飞涨, 工资水平问 题更是引起人们的关注
改革开放以来，我国经济飞快发展，但区域发展不平衡，东、西部两极分化，东部沿海地区经济比较发达, 西部地区发展比较缓慢。各地区经济发展水平的高低必然在工 资水平上表现出来。因此，判定一个地区工资水平的高低，不仅能反映出当地经济的发 展水平、人民的生活水平，还能为国家宏观经济政策的确定提供一定的参考。
### 一、数据管理
要对国内各地区的工资水平进行判别分析，首先要选取适当的指标。由于我国的经 济体制为多种所有制经济共同发展, 企业性质种类较多。本例选择九个主要的单位作为 指标，这些指标尽可能考虑到影响工资水平的各个方面，并适合所采用的分析方法。
数据涉及九个变量：
$X_{1}$  ：国有单位工资（元）;
$X_{2}$  ：城镇集体单位工资（元) ;
$X_{3}$  ：股份合作单位工资（元）;
$X_{4}$  ：联营单位工资（元）;
$X_{5}$  ：有限责任单位工资（元）;
$X_{6}$:  股份有限公司工资  (  元  ) 
$X_{7}$  : 其他工资 (元);
$X_{8}$  : 港澳台工资（元）;
$X_{9}$  ：外商投资单位工资（元）。

其中级别为 1 的代表工资水平较高, 级别为 2 的代表中等工资水平, 级别为 3 的代 表工资水平较低。本例收集 2006 年 20 个地区的工资, 如图所示（数据来源：《中国统计年鉴 2007》)。

![[Pasted image 20230422184638.png]]

### 二、R语言操作
#### 1.调入数据
将 Casel1 中的数据复制, 然后在 RStudio 编辑器中执行 Case11 = read. table( "clipboard", header  =T)  。
#### 2.计算过程及结果分析
计算过程及结果如下图所示。
![[Pasted image 20230422184904.png]]

北京、上海、浙江跟其他地区的差异非常大。
山东、江苏处在上升地位, 而其他地区之间的差异相对要小些。
由标度图可以大致了解我国各地区的工资水平情况。
该案例程序如下所示:

```
Case11 = read. table  (  "clipboard" , header  =T) ; Case 11  
D=dist(  Case 11 )
mds=isoMDS(D, k=2) ; mds
 plot(mds$points) ; abline(h=0, v=0 , lty  =3) 
text (mds$points, row. names  (  Case11  ) , cex  =0.7) 
```

思考练习题
一、思考题（手工解答，上交作业本)
1. 简述多维标度法的基本思想。
2. 简述多维标度法的计算步骤。
3. 试解释样本间相似性的含义。














